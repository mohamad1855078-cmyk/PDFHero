{"file_contents":{"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","path":null,"size_bytes":1342,"size_tokens":null},"client/src/pages/PDFToWord.tsx":{"content":"import { useState } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, FileType } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function PDFToWord() {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n    }\n  };\n\n  const handleConvert = async () => {\n    if (!file) return;\n\n    setIsProcessing(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const response = await fetch('/api/pdf/to-word', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to convert PDF');\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${file.name.replace('.pdf', '')}.docx`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast({\n        title: \"Success!\",\n        description: \"Your PDF has been converted to Word successfully.\",\n      });\n    } catch (error: any) {\n      console.error('Error converting PDF:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to convert PDF. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.pdfToWord.title')}\n      description={t('tool.pdfToWord.desc')}\n      isProcessing={isProcessing}\n      actionButton={\n        file && (\n          <Button \n            size=\"lg\" \n            onClick={handleConvert} \n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n          >\n            Convert to Word\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description=\"Select a PDF file to convert\"\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          {/* File Info */}\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-blue-600\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB\n              </p>\n            </div>\n            <Button variant=\"ghost\" size=\"icon\" onClick={() => setFile(null)}>\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          <div className=\"bg-blue-50 dark:bg-blue-950/30 border border-blue-100 dark:border-blue-900 rounded-2xl p-6 text-center\">\n             <div className=\"w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600 dark:text-blue-400\">\n                <FileType className=\"w-8 h-8\" />\n             </div>\n             <h3 className=\"text-lg font-semibold mb-2\">Ready to Convert</h3>\n             <p className=\"text-muted-foreground\">\n               We will convert your PDF to an editable Word document (.docx) while preserving your layout and formatting.\n             </p>\n          </div>\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":4041,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport {\n  ChevronDownIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"lucide-react\"\nimport { DayButton, DayPicker, getDefaultClassNames } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button, buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  captionLayout = \"label\",\n  buttonVariant = \"ghost\",\n  formatters,\n  components,\n  ...props\n}: React.ComponentProps<typeof DayPicker> & {\n  buttonVariant?: React.ComponentProps<typeof Button>[\"variant\"]\n}) {\n  const defaultClassNames = getDefaultClassNames()\n\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\n        \"bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent\",\n        String.raw`rtl:**:[.rdp-button\\_next>svg]:rotate-180`,\n        String.raw`rtl:**:[.rdp-button\\_previous>svg]:rotate-180`,\n        className\n      )}\n      captionLayout={captionLayout}\n      formatters={{\n        formatMonthDropdown: (date) =>\n          date.toLocaleString(\"default\", { month: \"short\" }),\n        ...formatters,\n      }}\n      classNames={{\n        root: cn(\"w-fit\", defaultClassNames.root),\n        months: cn(\n          \"relative flex flex-col gap-4 md:flex-row\",\n          defaultClassNames.months\n        ),\n        month: cn(\"flex w-full flex-col gap-4\", defaultClassNames.month),\n        nav: cn(\n          \"absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1\",\n          defaultClassNames.nav\n        ),\n        button_previous: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_previous\n        ),\n        button_next: cn(\n          buttonVariants({ variant: buttonVariant }),\n          \"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50\",\n          defaultClassNames.button_next\n        ),\n        month_caption: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]\",\n          defaultClassNames.month_caption\n        ),\n        dropdowns: cn(\n          \"flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium\",\n          defaultClassNames.dropdowns\n        ),\n        dropdown_root: cn(\n          \"has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border\",\n          defaultClassNames.dropdown_root\n        ),\n        dropdown: cn(\n          \"bg-popover absolute inset-0 opacity-0\",\n          defaultClassNames.dropdown\n        ),\n        caption_label: cn(\n          \"select-none font-medium\",\n          captionLayout === \"label\"\n            ? \"text-sm\"\n            : \"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5\",\n          defaultClassNames.caption_label\n        ),\n        table: \"w-full border-collapse\",\n        weekdays: cn(\"flex\", defaultClassNames.weekdays),\n        weekday: cn(\n          \"text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal\",\n          defaultClassNames.weekday\n        ),\n        week: cn(\"mt-2 flex w-full\", defaultClassNames.week),\n        week_number_header: cn(\n          \"w-[--cell-size] select-none\",\n          defaultClassNames.week_number_header\n        ),\n        week_number: cn(\n          \"text-muted-foreground select-none text-[0.8rem]\",\n          defaultClassNames.week_number\n        ),\n        day: cn(\n          \"group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md\",\n          defaultClassNames.day\n        ),\n        range_start: cn(\n          \"bg-accent rounded-l-md\",\n          defaultClassNames.range_start\n        ),\n        range_middle: cn(\"rounded-none\", defaultClassNames.range_middle),\n        range_end: cn(\"bg-accent rounded-r-md\", defaultClassNames.range_end),\n        today: cn(\n          \"bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none\",\n          defaultClassNames.today\n        ),\n        outside: cn(\n          \"text-muted-foreground aria-selected:text-muted-foreground\",\n          defaultClassNames.outside\n        ),\n        disabled: cn(\n          \"text-muted-foreground opacity-50\",\n          defaultClassNames.disabled\n        ),\n        hidden: cn(\"invisible\", defaultClassNames.hidden),\n        ...classNames,\n      }}\n      components={{\n        Root: ({ className, rootRef, ...props }) => {\n          return (\n            <div\n              data-slot=\"calendar\"\n              ref={rootRef}\n              className={cn(className)}\n              {...props}\n            />\n          )\n        },\n        Chevron: ({ className, orientation, ...props }) => {\n          if (orientation === \"left\") {\n            return (\n              <ChevronLeftIcon className={cn(\"size-4\", className)} {...props} />\n            )\n          }\n\n          if (orientation === \"right\") {\n            return (\n              <ChevronRightIcon\n                className={cn(\"size-4\", className)}\n                {...props}\n              />\n            )\n          }\n\n          return (\n            <ChevronDownIcon className={cn(\"size-4\", className)} {...props} />\n          )\n        },\n        DayButton: CalendarDayButton,\n        WeekNumber: ({ children, ...props }) => {\n          return (\n            <td {...props}>\n              <div className=\"flex size-[--cell-size] items-center justify-center text-center\">\n                {children}\n              </div>\n            </td>\n          )\n        },\n        ...components,\n      }}\n      {...props}\n    />\n  )\n}\n\nfunction CalendarDayButton({\n  className,\n  day,\n  modifiers,\n  ...props\n}: React.ComponentProps<typeof DayButton>) {\n  const defaultClassNames = getDefaultClassNames()\n\n  const ref = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    if (modifiers.focused) ref.current?.focus()\n  }, [modifiers.focused])\n\n  return (\n    <Button\n      ref={ref}\n      variant=\"ghost\"\n      size=\"icon\"\n      data-day={day.date.toLocaleDateString()}\n      data-selected-single={\n        modifiers.selected &&\n        !modifiers.range_start &&\n        !modifiers.range_end &&\n        !modifiers.range_middle\n      }\n      data-range-start={modifiers.range_start}\n      data-range-end={modifiers.range_end}\n      data-range-middle={modifiers.range_middle}\n      className={cn(\n        \"data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70\",\n        defaultClassNames.day,\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Calendar, CalendarDayButton }\n","path":null,"size_bytes":7569,"size_tokens":null},"client/src/components/ui/spinner.tsx":{"content":"import { Loader2Icon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Spinner({ className, ...props }: React.ComponentProps<\"svg\">) {\n  return (\n    <Loader2Icon\n      role=\"status\"\n      aria-label=\"Loading\"\n      className={cn(\"size-4 animate-spin\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Spinner }\n","path":null,"size_bytes":331,"size_tokens":null},"client/src/pages/RotatePDF.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { PdfThumbnailGrid } from '@/components/PdfThumbnailGrid';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { FileText, X, RotateCw, Download, CheckCircle, Loader2, RotateCcw, ArrowLeft, ArrowRight, FileStack, Files } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\ntype RotationAngle = 0 | 90 | 180 | 270;\ntype RotationMode = 'all' | 'individual';\n\ninterface RotateResult {\n  downloadUrl: string;\n  totalPages: number;\n  rotatedCount: number;\n  elapsedTime: number;\n}\n\nexport default function RotatePDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [totalPages, setTotalPages] = useState(0);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [result, setResult] = useState<RotateResult | null>(null);\n  const [progress, setProgress] = useState(0);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Mode state\n  const [rotationMode, setRotationMode] = useState<RotationMode>('all');\n\n  // \"All Pages\" mode state - single rotation for entire document\n  const [allPagesAngle, setAllPagesAngle] = useState<RotationAngle>(0);\n  const [allPagesCumulative, setAllPagesCumulative] = useState(0);\n\n  // \"Individual\" mode state - per-page selections and rotations\n  const [selectedPages, setSelectedPages] = useState<Set<number>>(new Set());\n  const [pageRotations, setPageRotations] = useState<Map<number, RotationAngle>>(new Map());\n  const [cumulativeRotations, setCumulativeRotations] = useState<Map<number, number>>(new Map());\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setResult(null);\n      setSelectedPages(new Set());\n      setPageRotations(new Map());\n      setCumulativeRotations(new Map());\n      setAllPagesAngle(0);\n      setAllPagesCumulative(0);\n      setTotalPages(0);\n    }\n  };\n\n  // Mode switching handler\n  const handleModeChange = useCallback((mode: RotationMode) => {\n    setRotationMode(mode);\n    // Reset state when switching modes\n    if (mode === 'all') {\n      // Entering \"All Pages\" mode - clear individual selections\n      setSelectedPages(new Set());\n      setPageRotations(new Map());\n      setCumulativeRotations(new Map());\n    } else {\n      // Entering \"Individual\" mode - reset all-pages angle\n      setAllPagesAngle(0);\n      setAllPagesCumulative(0);\n    }\n  }, []);\n\n  // All Pages mode handlers\n  const handleRotateAllLeft = useCallback(() => {\n    const nextAngle = ((allPagesAngle - 90 + 360) % 360) as RotationAngle;\n    const nextCumulative = allPagesCumulative - 90;\n    setAllPagesAngle(nextAngle);\n    setAllPagesCumulative(nextCumulative);\n  }, [allPagesAngle, allPagesCumulative]);\n\n  const handleRotateAllRight = useCallback(() => {\n    const nextAngle = ((allPagesAngle + 90) % 360) as RotationAngle;\n    const nextCumulative = allPagesCumulative + 90;\n    setAllPagesAngle(nextAngle);\n    setAllPagesCumulative(nextCumulative);\n  }, [allPagesAngle, allPagesCumulative]);\n\n  // Individual mode handlers\n  const handleTogglePage = useCallback((pageNum: number) => {\n    if (rotationMode !== 'individual') return; // Only allow selection in individual mode\n    \n    setSelectedPages(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(pageNum)) {\n        newSet.delete(pageNum);\n      } else {\n        newSet.add(pageNum);\n        // Set default rotation to 0 for newly selected page\n        setPageRotations(prev => {\n          const newMap = new Map(prev);\n          if (!newMap.has(pageNum)) {\n            newMap.set(pageNum, 0);\n          }\n          return newMap;\n        });\n        setCumulativeRotations(prev => {\n          const newMap = new Map(prev);\n          if (!newMap.has(pageNum)) {\n            newMap.set(pageNum, 0);\n          }\n          return newMap;\n        });\n      }\n      return newSet;\n    });\n  }, [rotationMode]);\n\n  const handleRotatePageLeft = useCallback((pageNum: number) => {\n    const currentAngle = pageRotations.get(pageNum) || 0;\n    const nextAngle = ((currentAngle - 90 + 360) % 360) as RotationAngle;\n    const currentCumulative = cumulativeRotations.get(pageNum) || 0;\n    const nextCumulative = currentCumulative - 90;\n    setPageRotations(prev => {\n      const newMap = new Map(prev);\n      newMap.set(pageNum, nextAngle);\n      return newMap;\n    });\n    setCumulativeRotations(prev => {\n      const newMap = new Map(prev);\n      newMap.set(pageNum, nextCumulative);\n      return newMap;\n    });\n  }, [pageRotations, cumulativeRotations]);\n\n  const handleRotatePageRight = useCallback((pageNum: number) => {\n    const currentAngle = pageRotations.get(pageNum) || 0;\n    const nextAngle = ((currentAngle + 90) % 360) as RotationAngle;\n    const currentCumulative = cumulativeRotations.get(pageNum) || 0;\n    const nextCumulative = currentCumulative + 90;\n    setPageRotations(prev => {\n      const newMap = new Map(prev);\n      newMap.set(pageNum, nextAngle);\n      return newMap;\n    });\n    setCumulativeRotations(prev => {\n      const newMap = new Map(prev);\n      newMap.set(pageNum, nextCumulative);\n      return newMap;\n    });\n  }, [pageRotations, cumulativeRotations]);\n\n  // Rotate all selected pages together (in individual mode)\n  const handleRotateSelectedLeft = useCallback(() => {\n    setPageRotations(prev => {\n      const newMap = new Map(prev);\n      selectedPages.forEach(pageNum => {\n        const currentAngle = newMap.get(pageNum) || 0;\n        const nextAngle = ((currentAngle - 90 + 360) % 360) as RotationAngle;\n        newMap.set(pageNum, nextAngle);\n      });\n      return newMap;\n    });\n    setCumulativeRotations(prev => {\n      const newMap = new Map(prev);\n      selectedPages.forEach(pageNum => {\n        const currentCumulative = newMap.get(pageNum) || 0;\n        newMap.set(pageNum, currentCumulative - 90);\n      });\n      return newMap;\n    });\n  }, [selectedPages]);\n\n  const handleRotateSelectedRight = useCallback(() => {\n    setPageRotations(prev => {\n      const newMap = new Map(prev);\n      selectedPages.forEach(pageNum => {\n        const currentAngle = newMap.get(pageNum) || 0;\n        const nextAngle = ((currentAngle + 90) % 360) as RotationAngle;\n        newMap.set(pageNum, nextAngle);\n      });\n      return newMap;\n    });\n    setCumulativeRotations(prev => {\n      const newMap = new Map(prev);\n      selectedPages.forEach(pageNum => {\n        const currentCumulative = newMap.get(pageNum) || 0;\n        newMap.set(pageNum, currentCumulative + 90);\n      });\n      return newMap;\n    });\n  }, [selectedPages]);\n\n  const handleClearSelection = useCallback(() => {\n    setSelectedPages(new Set());\n    setPageRotations(new Map());\n    setCumulativeRotations(new Map());\n  }, []);\n\n  const handleSelectAll = useCallback(() => {\n    if (totalPages > 0) {\n      const allPages = new Set<number>();\n      const newRotations = new Map<number, RotationAngle>();\n      const newCumulative = new Map<number, number>();\n      for (let i = 1; i <= totalPages; i++) {\n        allPages.add(i);\n        newRotations.set(i, 0);\n        newCumulative.set(i, 0);\n      }\n      setSelectedPages(allPages);\n      setPageRotations(newRotations);\n      setCumulativeRotations(newCumulative);\n    }\n  }, [totalPages]);\n\n  // Get the common rotation angle if all selected pages have the same rotation\n  const getCommonRotation = useCallback((): RotationAngle | null => {\n    if (selectedPages.size === 0) return null;\n    const angles = Array.from(selectedPages).map(p => pageRotations.get(p) || 0);\n    const firstAngle = angles[0];\n    return angles.every(a => a === firstAngle) ? firstAngle : null;\n  }, [selectedPages, pageRotations]);\n\n  // Timer for processing\n  useEffect(() => {\n    if (isProcessing) {\n      setProgress(0);\n      timerRef.current = setInterval(() => {\n        setElapsedTime(prev => {\n          const newTime = prev + 1;\n          let newProgress = Math.min(95, (newTime / 2) * Math.log(newTime + 1));\n          setProgress(newProgress);\n          return newTime;\n        });\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n      setProgress(100);\n    }\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getPageRangeString = (): string => {\n    const pages = Array.from(selectedPages).sort((a, b) => a - b);\n    if (pages.length === 0) return '';\n    \n    const ranges: string[] = [];\n    let start = pages[0];\n    let end = pages[0];\n    \n    for (let i = 1; i < pages.length; i++) {\n      if (pages[i] === end + 1) {\n        end = pages[i];\n      } else {\n        ranges.push(start === end ? `${start}` : `${start}-${end}`);\n        start = pages[i];\n        end = pages[i];\n      }\n    }\n    ranges.push(start === end ? `${start}` : `${start}-${end}`);\n    \n    return ranges.join(', ');\n  };\n\n  const handleRotatePages = async () => {\n    if (!file) return;\n    \n    // Validate based on mode\n    if (rotationMode === 'all' && allPagesAngle === 0) {\n      toast({\n        title: language === 'ar' ? 'تنبيه' : 'Notice',\n        description: language === 'ar' \n          ? 'يرجى اختيار زاوية للتدوير'\n          : 'Please select a rotation angle',\n        variant: \"destructive\"\n      });\n      return;\n    }\n    \n    if (rotationMode === 'individual' && selectedPages.size === 0) {\n      toast({\n        title: language === 'ar' ? 'تنبيه' : 'Notice',\n        description: language === 'ar' \n          ? 'يرجى تحديد صفحات للتدوير'\n          : 'Please select pages to rotate',\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n    setElapsedTime(0);\n    setResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      // Build rotations payload based on mode\n      const pageRotationsObj: Record<string, number> = {};\n      \n      if (rotationMode === 'all') {\n        // Apply same angle to ALL pages\n        for (let i = 1; i <= totalPages; i++) {\n          pageRotationsObj[i.toString()] = allPagesAngle;\n        }\n      } else {\n        // Individual mode - only include pages with non-zero rotation\n        pageRotations.forEach((angle, pageNum) => {\n          if (angle !== 0) {\n            pageRotationsObj[pageNum.toString()] = angle;\n          }\n        });\n      }\n      \n      formData.append('pageRotations', JSON.stringify(pageRotationsObj));\n\n      const response = await fetch('/api/pdf/rotate', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        let errorMsg = 'Failed to rotate pages';\n        try {\n          const error = await response.json();\n          errorMsg = error.error || errorMsg;\n        } catch {\n          errorMsg = `Server error: ${response.statusText}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      const rotatedCount = parseInt(response.headers.get('X-Rotated-Count') || '0');\n      const serverElapsed = parseInt(response.headers.get('X-Elapsed-Time') || '0');\n\n      const blob = await response.blob();\n      const downloadUrl = window.URL.createObjectURL(blob);\n\n      setResult({\n        downloadUrl,\n        totalPages,\n        rotatedCount,\n        elapsedTime: serverElapsed\n      });\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: language === 'ar' \n          ? `تم تدوير ${rotatedCount} صفحة`\n          : `${rotatedCount} page${rotatedCount > 1 ? 's have' : ' has'} been rotated.`,\n      });\n    } catch (error: any) {\n      console.error('Error rotating pages:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في تدوير الصفحات. يرجى المحاولة مرة أخرى.'\n          : 'Failed to rotate pages. Please try again.'),\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!result) return;\n    \n    const a = document.createElement('a');\n    a.href = result.downloadUrl;\n    a.download = `rotated-${file?.name || 'document.pdf'}`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    \n    window.URL.revokeObjectURL(result.downloadUrl);\n  };\n\n  const handleReset = () => {\n    if (result?.downloadUrl) {\n      window.URL.revokeObjectURL(result.downloadUrl);\n    }\n    setFile(null);\n    setResult(null);\n    setSelectedPages(new Set());\n    setPageRotations(new Map());\n    setCumulativeRotations(new Map());\n    setAllPagesAngle(0);\n    setAllPagesCumulative(0);\n    setTotalPages(0);\n    setElapsedTime(0);\n  };\n\n  // For \"All Pages\" mode preview - create maps for all pages with the same rotation\n  const allPagesRotationsMap = new Map<number, RotationAngle>();\n  const allPagesCumulativeMap = new Map<number, number>();\n  if (rotationMode === 'all' && totalPages > 0) {\n    for (let i = 1; i <= totalPages; i++) {\n      allPagesRotationsMap.set(i, allPagesAngle);\n      allPagesCumulativeMap.set(i, allPagesCumulative);\n    }\n  }\n\n  return (\n    <ToolPageLayout\n      title={t('tool.rotate.title')}\n      description={t('tool.rotate.desc')}\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لتدوير صفحاته' : 'Select a PDF file to rotate pages'}\n          />\n        </div>\n      ) : result ? (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          <div className=\"text-center space-y-4 py-8\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم تدوير الصفحات بنجاح!' : 'Pages Rotated Successfully!'}\n            </h3>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <div className=\"bg-secondary/30 rounded-xl p-6 text-center border border-border/50 min-w-[200px]\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الصفحات المدورة' : 'Pages Rotated'}\n              </p>\n              <p className=\"text-3xl font-bold text-primary\" data-testid=\"text-rotated-pages\">\n                {result.rotatedCount}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <span className=\"text-sm font-medium text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30 px-4 py-2 rounded-full\">\n              {language === 'ar' ? `اكتمل في ${formatTime(Math.ceil(result.elapsedTime / 1000))}` : `Completed in ${formatTime(Math.ceil(result.elapsedTime / 1000))}`}\n            </span>\n          </div>\n\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center pt-4\">\n            <Button \n              size=\"lg\"\n              onClick={handleDownload}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-download-result\"\n            >\n              <Download className=\"h-5 w-5 me-2\" />\n              {language === 'ar' ? 'تحميل PDF' : 'Download PDF'}\n            </Button>\n            <Button \n              size=\"lg\"\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-rotate-another\"\n            >\n              {language === 'ar' ? 'تدوير ملف آخر' : 'Rotate Another'}\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          {/* File info header */}\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-primary\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-file-name\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-size\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB {totalPages > 0 && `• ${totalPages} ${language === 'ar' ? 'صفحة' : 'pages'}`}\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={handleReset}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          {/* Mode Selector - Two Clear Options */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            <button\n              onClick={() => handleModeChange('all')}\n              className={`p-6 rounded-xl border-2 transition-all text-center ${\n                rotationMode === 'all'\n                  ? 'border-primary bg-primary/10 shadow-md'\n                  : 'border-border/50 bg-secondary/20 hover:bg-secondary/40 hover:border-border'\n              }`}\n              data-testid=\"button-mode-all\"\n            >\n              <div className=\"flex flex-col items-center gap-3\">\n                <div className={`h-14 w-14 rounded-full flex items-center justify-center ${\n                  rotationMode === 'all' ? 'bg-primary text-primary-foreground' : 'bg-secondary text-muted-foreground'\n                }`}>\n                  <FileStack className=\"h-7 w-7\" />\n                </div>\n                <div>\n                  <p className={`font-semibold text-lg ${rotationMode === 'all' ? 'text-primary' : ''}`}>\n                    {language === 'ar' ? 'تدوير كل الصفحات' : 'Rotate All Pages'}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    {language === 'ar' ? 'نفس الزاوية لجميع الصفحات' : 'Same angle for entire document'}\n                  </p>\n                </div>\n              </div>\n            </button>\n\n            <button\n              onClick={() => handleModeChange('individual')}\n              className={`p-6 rounded-xl border-2 transition-all text-center ${\n                rotationMode === 'individual'\n                  ? 'border-primary bg-primary/10 shadow-md'\n                  : 'border-border/50 bg-secondary/20 hover:bg-secondary/40 hover:border-border'\n              }`}\n              data-testid=\"button-mode-individual\"\n            >\n              <div className=\"flex flex-col items-center gap-3\">\n                <div className={`h-14 w-14 rounded-full flex items-center justify-center ${\n                  rotationMode === 'individual' ? 'bg-primary text-primary-foreground' : 'bg-secondary text-muted-foreground'\n                }`}>\n                  <Files className=\"h-7 w-7\" />\n                </div>\n                <div>\n                  <p className={`font-semibold text-lg ${rotationMode === 'individual' ? 'text-primary' : ''}`}>\n                    {language === 'ar' ? 'تدوير صفحات محددة' : 'Rotate Specific Pages'}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    {language === 'ar' ? 'اختر وأدر كل صفحة' : 'Select and rotate each page'}\n                  </p>\n                </div>\n              </div>\n            </button>\n          </div>\n\n          {/* All Pages Mode Controls */}\n          {rotationMode === 'all' && (\n            <div className=\"bg-primary/10 border border-primary/30 rounded-xl p-6 space-y-5\">\n              <div className=\"text-center\">\n                <p className=\"text-sm text-muted-foreground mb-2\">\n                  {language === 'ar' ? 'زاوية التدوير لجميع الصفحات' : 'Rotation angle for all pages'}\n                </p>\n                <p className=\"text-4xl font-bold text-primary\">\n                  {allPagesAngle === 0 ? (language === 'ar' ? 'الأصلي' : 'Original') : `${allPagesAngle}°`}\n                </p>\n              </div>\n              <div className=\"flex justify-center gap-4\">\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={handleRotateAllLeft}\n                  className=\"rounded-xl px-8 py-6 text-lg\"\n                  title={language === 'ar' ? 'تدوير عكس عقارب الساعة' : 'Rotate Counter-clockwise'}\n                  data-testid=\"button-rotate-all-left\"\n                >\n                  <ArrowLeft className=\"h-6 w-6 me-2\" />\n                  {language === 'ar' ? 'يسار' : 'Left'}\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={handleRotateAllRight}\n                  className=\"rounded-xl px-8 py-6 text-lg\"\n                  title={language === 'ar' ? 'تدوير في اتجاه عقارب الساعة' : 'Rotate Clockwise'}\n                  data-testid=\"button-rotate-all-right\"\n                >\n                  {language === 'ar' ? 'يمين' : 'Right'}\n                  <ArrowRight className=\"h-6 w-6 ms-2\" />\n                </Button>\n              </div>\n              \n              {allPagesAngle !== 0 && (\n                <Button \n                  size=\"lg\"\n                  onClick={handleRotatePages}\n                  disabled={isProcessing}\n                  className=\"w-full rounded-full px-6 mt-4\"\n                  data-testid=\"button-rotate-all-pages\"\n                >\n                  <RotateCw className=\"h-5 w-5 me-2\" />\n                  {language === 'ar' \n                    ? `تدوير ${totalPages} صفحة`\n                    : `Rotate All ${totalPages} Pages`\n                  }\n                </Button>\n              )}\n            </div>\n          )}\n\n          {/* Individual Mode Controls */}\n          {rotationMode === 'individual' && selectedPages.size > 0 && (\n            <div className=\"bg-primary/10 border border-primary/30 rounded-xl p-5 space-y-4\">\n              <div className=\"flex items-center justify-between flex-wrap gap-2\">\n                <div>\n                  <p className=\"font-semibold text-lg\">\n                    {selectedPages.size === 1 \n                      ? (language === 'ar' \n                          ? `صفحة ${Array.from(selectedPages)[0]} محددة`\n                          : `Page ${Array.from(selectedPages)[0]} selected`)\n                      : (language === 'ar' \n                          ? `${selectedPages.size} صفحات محددة`\n                          : `${selectedPages.size} pages selected`)\n                    }\n                  </p>\n                  {selectedPages.size > 1 && (\n                    <p className=\"text-sm text-muted-foreground mt-0.5\">\n                      {language === 'ar' ? 'الصفحات: ' : 'Pages: '}{getPageRangeString()}\n                    </p>\n                  )}\n                </div>\n                \n                {/* Current rotation display */}\n                {(() => {\n                  const commonAngle = getCommonRotation();\n                  if (commonAngle !== null) {\n                    return (\n                      <span className=\"bg-primary/20 text-primary px-4 py-1.5 rounded-full text-sm font-semibold\">\n                        {commonAngle === 0 ? (language === 'ar' ? 'الأصلي' : 'Original') : `${commonAngle}°`}\n                      </span>\n                    );\n                  } else {\n                    return (\n                      <span className=\"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 px-4 py-1.5 rounded-full text-sm font-medium\">\n                        {language === 'ar' ? 'زوايا مختلفة' : 'Mixed angles'}\n                      </span>\n                    );\n                  }\n                })()}\n              </div>\n\n              {/* Rotation buttons */}\n              <div className=\"flex justify-center gap-4\">\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={handleRotateSelectedLeft}\n                  className=\"rounded-xl px-6\"\n                  title={language === 'ar' ? 'تدوير عكس عقارب الساعة' : 'Rotate Counter-clockwise'}\n                  data-testid=\"button-rotate-selected-left\"\n                >\n                  <ArrowLeft className=\"h-5 w-5 me-2\" />\n                  {language === 'ar' ? 'يسار' : 'Left'}\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={handleRotateSelectedRight}\n                  className=\"rounded-xl px-6\"\n                  title={language === 'ar' ? 'تدوير في اتجاه عقارب الساعة' : 'Rotate Clockwise'}\n                  data-testid=\"button-rotate-selected-right\"\n                >\n                  {language === 'ar' ? 'يمين' : 'Right'}\n                  <ArrowRight className=\"h-5 w-5 ms-2\" />\n                </Button>\n              </div>\n\n              {/* Individual page fine-tuning for multiple selections */}\n              {selectedPages.size > 1 && (\n                <div className=\"pt-3 border-t border-primary/20 space-y-2\">\n                  <p className=\"text-sm text-muted-foreground text-center mb-2\">\n                    {language === 'ar' ? 'ضبط دقيق لكل صفحة:' : 'Fine-tune each page:'}\n                  </p>\n                  {Array.from(selectedPages).sort((a, b) => a - b).map((pageNum) => {\n                    const currentAngle = pageRotations.get(pageNum) || 0;\n                    const displayAngle = currentAngle === 0 ? (language === 'ar' ? 'الأصلي' : 'Original') : `${currentAngle}°`;\n                    return (\n                      <div key={pageNum} className=\"bg-white/50 dark:bg-black/20 border border-border/30 rounded-lg p-3 flex items-center justify-between gap-3\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-medium\">\n                            {language === 'ar' ? `صفحة ${pageNum}` : `Page ${pageNum}`}\n                          </span>\n                          <span className=\"bg-primary/15 text-primary px-2 py-0.5 rounded-full text-xs font-medium\">\n                            {displayAngle}\n                          </span>\n                        </div>\n                        <div className=\"flex gap-1.5\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleRotatePageLeft(pageNum)}\n                            className=\"rounded-md h-8 w-8 p-0\"\n                          >\n                            <ArrowLeft className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleRotatePageRight(pageNum)}\n                            className=\"rounded-md h-8 w-8 p-0\"\n                          >\n                            <ArrowRight className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* Clear selection and action buttons */}\n              <div className=\"flex gap-3 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"lg\"\n                  onClick={handleClearSelection}\n                  className=\"rounded-full\"\n                  data-testid=\"button-clear-selection\"\n                >\n                  <RotateCcw className=\"h-4 w-4 me-2\" />\n                  {language === 'ar' ? 'إلغاء التحديد' : 'Clear'}\n                </Button>\n                <Button \n                  size=\"lg\"\n                  onClick={handleRotatePages}\n                  disabled={isProcessing}\n                  className=\"flex-1 rounded-full\"\n                  data-testid=\"button-rotate-pages\"\n                >\n                  <RotateCw className=\"h-4 w-4 me-2\" />\n                  {selectedPages.size === 1 \n                    ? (language === 'ar' \n                        ? `تدوير صفحة ${Array.from(selectedPages)[0]}`\n                        : `Rotate Page ${Array.from(selectedPages)[0]}`)\n                    : (language === 'ar' \n                        ? `تدوير ${selectedPages.size} صفحات`\n                        : `Rotate ${selectedPages.size} Pages`)\n                  }\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Individual mode helper text */}\n          {rotationMode === 'individual' && selectedPages.size === 0 && (\n            <div className=\"flex items-center justify-between bg-secondary/30 rounded-xl p-4 border border-border/50\">\n              <p className=\"text-muted-foreground\">\n                {language === 'ar' \n                  ? 'انقر على الصفحات أدناه لتحديدها للتدوير'\n                  : 'Click on pages below to select them for rotation'}\n              </p>\n              {totalPages > 0 && (\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={handleSelectAll}\n                  className=\"text-primary\"\n                  data-testid=\"button-select-all\"\n                >\n                  {language === 'ar' ? 'تحديد الكل' : 'Select All'}\n                </Button>\n              )}\n            </div>\n          )}\n\n          {/* Thumbnail Grid */}\n          {!isProcessing && (\n            <PdfThumbnailGrid\n              file={file}\n              selectedPages={rotationMode === 'individual' ? selectedPages : new Set()}\n              onTogglePage={rotationMode === 'individual' ? handleTogglePage : undefined}\n              onTotalPagesChange={setTotalPages}\n              mode=\"rotate\"\n              pageRotations={rotationMode === 'all' ? allPagesRotationsMap : pageRotations}\n              cumulativeRotations={rotationMode === 'all' ? allPagesCumulativeMap : cumulativeRotations}\n              disableSelection={rotationMode === 'all'}\n            />\n          )}\n\n          {/* Processing state */}\n          {isProcessing && (\n            <div className=\"space-y-6 p-8 bg-primary/5 rounded-xl border border-primary/20\">\n              <div className=\"flex flex-col items-center gap-4\">\n                <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n                <div className=\"text-center\">\n                  <p className=\"font-semibold text-primary text-lg\">\n                    {language === 'ar' ? 'جاري تدوير الصفحات...' : 'Rotating pages...'}\n                  </p>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    {language === 'ar' ? 'الوقت المنقضي:' : 'Elapsed time:'} {formatTime(elapsedTime)}\n                  </p>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center gap-2\">\n                  <p className=\"text-sm font-medium text-muted-foreground\">\n                    {language === 'ar' ? 'التقدم' : 'Progress'}\n                  </p>\n                  <p className=\"text-sm font-semibold text-primary\">\n                    {Math.round(progress)}%\n                  </p>\n                </div>\n                <Progress value={progress} className=\"h-3\" />\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":32623,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/pages/RemovePages.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { PdfThumbnailGrid } from '@/components/PdfThumbnailGrid';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { FileText, X, Trash2, Download, CheckCircle, Loader2, RotateCcw } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\ninterface RemoveResult {\n  downloadUrl: string;\n  originalPageCount: number;\n  removedCount: number;\n  finalPageCount: number;\n  elapsedTime: number;\n}\n\nexport default function RemovePages() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [selectedPages, setSelectedPages] = useState<Set<number>>(new Set());\n  const [rangeInput, setRangeInput] = useState('');\n  const [totalPages, setTotalPages] = useState(0);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [result, setResult] = useState<RemoveResult | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setResult(null);\n      setSelectedPages(new Set());\n      setRangeInput('');\n      setTotalPages(0);\n    }\n  };\n\n  const handleTogglePage = useCallback((pageNum: number) => {\n    setSelectedPages(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(pageNum)) {\n        newSet.delete(pageNum);\n      } else {\n        newSet.add(pageNum);\n      }\n      return newSet;\n    });\n    setRangeInput('');\n  }, []);\n\n  const handleClearSelection = useCallback(() => {\n    setSelectedPages(new Set());\n    setRangeInput('');\n  }, []);\n\n  const parseRangeInput = useCallback((input: string): Set<number> => {\n    const newSet = new Set<number>();\n    if (!input.trim()) return newSet;\n    \n    const parts = input.split(',').map(p => p.trim()).filter(p => p.length > 0);\n    for (const part of parts) {\n      if (part.includes('-')) {\n        const [start, end] = part.split('-').map(n => parseInt(n.trim()));\n        if (!isNaN(start) && !isNaN(end) && start <= end) {\n          for (let i = start; i <= Math.min(end, totalPages); i++) {\n            if (i > 0) newSet.add(i);\n          }\n        }\n      } else {\n        const page = parseInt(part);\n        if (!isNaN(page) && page > 0 && page <= totalPages) {\n          newSet.add(page);\n        }\n      }\n    }\n    return newSet;\n  }, [totalPages]);\n\n  const handleRangeInputChange = useCallback((value: string) => {\n    setRangeInput(value);\n    const parsed = parseRangeInput(value);\n    setSelectedPages(parsed);\n  }, [parseRangeInput]);\n\n  useEffect(() => {\n    if (isProcessing) {\n      timerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getPageRangeString = (): string => {\n    const pages = Array.from(selectedPages).sort((a, b) => a - b);\n    if (pages.length === 0) return '';\n    \n    const ranges: string[] = [];\n    let start = pages[0];\n    let end = pages[0];\n    \n    for (let i = 1; i < pages.length; i++) {\n      if (pages[i] === end + 1) {\n        end = pages[i];\n      } else {\n        ranges.push(start === end ? `${start}` : `${start}-${end}`);\n        start = pages[i];\n        end = pages[i];\n      }\n    }\n    ranges.push(start === end ? `${start}` : `${start}-${end}`);\n    \n    return ranges.join(', ');\n  };\n\n  const handleRemovePages = async () => {\n    if (!file || selectedPages.size === 0) return;\n\n    if (selectedPages.size >= totalPages) {\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: language === 'ar' \n          ? 'لا يمكن حذف جميع الصفحات من الملف'\n          : 'Cannot remove all pages from the file',\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n    setElapsedTime(0);\n    setResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('pages', getPageRangeString());\n\n      const response = await fetch('/api/pdf/remove-pages', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        let errorMsg = 'Failed to remove pages';\n        try {\n          const error = await response.json();\n          errorMsg = error.error || errorMsg;\n        } catch {\n          errorMsg = `Server error: ${response.statusText}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      const originalPageCount = parseInt(response.headers.get('X-Original-Page-Count') || '0');\n      const removedCount = parseInt(response.headers.get('X-Removed-Count') || '0');\n      const finalPageCount = parseInt(response.headers.get('X-Final-Page-Count') || '0');\n      const serverElapsed = parseInt(response.headers.get('X-Elapsed-Time') || '0');\n\n      const blob = await response.blob();\n      const downloadUrl = window.URL.createObjectURL(blob);\n\n      setResult({\n        downloadUrl,\n        originalPageCount,\n        removedCount,\n        finalPageCount,\n        elapsedTime: serverElapsed\n      });\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: language === 'ar' \n          ? `تم حذف ${removedCount} صفحة بنجاح`\n          : `${removedCount} page${removedCount > 1 ? 's have' : ' has'} been removed successfully.`,\n      });\n    } catch (error: any) {\n      console.error('Error removing pages:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في حذف الصفحات. يرجى المحاولة مرة أخرى.'\n          : 'Failed to remove pages. Please try again.'),\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!result) return;\n    \n    const a = document.createElement('a');\n    a.href = result.downloadUrl;\n    a.download = `pages-removed-${file?.name || 'document.pdf'}`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    \n    window.URL.revokeObjectURL(result.downloadUrl);\n  };\n\n  const handleReset = () => {\n    if (result?.downloadUrl) {\n      window.URL.revokeObjectURL(result.downloadUrl);\n    }\n    setFile(null);\n    setResult(null);\n    setSelectedPages(new Set());\n    setTotalPages(0);\n    setElapsedTime(0);\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.removePages.title')}\n      description={t('tool.removePages.desc')}\n      isProcessing={isProcessing}\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لحذف الصفحات منه' : 'Select a PDF file to remove pages from'}\n          />\n        </div>\n      ) : result ? (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          <div className=\"text-center space-y-4 py-8\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم حذف الصفحات بنجاح!' : 'Pages Removed Successfully!'}\n            </h3>\n          </div>\n\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"bg-secondary/30 rounded-xl p-4 text-center border border-border/50\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الصفحات الأصلية' : 'Original Pages'}\n              </p>\n              <p className=\"text-2xl font-bold\" data-testid=\"text-original-pages\">\n                {result.originalPageCount}\n              </p>\n            </div>\n            <div className=\"bg-red-50 dark:bg-red-950/30 rounded-xl p-4 text-center border border-red-200 dark:border-red-800\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الصفحات المحذوفة' : 'Pages Removed'}\n              </p>\n              <p className=\"text-2xl font-bold text-red-600\" data-testid=\"text-removed-pages\">\n                {result.removedCount}\n              </p>\n            </div>\n            <div className=\"bg-green-50 dark:bg-green-950/30 rounded-xl p-4 text-center border border-green-200 dark:border-green-800\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الصفحات المتبقية' : 'Final Pages'}\n              </p>\n              <p className=\"text-2xl font-bold text-green-600\" data-testid=\"text-final-pages\">\n                {result.finalPageCount}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <span className=\"text-sm font-medium text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30 px-4 py-2 rounded-full\">\n              {language === 'ar' ? `اكتمل في ${formatTime(Math.ceil(result.elapsedTime / 1000))}` : `Completed in ${formatTime(Math.ceil(result.elapsedTime / 1000))}`}\n            </span>\n          </div>\n\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center pt-4\">\n            <Button \n              size=\"lg\"\n              onClick={handleDownload}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-download-result\"\n            >\n              <Download className=\"h-5 w-5 me-2\" />\n              {language === 'ar' ? 'تحميل PDF' : 'Download PDF'}\n            </Button>\n            <Button \n              size=\"lg\"\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-remove-another\"\n            >\n              {language === 'ar' ? 'حذف من ملف آخر' : 'Remove from Another'}\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-red-500\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-file-name\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-size\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB {totalPages > 0 && `• ${totalPages} ${language === 'ar' ? 'صفحة' : 'pages'}`}\n              </p>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {selectedPages.size > 0 && (\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={handleClearSelection}\n                  className=\"text-muted-foreground\"\n                  data-testid=\"button-clear-selection\"\n                >\n                  <RotateCcw className=\"h-4 w-4 me-1\" />\n                  {language === 'ar' ? 'إلغاء التحديد' : 'Clear'}\n                </Button>\n              )}\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={handleReset}\n                data-testid=\"button-remove-file\"\n              >\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"space-y-3\">\n            <div className=\"flex flex-col sm:flex-row gap-3\">\n              <div className=\"flex-1\">\n                <Label htmlFor=\"range-input\" className=\"text-sm font-medium mb-1.5 block\">\n                  {language === 'ar' ? 'أدخل نطاق الصفحات للحذف' : 'Enter page range to remove'}\n                </Label>\n                <Input\n                  id=\"range-input\"\n                  placeholder={language === 'ar' ? 'مثال: 1-5, 10, 15-20' : 'e.g., 1-5, 10, 15-20'}\n                  value={rangeInput}\n                  onChange={(e) => handleRangeInputChange(e.target.value)}\n                  className=\"text-base\"\n                  data-testid=\"input-range\"\n                />\n              </div>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {language === 'ar' \n                ? 'أو انقر على الصفحات أدناه لتحديدها'\n                : 'Or click on pages below to select them'}\n            </p>\n          </div>\n\n          {selectedPages.size > 0 && (\n            <div className=\"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-xl p-4\">\n              <div className=\"flex items-center gap-3 flex-wrap\">\n                <Trash2 className=\"h-5 w-5 text-red-500 shrink-0\" />\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"font-medium text-red-700 dark:text-red-400\">\n                    {language === 'ar' \n                      ? `سيتم حذف ${selectedPages.size} صفحة`\n                      : `${selectedPages.size} page${selectedPages.size > 1 ? 's' : ''} will be removed`\n                    }\n                  </p>\n                  <p className=\"text-sm text-red-600 dark:text-red-400 mt-0.5 truncate\">\n                    {language === 'ar' ? 'الصفحات: ' : 'Pages: '}{getPageRangeString()}\n                  </p>\n                </div>\n                <div className=\"flex items-center gap-2 shrink-0\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={handleClearSelection}\n                    className=\"text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30\"\n                  >\n                    <RotateCcw className=\"h-4 w-4 me-1\" />\n                    {language === 'ar' ? 'إلغاء' : 'Clear'}\n                  </Button>\n                  <Button \n                    size=\"default\"\n                    onClick={handleRemovePages}\n                    disabled={isProcessing}\n                    className=\"bg-red-500 hover:bg-red-600 text-white rounded-full px-6\"\n                    data-testid=\"button-remove-pages\"\n                  >\n                    <Trash2 className=\"h-4 w-4 me-2\" />\n                    {language === 'ar' \n                      ? `حذف ${selectedPages.size} صفحة`\n                      : `Remove ${selectedPages.size} Page${selectedPages.size > 1 ? 's' : ''}`\n                    }\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <PdfThumbnailGrid\n            file={file}\n            selectedPages={selectedPages}\n            onTogglePage={handleTogglePage}\n            onTotalPagesChange={setTotalPages}\n          />\n\n          {isProcessing && (\n            <div className=\"flex items-center justify-center gap-4 p-6 bg-primary/5 rounded-xl border border-primary/20\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              <div>\n                <p className=\"font-medium text-primary\">\n                  {language === 'ar' ? 'جاري حذف الصفحات...' : 'Removing pages...'}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {language === 'ar' ? 'الوقت المنقضي:' : 'Elapsed time:'} {formatTime(elapsedTime)}\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":16452,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1267,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-primary/20\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":792,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":724,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7606,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"import * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8608,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5745,"size_tokens":null},"client/src/components/ui/item.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction ItemGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      role=\"list\"\n      data-slot=\"item-group\"\n      className={cn(\"group/item-group flex flex-col\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"item-separator\"\n      orientation=\"horizontal\"\n      className={cn(\"my-0\", className)}\n      {...props}\n    />\n  )\n}\n\nconst itemVariants = cva(\n  \"group/item [a]:hover:bg-accent/50 focus-visible:border-ring focus-visible:ring-ring/50 [a]:transition-colors flex flex-wrap items-center rounded-md border border-transparent text-sm outline-none transition-colors duration-100 focus-visible:ring-[3px]\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border-border\",\n        muted: \"bg-muted/50\",\n      },\n      size: {\n        default: \"gap-4 p-4 \",\n        sm: \"gap-2.5 px-4 py-3\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Item({\n  className,\n  variant = \"default\",\n  size = \"default\",\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> &\n  VariantProps<typeof itemVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n  return (\n    <Comp\n      data-slot=\"item\"\n      data-variant={variant}\n      data-size={size}\n      className={cn(itemVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nconst itemMediaVariants = cva(\n  \"flex shrink-0 items-center justify-center gap-2 group-has-[[data-slot=item-description]]/item:translate-y-0.5 group-has-[[data-slot=item-description]]/item:self-start [&_svg]:pointer-events-none\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted size-8 rounded-sm border [&_svg:not([class*='size-'])]:size-4\",\n        image:\n          \"size-10 overflow-hidden rounded-sm [&_img]:size-full [&_img]:object-cover\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction ItemMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof itemMediaVariants>) {\n  return (\n    <div\n      data-slot=\"item-media\"\n      data-variant={variant}\n      className={cn(itemMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction ItemContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-content\"\n      className={cn(\n        \"flex flex-1 flex-col gap-1 [&+[data-slot=item-content]]:flex-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-title\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"item-description\"\n      className={cn(\n        \"text-muted-foreground line-clamp-2 text-balance text-sm font-normal leading-normal\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-actions\"\n      className={cn(\"flex items-center gap-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction ItemHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-header\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ItemFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"item-footer\"\n      className={cn(\n        \"flex basis-full items-center justify-between gap-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Item,\n  ItemMedia,\n  ItemContent,\n  ItemActions,\n  ItemGroup,\n  ItemSeparator,\n  ItemTitle,\n  ItemDescription,\n  ItemHeader,\n  ItemFooter,\n}\n","path":null,"size_bytes":4494,"size_tokens":null},"client/src/components/ui/kbd.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Kbd({ className, ...props }: React.ComponentProps<\"kbd\">) {\n  return (\n    <kbd\n      data-slot=\"kbd\"\n      className={cn(\n        \"bg-muted text-muted-foreground pointer-events-none inline-flex h-5 w-fit min-w-5 select-none items-center justify-center gap-1 rounded-sm px-1 font-sans text-xs font-medium\",\n        \"[&_svg:not([class*='size-'])]:size-3\",\n        \"[[data-slot=tooltip-content]_&]:bg-background/20 [[data-slot=tooltip-content]_&]:text-background dark:[[data-slot=tooltip-content]_&]:bg-background/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction KbdGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <kbd\n      data-slot=\"kbd-group\"\n      className={cn(\"inline-flex items-center gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Kbd, KbdGroup }\n","path":null,"size_bytes":862,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n","path":null,"size_bytes":584,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue | null>(null)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  if (!itemContext) {\n    throw new Error(\"useFormField should be used within <FormItem>\")\n  }\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue | null>(null)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4175,"size_tokens":null},"client/src/pages/MergePDF.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, ArrowDown, Download, Zap, Archive } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\ntype MergeMode = 'fast' | 'compress';\n\nexport default function MergePDF() {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const [files, setFiles] = useState<File[]>([]);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const [mergeMode, setMergeMode] = useState<MergeMode>('fast');\n  const [elapsedTime, setElapsedTime] = useState(0);\n\n  const handleFilesSelected = (newFiles: File[]) => {\n    setFiles(prev => [...prev, ...newFiles]);\n  };\n\n  const removeFile = (index: number) => {\n    setFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const moveFile = (index: number, direction: 'up' | 'down') => {\n    if (\n      (direction === 'up' && index === 0) || \n      (direction === 'down' && index === files.length - 1)\n    ) return;\n\n    const newFiles = [...files];\n    const targetIndex = direction === 'up' ? index - 1 : index + 1;\n    [newFiles[index], newFiles[targetIndex]] = [newFiles[targetIndex], newFiles[index]];\n    setFiles(newFiles);\n  };\n\n  // Simulate progress updates and track elapsed time\n  useEffect(() => {\n    if (!isProcessing) return;\n    \n    const progressInterval = setInterval(() => {\n      setProgress(prev => {\n        if (prev < 30) return prev + Math.random() * 3;\n        if (prev < 60) return prev + Math.random() * 2;\n        if (prev < 90) return prev + Math.random() * 1;\n        return Math.min(prev + 0.5, 95);\n      });\n    }, 500);\n\n    const timerInterval = setInterval(() => {\n      setElapsedTime(prev => prev + 1);\n    }, 1000);\n    \n    return () => {\n      clearInterval(progressInterval);\n      clearInterval(timerInterval);\n    };\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleMerge = async () => {\n    if (files.length < 2) {\n      toast({\n        title: \"Not enough files\",\n        description: \"Please select at least 2 PDF files to merge.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n    setProgress(0);\n    setDownloadUrl(null);\n    setElapsedTime(0);\n\n    try {\n      const formData = new FormData();\n      files.forEach(file => {\n        formData.append('files', file);\n      });\n      formData.append('mode', mergeMode);\n\n      const response = await fetch('/api/pdf/merge', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to merge PDFs');\n      }\n\n      const data = await response.json();\n      \n      // Complete progress\n      setProgress(100);\n\n      // Set download URL for user to click\n      setDownloadUrl(data.downloadUrl);\n\n      toast({\n        title: \"Success!\",\n        description: \"Your PDFs have been merged successfully. Click the download button to get your file.\",\n      });\n    } catch (error: any) {\n      console.error('Error merging PDFs:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to merge PDFs. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.merge.title')}\n      description={t('tool.merge.desc')}\n    >\n      {files.length === 0 ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFilesSelected} \n            maxFiles={50}\n            description=\"Drag and drop PDFs here, or click to select multiple files\"\n          />\n        </div>\n      ) : (\n        <>\n          {isProcessing && (\n            <div className=\"space-y-4 p-8 bg-gradient-to-r from-primary/10 to-primary/5 rounded-2xl border-2 border-primary/30 shadow-lg\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div>\n                  <h4 className=\"font-bold text-xl text-primary\">Merging your PDFs...</h4>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    Elapsed time: <span className=\"font-mono font-medium text-primary\">{formatTime(elapsedTime)}</span>\n                  </p>\n                </div>\n                <span className=\"text-4xl font-bold text-primary\">{Math.round(progress)}%</span>\n              </div>\n              \n              <div className=\"w-full bg-gray-200/50 rounded-full h-4 overflow-hidden border-2 border-primary/40 shadow-inner\">\n                <div \n                  className=\"h-full bg-gradient-to-r from-primary via-primary to-primary/90 transition-all duration-300 rounded-full shadow-lg\"\n                  style={{ width: `${progress}%` }}\n                />\n              </div>\n            </div>\n          )}\n\n          {downloadUrl && (\n            <div className=\"space-y-4 p-8 bg-green-50 dark:bg-green-950/20 rounded-2xl border-2 border-green-500/30 shadow-lg\">\n              <div className=\"flex items-center justify-between\">\n                <h4 className=\"font-bold text-xl text-green-700 dark:text-green-400\">Your merged PDF is ready!</h4>\n                <span className=\"text-sm font-medium text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30 px-3 py-1 rounded-full\">\n                  Completed in {formatTime(elapsedTime)}\n                </span>\n              </div>\n              <p className=\"text-muted-foreground\">Click the button below to download your merged document.</p>\n              <Button \n                data-testid=\"button-download\"\n                className=\"w-full gap-2 rounded-full py-6 text-base\"\n                onClick={() => {\n                  const link = document.createElement('a');\n                  link.href = downloadUrl;\n                  link.download = 'merged-document.pdf';\n                  document.body.appendChild(link);\n                  link.click();\n                  document.body.removeChild(link);\n                }}\n              >\n                <Download className=\"h-5 w-5\" />\n                Download Merged PDF\n              </Button>\n              <Button \n                data-testid=\"button-merge-more\"\n                variant=\"outline\" \n                className=\"w-full rounded-full py-6 mt-6\"\n                onClick={() => {\n                  setDownloadUrl(null);\n                  setFiles([]);\n                  setProgress(0);\n                }}\n              >\n                Merge More Files\n              </Button>\n            </div>\n          )}\n\n          {!isProcessing && !downloadUrl && (\n            <div className=\"space-y-6\">\n              {/* Merge Mode Toggle with Merge Button */}\n              <div className=\"p-4 bg-secondary/20 rounded-xl border border-border/50\">\n                <h4 className=\"text-sm font-medium text-muted-foreground mb-3\">{t('tool.merge.title')} Mode</h4>\n                <div className=\"flex gap-3 items-stretch\">\n                  <button\n                    data-testid=\"button-fast-mode\"\n                    onClick={() => setMergeMode('fast')}\n                    className={`flex-1 flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${\n                      mergeMode === 'fast' \n                        ? 'border-primary bg-primary/10 shadow-md' \n                        : 'border-border/50 hover:border-primary/50 hover:bg-secondary/30'\n                    }`}\n                  >\n                    <div className={`h-10 w-10 rounded-lg flex items-center justify-center ${\n                      mergeMode === 'fast' ? 'bg-primary text-white' : 'bg-secondary'\n                    }`}>\n                      <Zap className=\"h-5 w-5\" />\n                    </div>\n                    <div className=\"text-left\">\n                      <p className=\"font-medium\">{t('tool.merge.fastMode')}</p>\n                      <p className=\"text-xs text-muted-foreground\">{t('tool.merge.fastModeDesc')}</p>\n                    </div>\n                  </button>\n                  <button\n                    data-testid=\"button-compress-mode\"\n                    onClick={() => setMergeMode('compress')}\n                    className={`flex-1 flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${\n                      mergeMode === 'compress' \n                        ? 'border-primary bg-primary/10 shadow-md' \n                        : 'border-border/50 hover:border-primary/50 hover:bg-secondary/30'\n                    }`}\n                  >\n                    <div className={`h-10 w-10 rounded-lg flex items-center justify-center ${\n                      mergeMode === 'compress' ? 'bg-primary text-white' : 'bg-secondary'\n                    }`}>\n                      <Archive className=\"h-5 w-5\" />\n                    </div>\n                    <div className=\"text-left\">\n                      <p className=\"font-medium\">{t('tool.merge.compressMode')}</p>\n                      <p className=\"text-xs text-muted-foreground\">{t('tool.merge.compressModeDesc')}</p>\n                    </div>\n                  </button>\n                  <Button \n                    data-testid=\"button-merge\"\n                    size=\"lg\" \n                    onClick={handleMerge} \n                    className=\"rounded-xl px-8 text-lg h-auto min-w-[150px]\"\n                    disabled={files.length < 2 || isProcessing}\n                  >\n                    {isProcessing ? \"Merging...\" : \"Merge PDFs\"}\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-semibold\">Selected Files ({files.length})</h3>\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setFiles([])}>\n                  Clear All\n                </Button>\n              </div>\n\n              <div className=\"grid gap-3\">\n                {files.map((file, index) => (\n                  <div \n                    key={`${file.name}-${index}`}\n                    className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50 group hover:bg-secondary/50 transition-colors\"\n                  >\n                    <div className=\"h-10 w-10 rounded-lg bg-white flex items-center justify-center shadow-sm text-red-500\">\n                      <FileText className=\"h-6 w-6\" />\n                    </div>\n                    \n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"font-medium truncate\">{file.name}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {(file.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"h-8 w-8\"\n                        onClick={() => moveFile(index, 'up')}\n                        disabled={index === 0}\n                      >\n                        <ArrowDown className=\"h-4 w-4 rotate-180\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"h-8 w-8\"\n                        onClick={() => moveFile(index, 'down')}\n                        disabled={index === files.length - 1}\n                      >\n                        <ArrowDown className=\"h-4 w-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\" \n                        className=\"h-8 w-8 text-destructive hover:text-destructive/90 hover:bg-destructive/10\"\n                        onClick={() => removeFile(index)}\n                      >\n                        <X className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n                \n                <div className=\"pt-4\">\n                  <FileUploader \n                    onFilesSelected={handleFilesSelected}\n                    description=\"Add more files\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":12849,"size_tokens":null},"client/src/pages/ProtectPDF.tsx":{"content":"import { useState, useMemo } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Lock } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\n\nfunction getPasswordStrength(password: string): { score: number; label: string; color: string } {\n  if (!password) return { score: 0, label: '', color: 'bg-gray-200' };\n  \n  let score = 0;\n  \n  if (password.length >= 4) score += 1;\n  if (password.length >= 8) score += 1;\n  if (password.length >= 12) score += 1;\n  if (/[a-z]/.test(password)) score += 1;\n  if (/[A-Z]/.test(password)) score += 1;\n  if (/[0-9]/.test(password)) score += 1;\n  if (/[^a-zA-Z0-9]/.test(password)) score += 1;\n  \n  if (score <= 2) return { score: 1, label: 'Weak', color: 'bg-red-500' };\n  if (score <= 4) return { score: 2, label: 'Medium', color: 'bg-yellow-500' };\n  if (score <= 5) return { score: 3, label: 'Good', color: 'bg-blue-500' };\n  return { score: 4, label: 'Strong', color: 'bg-green-500' };\n}\n\nexport default function ProtectPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  \n  const passwordStrength = useMemo(() => getPasswordStrength(password), [password]);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n    }\n  };\n\n  const handleProtect = async () => {\n    if (!file) return;\n    \n    if (password.length < 4) {\n      toast({\n        title: \"Password too short\",\n        description: \"Password must be at least 4 characters long.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      toast({\n        title: \"Passwords do not match\",\n        description: \"Please ensure both password fields match.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('password', password);\n\n      const response = await fetch('/api/pdf/protect', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to protect PDF');\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `protected-${file.name}`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast({\n        title: \"Success!\",\n        description: \"Your PDF has been password protected.\",\n      });\n    } catch (error: any) {\n      console.error('Error protecting PDF:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to protect PDF. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.protect.title')}\n      description={t('tool.protect.desc')}\n      isProcessing={isProcessing}\n      actionButton={\n        file && (\n          <Button \n            size=\"lg\" \n            onClick={handleProtect} \n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n          >\n            Protect PDF\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description=\"Select a PDF file to protect\"\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          {/* File Info */}\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-gray-600\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB\n              </p>\n            </div>\n            <Button variant=\"ghost\" size=\"icon\" onClick={() => { setFile(null); setPassword(''); setConfirmPassword(''); }}>\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          {/* Password Form */}\n          <div className=\"bg-card p-6 rounded-2xl border border-border/50 space-y-4 shadow-sm\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Lock className=\"w-5 h-5 text-primary\" />\n              <h3 className=\"text-lg font-semibold\">Set Password</h3>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">\n                {language === 'ar' ? 'أدخل كلمة المرور' : 'Enter Password'}\n              </Label>\n              <Input \n                id=\"password\" \n                type=\"password\" \n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"••••••••\"\n                className=\"bg-background\"\n                data-testid=\"input-password\"\n              />\n              \n              {/* Password Strength Bar */}\n              {password && (\n                <div className=\"space-y-1.5 mt-2\">\n                  <div className=\"flex gap-1\">\n                    {[1, 2, 3, 4].map((level) => (\n                      <div \n                        key={level}\n                        className={`h-1.5 flex-1 rounded-full transition-all duration-300 ${\n                          level <= passwordStrength.score ? passwordStrength.color : 'bg-gray-200'\n                        }`}\n                      />\n                    ))}\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className={`text-xs font-medium ${\n                      passwordStrength.score === 1 ? 'text-red-500' :\n                      passwordStrength.score === 2 ? 'text-yellow-600' :\n                      passwordStrength.score === 3 ? 'text-blue-500' :\n                      'text-green-500'\n                    }`}>\n                      {language === 'ar' \n                        ? (passwordStrength.label === 'Weak' ? 'ضعيفة' :\n                           passwordStrength.label === 'Medium' ? 'متوسطة' :\n                           passwordStrength.label === 'Good' ? 'جيدة' : 'قوية')\n                        : passwordStrength.label}\n                    </span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {language === 'ar' ? 'استخدم أحرف كبيرة وصغيرة وأرقام ورموز' : 'Use uppercase, lowercase, numbers & symbols'}\n                    </span>\n                  </div>\n                </div>\n              )}\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirm-password\">\n                {language === 'ar' ? 'تأكيد كلمة المرور' : 'Confirm Password'}\n              </Label>\n              <Input \n                id=\"confirm-password\" \n                type=\"password\" \n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                placeholder=\"••••••••\"\n                className=\"bg-background\"\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":8153,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false, limit: '5gb' }));\napp.use(express.json({ limit: '5gb' }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n\n  // Set longer timeout for large file uploads (10 minutes)\n  httpServer.setTimeout(600000); // 600 seconds = 10 minutes\n  httpServer.keepAliveTimeout = 600000;\n})();\n","path":null,"size_bytes":2777,"size_tokens":null},"client/src/components/Navbar.tsx":{"content":"import { Link } from \"wouter\";\nimport { FileText, Globe, Clock } from \"lucide-react\";\nimport { useLanguage } from \"@/lib/i18n\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport function Navbar() {\n  const { t, language, setLanguage } = useLanguage();\n\n  return (\n    <nav className=\"sticky top-0 z-50 w-full border-b border-border/50 bg-background/80 backdrop-blur-xl supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"container flex h-16 items-center justify-between px-4 md:px-6\">\n        <Link href=\"/\" className=\"flex items-center gap-2 font-semibold transition-opacity hover:opacity-80\">\n          <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-primary text-primary-foreground\">\n            <FileText className=\"h-5 w-5\" />\n          </div>\n          <span className=\"text-lg tracking-tight text-foreground\">{t('nav.brand')}</span>\n        </Link>\n        \n        <div className=\"hidden md:flex items-center gap-6 text-sm font-medium text-muted-foreground\">\n          <Link href=\"/\" className=\"hover:text-foreground transition-colors\">{t('nav.allTools')}</Link>\n          <Link href=\"/history\" className=\"hover:text-foreground transition-colors flex items-center gap-1\">\n             <Clock className=\"w-4 h-4\" /> History\n          </Link>\n          <Link href=\"/pricing\" className=\"hover:text-foreground transition-colors\">{t('nav.pricing')}</Link>\n          \n          <div className=\"h-4 w-px bg-border/50\"></div>\n          \n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8 rounded-full\">\n                <Globe className=\"h-4 w-4\" />\n                <span className=\"sr-only\">Switch Language</span>\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\">\n              <DropdownMenuItem onClick={() => setLanguage('en')} className={language === 'en' ? 'bg-accent' : ''}>\n                English\n              </DropdownMenuItem>\n              <DropdownMenuItem onClick={() => setLanguage('ar')} className={language === 'ar' ? 'bg-accent font-sans' : ''}>\n                العربية\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n\n          <Link href=\"/login\" className=\"hover:text-foreground transition-colors\">{t('nav.login')}</Link>\n          <Link href=\"/signup\" className=\"bg-primary text-primary-foreground hover:bg-primary/90 rounded-full px-5 py-2 transition-all\">\n            {t('nav.signup')}\n          </Link>\n        </div>\n        \n        {/* Mobile Menu Button */}\n        <div className=\"flex md:hidden items-center gap-2\">\n          <Link href=\"/history\" className=\"p-2 rounded-md hover:bg-accent transition-colors\">\n            <Clock className=\"h-5 w-5\" />\n          </Link>\n          <Button variant=\"ghost\" size=\"icon\" onClick={() => setLanguage(language === 'en' ? 'ar' : 'en')}>\n             <Globe className=\"h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n    </nav>\n  );\n}\n","path":null,"size_bytes":3189,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4419,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7406,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1877,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/empty.tsx":{"content":"import { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Empty({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty\"\n      className={cn(\n        \"flex min-w-0 flex-1 flex-col items-center justify-center gap-6 text-balance rounded-lg border-dashed p-6 text-center md:p-12\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-header\"\n      className={cn(\n        \"flex max-w-sm flex-col items-center gap-2 text-center\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst emptyMediaVariants = cva(\n  \"mb-2 flex shrink-0 items-center justify-center [&_svg]:pointer-events-none [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        icon: \"bg-muted text-foreground flex size-10 shrink-0 items-center justify-center rounded-lg [&_svg:not([class*='size-'])]:size-6\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction EmptyMedia({\n  className,\n  variant = \"default\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof emptyMediaVariants>) {\n  return (\n    <div\n      data-slot=\"empty-icon\"\n      data-variant={variant}\n      className={cn(emptyMediaVariants({ variant, className }))}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-title\"\n      className={cn(\"text-lg font-medium tracking-tight\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <div\n      data-slot=\"empty-description\"\n      className={cn(\n        \"text-muted-foreground [&>a:hover]:text-primary text-sm/relaxed [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction EmptyContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"empty-content\"\n      className={cn(\n        \"flex w-full min-w-0 max-w-sm flex-col items-center gap-4 text-balance text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Empty,\n  EmptyHeader,\n  EmptyTitle,\n  EmptyDescription,\n  EmptyContent,\n  EmptyMedia,\n}\n","path":null,"size_bytes":2396,"size_tokens":null},"client/src/components/ui/input-group.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Textarea } from \"@/components/ui/textarea\"\n\nfunction InputGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"input-group\"\n      role=\"group\"\n      className={cn(\n        \"group/input-group border-input dark:bg-input/30 shadow-xs relative flex w-full items-center rounded-md border outline-none transition-[color,box-shadow]\",\n        \"h-9 has-[>textarea]:h-auto\",\n\n        // Variants based on alignment.\n        \"has-[>[data-align=inline-start]]:[&>input]:pl-2\",\n        \"has-[>[data-align=inline-end]]:[&>input]:pr-2\",\n        \"has-[>[data-align=block-start]]:h-auto has-[>[data-align=block-start]]:flex-col has-[>[data-align=block-start]]:[&>input]:pb-3\",\n        \"has-[>[data-align=block-end]]:h-auto has-[>[data-align=block-end]]:flex-col has-[>[data-align=block-end]]:[&>input]:pt-3\",\n\n        // Focus state.\n        \"has-[[data-slot=input-group-control]:focus-visible]:ring-ring has-[[data-slot=input-group-control]:focus-visible]:ring-1\",\n\n        // Error state.\n        \"has-[[data-slot][aria-invalid=true]]:ring-destructive/20 has-[[data-slot][aria-invalid=true]]:border-destructive dark:has-[[data-slot][aria-invalid=true]]:ring-destructive/40\",\n\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupAddonVariants = cva(\n  \"text-muted-foreground flex h-auto cursor-text select-none items-center justify-center gap-2 py-1.5 text-sm font-medium group-data-[disabled=true]/input-group:opacity-50 [&>kbd]:rounded-[calc(var(--radius)-5px)] [&>svg:not([class*='size-'])]:size-4\",\n  {\n    variants: {\n      align: {\n        \"inline-start\":\n          \"order-first pl-3 has-[>button]:ml-[-0.45rem] has-[>kbd]:ml-[-0.35rem]\",\n        \"inline-end\":\n          \"order-last pr-3 has-[>button]:mr-[-0.4rem] has-[>kbd]:mr-[-0.35rem]\",\n        \"block-start\":\n          \"[.border-b]:pb-3 order-first w-full justify-start px-3 pt-3 group-has-[>input]/input-group:pt-2.5\",\n        \"block-end\":\n          \"[.border-t]:pt-3 order-last w-full justify-start px-3 pb-3 group-has-[>input]/input-group:pb-2.5\",\n      },\n    },\n    defaultVariants: {\n      align: \"inline-start\",\n    },\n  }\n)\n\nfunction InputGroupAddon({\n  className,\n  align = \"inline-start\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof inputGroupAddonVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"input-group-addon\"\n      data-align={align}\n      className={cn(inputGroupAddonVariants({ align }), className)}\n      onClick={(e) => {\n        if ((e.target as HTMLElement).closest(\"button\")) {\n          return\n        }\n        e.currentTarget.parentElement?.querySelector(\"input\")?.focus()\n      }}\n      {...props}\n    />\n  )\n}\n\nconst inputGroupButtonVariants = cva(\n  \"flex items-center gap-2 text-sm shadow-none\",\n  {\n    variants: {\n      size: {\n        xs: \"h-6 gap-1 rounded-[calc(var(--radius)-5px)] px-2 has-[>svg]:px-2 [&>svg:not([class*='size-'])]:size-3.5\",\n        sm: \"h-8 gap-1.5 rounded-md px-2.5 has-[>svg]:px-2.5\",\n        \"icon-xs\":\n          \"size-6 rounded-[calc(var(--radius)-5px)] p-0 has-[>svg]:p-0\",\n        \"icon-sm\": \"size-8 p-0 has-[>svg]:p-0\",\n      },\n    },\n    defaultVariants: {\n      size: \"xs\",\n    },\n  }\n)\n\nfunction InputGroupButton({\n  className,\n  type = \"button\",\n  variant = \"ghost\",\n  size = \"xs\",\n  ...props\n}: Omit<React.ComponentProps<typeof Button>, \"size\"> &\n  VariantProps<typeof inputGroupButtonVariants>) {\n  return (\n    <Button\n      type={type}\n      data-size={size}\n      variant={variant}\n      className={cn(inputGroupButtonVariants({ size }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupText({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\n        \"text-muted-foreground flex items-center gap-2 text-sm [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupInput({\n  className,\n  ...props\n}: React.ComponentProps<\"input\">) {\n  return (\n    <Input\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 rounded-none border-0 bg-transparent shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction InputGroupTextarea({\n  className,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  return (\n    <Textarea\n      data-slot=\"input-group-control\"\n      className={cn(\n        \"flex-1 resize-none rounded-none border-0 bg-transparent py-3 shadow-none focus-visible:ring-0 dark:bg-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupText,\n  InputGroupInput,\n  InputGroupTextarea,\n}\n","path":null,"size_bytes":4971,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1148,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2356,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1486,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport tailwindcss from \"@tailwindcss/vite\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { metaImagesPlugin } from \"./vite-plugin-meta-images\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    tailwindcss(),\n    metaImagesPlugin(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  css: {\n    postcss: {\n      plugins: [],\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    allowedHosts: true,\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1330,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":2001,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1598,"size_tokens":null},"client/src/pages/SignPDF.tsx":{"content":"import { useState, useRef, useEffect, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, PenTool, Type, Trash2, Check, Download, Plus } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { PDFDocument } from 'pdf-lib';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface PlacedSignature {\n  id: string;\n  dataUrl: string;\n  dimensions: { width: number; height: number };\n  position: { x: number; y: number };\n  page: number;\n}\n\nexport default function SignPDF() {\n  const { language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [signatureMode, setSignatureMode] = useState<'draw' | 'type'>('draw');\n  const [signatureDataUrl, setSignatureDataUrl] = useState<string | null>(null);\n  const [typedSignature, setTypedSignature] = useState('');\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [allPageUrls, setAllPageUrls] = useState<{ page: number; url: string }[]>([]);\n  const [signaturePosition, setSignaturePosition] = useState({ x: 50, y: 80 });\n  const [hasDrawnAnything, setHasDrawnAnything] = useState(false);\n  const [signatureDimensions, setSignatureDimensions] = useState<{ width: number; height: number } | null>(null);\n  const [placedSignatures, setPlacedSignatures] = useState<PlacedSignature[]>([]);\n  const [resizingSigId, setResizingSigId] = useState<string | null>(null);\n  const [resizeStart, setResizeStart] = useState<{ width: number; height: number; clientX: number; clientY: number } | null>(null);\n  const [draggingSigId, setDraggingSigId] = useState<string | null>(null);\n  const [dragStart, setDragStart] = useState<{ x: number; y: number; clientX: number; clientY: number; containerRect: DOMRect } | null>(null);\n  \n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const previewCanvasRef = useRef<HTMLCanvasElement>(null);\n  const previewContainerRef = useRef<HTMLDivElement>(null);\n  const isDrawing = useRef(false);\n  const lastPos = useRef({ x: 0, y: 0 });\n  const pdfDocRef = useRef<any>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setPlacedSignatures([]);\n      loadPdfPreview(files[0]);\n    }\n  };\n\n  const loadPdfPreview = async (pdfFile: File) => {\n    try {\n      const arrayBuffer = await pdfFile.arrayBuffer();\n      const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n      pdfDocRef.current = pdf;\n      setTotalPages(pdf.numPages);\n      \n      const pages = [];\n      for (let i = 1; i <= pdf.numPages; i++) {\n        const url = await renderFullPage(i, pdf);\n        pages.push({ page: i, url });\n      }\n      setAllPageUrls(pages);\n    } catch (error) {\n      console.error('Error loading PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: language === 'ar' ? 'فشل في تحميل ملف PDF' : 'Failed to load PDF file',\n        variant: 'destructive'\n      });\n    }\n  };\n\n  const renderFullPage = async (pageNum: number, pdf: any): Promise<string> => {\n    try {\n      const page = await pdf.getPage(pageNum);\n      const viewport = page.getViewport({ scale: 1.5 });\n      \n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d')!;\n      canvas.height = viewport.height;\n      canvas.width = viewport.width;\n\n      await page.render({ canvasContext: context, viewport }).promise;\n      return canvas.toDataURL('image/jpeg', 0.85);\n    } catch (error) {\n      console.error(`Error rendering page ${pageNum}:`, error);\n      return '';\n    }\n  };\n\n  const handlePageClick = (pageNum: number) => {\n    setCurrentPage(pageNum);\n  };\n\n  const initCanvas = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.strokeStyle = '#000';\n    ctx.lineWidth = 2;\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n  }, []);\n\n  useEffect(() => {\n    initCanvas();\n  }, [initCanvas]);\n\n  const saveSignature = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !hasDrawnAnything) return;\n    const dataUrl = canvas.toDataURL('image/png');\n    setSignatureDataUrl(dataUrl);\n    \n    const img = new Image();\n    img.onload = () => {\n      const maxWidth = 300;\n      const maxHeight = 100;\n      const scale = Math.min(maxWidth / img.width, maxHeight / img.height);\n      setSignatureDimensions({\n        width: img.width * scale,\n        height: img.height * scale\n      });\n    };\n    img.src = dataUrl;\n  }, [hasDrawnAnything]);\n\n  useEffect(() => {\n    const handleGlobalMouseUp = () => {\n      if (isDrawing.current) {\n        isDrawing.current = false;\n        saveSignature();\n      }\n    };\n\n    const handleGlobalTouchEnd = () => {\n      if (isDrawing.current) {\n        isDrawing.current = false;\n        saveSignature();\n      }\n    };\n\n    window.addEventListener('mouseup', handleGlobalMouseUp);\n    window.addEventListener('touchend', handleGlobalTouchEnd);\n    window.addEventListener('touchcancel', handleGlobalTouchEnd);\n\n    return () => {\n      window.removeEventListener('mouseup', handleGlobalMouseUp);\n      window.removeEventListener('touchend', handleGlobalTouchEnd);\n      window.removeEventListener('touchcancel', handleGlobalTouchEnd);\n    };\n  }, [saveSignature]);\n\n  const startDrawing = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    e.preventDefault();\n    isDrawing.current = true;\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\n    const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\n    \n    lastPos.current = {\n      x: (clientX - rect.left) * scaleX,\n      y: (clientY - rect.top) * scaleY\n    };\n  };\n\n  const draw = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    e.preventDefault();\n    if (!isDrawing.current) return;\n    \n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    const clientX = 'touches' in e ? e.touches[0].clientX : e.clientX;\n    const clientY = 'touches' in e ? e.touches[0].clientY : e.clientY;\n    \n    const currentPos = {\n      x: (clientX - rect.left) * scaleX,\n      y: (clientY - rect.top) * scaleY\n    };\n\n    ctx.strokeStyle = '#000';\n    ctx.lineWidth = 2;\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.beginPath();\n    ctx.moveTo(lastPos.current.x, lastPos.current.y);\n    ctx.lineTo(currentPos.x, currentPos.y);\n    ctx.stroke();\n\n    lastPos.current = currentPos;\n    setHasDrawnAnything(true);\n  };\n\n  const stopDrawing = () => {\n    if (isDrawing.current) {\n      isDrawing.current = false;\n      saveSignature();\n    }\n  };\n\n  const clearSignature = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    setSignatureDataUrl(null);\n    setSignatureDimensions(null);\n    setHasDrawnAnything(false);\n  };\n\n  const generateTypedSignature = useCallback(() => {\n    if (!typedSignature.trim()) {\n      setSignatureDataUrl(null);\n      setSignatureDimensions(null);\n      return;\n    }\n\n    const canvas = document.createElement('canvas');\n    canvas.width = 400;\n    canvas.height = 100;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = '#000';\n    ctx.font = 'italic 48px \"Dancing Script\", cursive, serif';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(typedSignature, 20, 50);\n\n    const dataUrl = canvas.toDataURL('image/png');\n    setSignatureDataUrl(dataUrl);\n    \n    const img = new Image();\n    img.onload = () => {\n      const maxWidth = 300;\n      const maxHeight = 100;\n      const scale = Math.min(maxWidth / img.width, maxHeight / img.height);\n      setSignatureDimensions({\n        width: img.width * scale,\n        height: img.height * scale\n      });\n    };\n    img.src = dataUrl;\n  }, [typedSignature]);\n\n  useEffect(() => {\n    if (signatureMode === 'type') {\n      generateTypedSignature();\n    }\n  }, [typedSignature, signatureMode, generateTypedSignature]);\n\n  const handlePreviewClick = (e: React.MouseEvent<HTMLDivElement>, pageNum: number) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = ((e.clientX - rect.left) / rect.width) * 100;\n    const y = ((e.clientY - rect.top) / rect.height) * 100;\n    setSignaturePosition({ x, y });\n    setCurrentPage(pageNum);\n  };\n\n  const addSignature = () => {\n    if (!signatureDataUrl || !signatureDimensions) return;\n    \n    const newSignature: PlacedSignature = {\n      id: `sig-${Date.now()}-${Math.random()}`,\n      dataUrl: signatureDataUrl,\n      dimensions: signatureDimensions,\n      position: { ...signaturePosition },\n      page: currentPage\n    };\n    \n    setPlacedSignatures([...placedSignatures, newSignature]);\n    \n    toast({\n      title: language === 'ar' ? 'تم!' : 'Added!',\n      description: language === 'ar' ? 'تم إضافة التوقيع' : 'Signature added to page',\n    });\n  };\n\n  const removeSignature = (id: string) => {\n    setPlacedSignatures(placedSignatures.filter(sig => sig.id !== id));\n  };\n\n  const handleResizeStart = (e: React.MouseEvent, sigId: string) => {\n    e.stopPropagation();\n    const sig = placedSignatures.find(s => s.id === sigId);\n    if (sig) {\n      setResizingSigId(sigId);\n      setResizeStart({\n        width: sig.dimensions.width,\n        height: sig.dimensions.height,\n        clientX: e.clientX,\n        clientY: e.clientY\n      });\n    }\n  };\n\n  const handleResizePreviewStart = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (signatureDimensions) {\n      setResizingSigId('preview');\n      setResizeStart({\n        width: signatureDimensions.width,\n        height: signatureDimensions.height,\n        clientX: e.clientX,\n        clientY: e.clientY\n      });\n    }\n  };\n\n  const handleDragStart = (e: React.MouseEvent, sigId: string, isPreview: boolean = false) => {\n    if (e.buttons !== 1) return;\n    e.stopPropagation();\n    \n    const container = e.currentTarget.closest('[data-testid$=\"-page\"]') as HTMLElement;\n    if (!container) return;\n    \n    const containerRect = container.getBoundingClientRect();\n    const imgRect = (container.querySelector('img') as HTMLElement)?.getBoundingClientRect();\n    \n    if (isPreview) {\n      setDraggingSigId('preview');\n      setDragStart({\n        x: signaturePosition.x,\n        y: signaturePosition.y,\n        clientX: e.clientX,\n        clientY: e.clientY,\n        containerRect: new DOMRect(imgRect?.left || 0, imgRect?.top || 0, imgRect?.width || 0, imgRect?.height || 0)\n      });\n    } else {\n      const sig = placedSignatures.find(s => s.id === sigId);\n      if (sig) {\n        setDraggingSigId(sigId);\n        setDragStart({\n          x: sig.position.x,\n          y: sig.position.y,\n          clientX: e.clientX,\n          clientY: e.clientY,\n          containerRect: new DOMRect(imgRect?.left || 0, imgRect?.top || 0, imgRect?.width || 0, imgRect?.height || 0)\n        });\n      }\n    }\n  };\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!dragStart || !draggingSigId) {\n        if (!resizeStart || !resizingSigId) return;\n\n        const deltaX = e.clientX - resizeStart.clientX;\n        const deltaY = e.clientY - resizeStart.clientY;\n        const delta = deltaX + deltaY;\n\n        const newWidth = Math.max(50, resizeStart.width + delta);\n        const aspectRatio = resizeStart.width / resizeStart.height;\n        const newHeight = newWidth / aspectRatio;\n\n        if (resizingSigId === 'preview' && signatureDimensions) {\n          setSignatureDimensions({ width: newWidth, height: newHeight });\n        } else {\n          setPlacedSignatures(prev =>\n            prev.map(sig =>\n              sig.id === resizingSigId\n                ? { ...sig, dimensions: { width: newWidth, height: newHeight } }\n                : sig\n            )\n          );\n        }\n        return;\n      }\n\n      const deltaX = e.clientX - dragStart.clientX;\n      const deltaY = e.clientY - dragStart.clientY;\n\n      const percentX = (deltaX / dragStart.containerRect.width) * 100;\n      const percentY = (deltaY / dragStart.containerRect.height) * 100;\n\n      const newX = Math.max(0, Math.min(100, dragStart.x + percentX));\n      const newY = Math.max(0, Math.min(100, dragStart.y + percentY));\n\n      if (draggingSigId === 'preview') {\n        setSignaturePosition({ x: newX, y: newY });\n      } else {\n        setPlacedSignatures(prev =>\n          prev.map(sig =>\n            sig.id === draggingSigId\n              ? { ...sig, position: { x: newX, y: newY } }\n              : sig\n          )\n        );\n      }\n    };\n\n    const handleMouseUp = () => {\n      setResizingSigId(null);\n      setResizeStart(null);\n      setDraggingSigId(null);\n      setDragStart(null);\n    };\n\n    if (resizingSigId || draggingSigId) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      return () => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n    }\n  }, [resizingSigId, resizeStart, draggingSigId, dragStart, signatureDimensions, placedSignatures, signaturePosition]);\n\n  const handleSignPDF = async () => {\n    if (!file || placedSignatures.length === 0 || !previewContainerRef.current) return;\n\n    setIsProcessing(true);\n\n    try {\n      const fileArrayBuffer = await file.arrayBuffer();\n      const pdfDoc = await PDFDocument.load(fileArrayBuffer);\n      const pages = pdfDoc.getPages();\n      const previewRect = previewContainerRef.current.getBoundingClientRect();\n\n      for (const sig of placedSignatures) {\n        const page = pages[sig.page - 1];\n        if (!page) continue;\n\n        const signatureImageBytes = await fetch(sig.dataUrl).then(res => res.arrayBuffer());\n        const signatureImage = await pdfDoc.embedPng(signatureImageBytes);\n\n        const { width: pdfWidth, height: pdfHeight } = page.getSize();\n        const scaleRatio = pdfWidth / previewRect.width;\n        \n        const sigWidth = sig.dimensions.width * scaleRatio;\n        const sigHeight = sig.dimensions.height * scaleRatio;\n        const sigX = (sig.position.x / 100) * pdfWidth - sigWidth / 2;\n        const sigY = pdfHeight - (sig.position.y / 100) * pdfHeight - sigHeight / 2;\n\n        page.drawImage(signatureImage, {\n          x: Math.max(0, Math.min(sigX, pdfWidth - sigWidth)),\n          y: Math.max(0, Math.min(sigY, pdfHeight - sigHeight)),\n          width: sigWidth,\n          height: sigHeight,\n        });\n      }\n\n      const signedPdfBytes = await pdfDoc.save();\n      const blob = new Blob([signedPdfBytes], { type: 'application/pdf' });\n      const url = URL.createObjectURL(blob);\n      \n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `signed-${file.name}`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      toast({\n        title: language === 'ar' ? 'نجاح!' : 'Success!',\n        description: language === 'ar' ? 'تم توقيع ملف PDF بنجاح' : 'Your PDF has been signed successfully.',\n      });\n    } catch (error: any) {\n      console.error('Error signing PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' ? 'فشل في توقيع PDF' : 'Failed to sign PDF'),\n        variant: 'destructive'\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const hasValidSignature = signatureDataUrl !== null;\n  const hasPlacedSignatures = placedSignatures.length > 0;\n\n  return (\n    <ToolPageLayout\n      title={language === 'ar' ? 'توقيع PDF' : 'Sign PDF'}\n      description={language === 'ar' ? 'أضف توقيعاتك إلى مستندات PDF' : 'Add your signatures to PDF documents'}\n      isProcessing={isProcessing}\n      actionButton={\n        file && hasPlacedSignatures && (\n          <Button \n            size=\"lg\" \n            onClick={handleSignPDF}\n            disabled={isProcessing}\n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n            data-testid=\"button-sign-pdf\"\n          >\n            <Download className=\"h-5 w-5 me-2\" />\n            {language === 'ar' ? 'تحميل PDF الموقع' : 'Download Signed PDF'}\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لتوقيعه' : 'Select a PDF file to sign'}\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-gray-600\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-filename\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-info\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB • {totalPages} {language === 'ar' ? 'صفحات' : 'pages'}\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={() => { setFile(null); setPlacedSignatures([]); setPdfPreviewUrl(null); setHasDrawnAnything(false); }}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          {hasPlacedSignatures && (\n            <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-4\">\n              <p className=\"text-sm font-medium text-blue-900 mb-3\">\n                {language === 'ar' ? `${placedSignatures.length} توقيع مضاف` : `${placedSignatures.length} signature(s) added`}\n              </p>\n              <div className=\"flex flex-wrap gap-2\">\n                {placedSignatures.map((sig) => (\n                  <div key={sig.id} className=\"flex items-center gap-2 bg-white px-3 py-2 rounded-lg border border-blue-200\">\n                    <span className=\"text-xs font-medium\">\n                      {language === 'ar' ? `ص ${sig.page}` : `Page ${sig.page}`}\n                    </span>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => removeSignature(sig.id)}\n                      className=\"h-5 w-5 p-0\"\n                      data-testid={`button-remove-sig-${sig.id}`}\n                    >\n                      <X className=\"h-3 w-3\" />\n                    </Button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"grid lg:grid-cols-2 gap-6\">\n            <div className=\"space-y-4\">\n              <div className=\"bg-card p-6 rounded-2xl border border-border/50 shadow-sm\">\n                <h3 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                  <PenTool className=\"h-5 w-5 text-primary\" />\n                  {language === 'ar' ? 'إنشاء التوقيع' : 'Create Signature'}\n                </h3>\n\n                <Tabs value={signatureMode} onValueChange={(v) => setSignatureMode(v as 'draw' | 'type')}>\n                  <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n                    <TabsTrigger value=\"draw\" className=\"flex items-center gap-2\" data-testid=\"tab-draw\">\n                      <PenTool className=\"h-4 w-4\" />\n                      {language === 'ar' ? 'رسم' : 'Draw'}\n                    </TabsTrigger>\n                    <TabsTrigger value=\"type\" className=\"flex items-center gap-2\" data-testid=\"tab-type\">\n                      <Type className=\"h-4 w-4\" />\n                      {language === 'ar' ? 'كتابة' : 'Type'}\n                    </TabsTrigger>\n                  </TabsList>\n\n                  <TabsContent value=\"draw\" className=\"space-y-3\">\n                    <div className=\"border-2 border-dashed border-border rounded-lg overflow-hidden bg-white\">\n                      <canvas\n                        ref={canvasRef}\n                        width={400}\n                        height={150}\n                        className=\"w-full cursor-crosshair touch-none\"\n                        onMouseDown={startDrawing}\n                        onMouseMove={draw}\n                        onMouseUp={stopDrawing}\n                        onMouseLeave={stopDrawing}\n                        onTouchStart={startDrawing}\n                        onTouchMove={draw}\n                        onTouchEnd={stopDrawing}\n                        data-testid=\"canvas-signature\"\n                      />\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\" \n                        onClick={() => {\n                          clearSignature();\n                          setTypedSignature('');\n                        }} \n                        className=\"flex-1\"\n                        data-testid=\"button-clear-signature\"\n                      >\n                        <Trash2 className=\"h-4 w-4 me-2\" />\n                        {signatureDataUrl ? (language === 'ar' ? 'رسم جديد' : 'Draw New') : (language === 'ar' ? 'مسح' : 'Clear')}\n                      </Button>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground text-center\">\n                      {language === 'ar' ? 'ارسم توقيعك باستخدام الماوس أو شاشة اللمس' : 'Draw your signature using mouse or touch screen'}\n                    </p>\n                  </TabsContent>\n\n                  <TabsContent value=\"type\" className=\"space-y-3\">\n                    <div className=\"space-y-2\">\n                      <Label>{language === 'ar' ? 'اكتب توقيعك' : 'Type your signature'}</Label>\n                      <Input\n                        value={typedSignature}\n                        onChange={(e) => setTypedSignature(e.target.value)}\n                        placeholder={language === 'ar' ? 'اسمك هنا' : 'Your name here'}\n                        className=\"text-2xl font-serif italic h-14\"\n                        data-testid=\"input-typed-signature\"\n                      />\n                    </div>\n                    {signatureDataUrl && (\n                      <div className=\"border rounded-lg p-4 bg-white\" data-testid=\"preview-typed-signature\">\n                        <img src={signatureDataUrl} alt=\"Typed signature preview\" className=\"max-h-20\" />\n                      </div>\n                    )}\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      onClick={() => {\n                        setSignatureDataUrl(null);\n                        setSignatureDimensions(null);\n                        setTypedSignature('');\n                      }} \n                      className=\"w-full\"\n                      data-testid=\"button-clear-typed\"\n                    >\n                      <Trash2 className=\"h-4 w-4 me-2\" />\n                      {language === 'ar' ? 'رسم جديد' : 'Draw New'}\n                    </Button>\n                  </TabsContent>\n                </Tabs>\n\n              </div>\n            </div>\n\n            <div className=\"space-y-4 flex-1\">\n              <div className=\"bg-card p-6 rounded-2xl border border-border/50 shadow-sm h-full flex flex-col relative\">\n                <h3 className=\"text-lg font-semibold mb-4\">\n                  {language === 'ar' ? 'معاينة PDF' : 'PDF Preview'}\n                </h3>\n\n                <div className=\"flex-1 overflow-y-auto border rounded-lg bg-gray-50 space-y-4 p-4\" data-testid=\"pdf-pages-container\">\n                  {allPageUrls.map((pageData) => (\n                    <div\n                      key={pageData.page}\n                      className=\"flex flex-col items-center gap-2\"\n                    >\n                      <div \n                        onClick={(e) => handlePreviewClick(e, pageData.page)}\n                        onMouseEnter={() => setCurrentPage(pageData.page)}\n                        className={`relative border-2 rounded-lg overflow-hidden cursor-crosshair transition-all w-full max-w-lg ${\n                          currentPage === pageData.page \n                            ? 'border-primary ring-2 ring-primary' \n                            : 'border-gray-300'\n                        }`}\n                        data-testid={`pdf-page-${pageData.page}`}\n                      >\n                        <img \n                          src={pageData.url} \n                          alt={`PDF Page ${pageData.page}`}\n                          className=\"w-full\"\n                          draggable={false}\n                        />\n                        \n                        {signatureDataUrl && signatureDimensions && currentPage === pageData.page && (\n                          <div\n                            onMouseDown={(e) => handleDragStart(e, 'preview', true)}\n                            className=\"absolute border-2 border-primary border-dashed bg-white/80 p-1 rounded group cursor-grab active:cursor-grabbing\"\n                            style={{\n                              left: `${signaturePosition.x}%`,\n                              top: `${signaturePosition.y}%`,\n                              transform: 'translate(-50%, -50%)',\n                              width: `${signatureDimensions.width}px`,\n                              height: `${signatureDimensions.height}px`,\n                            }}\n                            data-testid=\"signature-overlay\"\n                          >\n                            <img \n                              src={signatureDataUrl} \n                              alt=\"Signature\" \n                              style={{\n                                width: '100%',\n                                height: '100%',\n                                objectFit: 'contain'\n                              }}\n                              className=\"pointer-events-none select-none\"\n                            />\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                setSignatureDataUrl(null);\n                                setSignatureDimensions(null);\n                              }}\n                              className=\"absolute top-0 right-0 w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer\"\n                              style={{\n                                transform: 'translate(50%, -50%)'\n                              }}\n                              data-testid=\"delete-preview-signature\"\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </button>\n                            <div\n                              onMouseDown={handleResizePreviewStart}\n                              className=\"absolute bottom-0 right-0 w-3 h-3 bg-primary cursor-se-resize opacity-0 group-hover:opacity-100 transition-opacity\"\n                              style={{\n                                transform: 'translate(50%, 50%)'\n                              }}\n                              data-testid=\"resize-handle-preview\"\n                            />\n                          </div>\n                        )}\n\n                        {placedSignatures.filter(sig => sig.page === pageData.page).map((sig) => (\n                          <div\n                            key={sig.id}\n                            onMouseDown={(e) => handleDragStart(e, sig.id)}\n                            className=\"absolute group cursor-grab active:cursor-grabbing\"\n                            style={{\n                              left: `${sig.position.x}%`,\n                              top: `${sig.position.y}%`,\n                              transform: 'translate(-50%, -50%)',\n                              width: `${sig.dimensions.width}px`,\n                              height: `${sig.dimensions.height}px`,\n                            }}\n                            data-testid={`placed-sig-${sig.id}`}\n                          >\n                            <img \n                              src={sig.dataUrl} \n                              alt=\"Placed signature\" \n                              style={{\n                                width: '100%',\n                                height: '100%',\n                                objectFit: 'contain'\n                              }}\n                              className=\"pointer-events-none select-none\"\n                            />\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                removeSignature(sig.id);\n                              }}\n                              className=\"absolute top-0 right-0 w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer\"\n                              style={{\n                                transform: 'translate(50%, -50%)'\n                              }}\n                              data-testid={`delete-sig-${sig.id}`}\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </button>\n                            <div\n                              onMouseDown={(e) => handleResizeStart(e, sig.id)}\n                              className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 cursor-se-resize opacity-0 group-hover:opacity-100 transition-opacity\"\n                              style={{\n                                transform: 'translate(50%, 50%)'\n                              }}\n                              data-testid={`resize-handle-${sig.id}`}\n                            />\n                          </div>\n                        ))}\n                      </div>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {language === 'ar' ? 'الصفحة ' : 'Page '}{pageData.page}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n\n                <p className=\"text-xs text-muted-foreground text-center mt-4\">\n                  {language === 'ar' ? 'انقر على المستند لتحديد موضع التوقيع' : 'Click on the document to position your signature'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {file && signatureDataUrl && createPortal(\n        <Button \n          onClick={addSignature} \n          className=\"fixed bottom-6 right-6 z-[9999] shadow-xl rounded-full px-6 py-4 h-auto text-lg\"\n          size=\"lg\"\n          data-testid=\"button-add-signature\"\n        >\n          <Plus className=\"h-5 w-5 me-2\" />\n          {language === 'ar' ? 'إضافة التوقيع' : 'Add Signature'}\n        </Button>,\n        document.body\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":33107,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"import * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1237,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { LanguageProvider } from \"@/lib/i18n\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/Home\";\nimport MergePDF from \"@/pages/MergePDF\";\nimport SplitPDF from \"@/pages/SplitPDF\";\nimport ProtectPDF from \"@/pages/ProtectPDF\";\nimport UnlockPDF from \"@/pages/UnlockPDF\";\nimport WatermarkPDF from \"@/pages/WatermarkPDF\";\nimport CompressPDF from \"@/pages/CompressPDF\";\nimport PDFToWord from \"@/pages/PDFToWord\";\nimport RemovePages from \"@/pages/RemovePages\";\nimport RotatePDF from \"@/pages/RotatePDF\";\nimport OrganizePDF from \"@/pages/OrganizePDF\";\nimport PDFToImagePage from \"@/pages/PDFToImage\";\nimport SignPDF from \"@/pages/SignPDF\";\nimport HTMLtoPDF from \"@/pages/HTMLtoPDF\";\nimport RepairPDF from \"@/pages/RepairPDF\";\nimport PageNumberPDF from \"@/pages/PageNumberPDF\";\nimport DownloadHistory from \"@/pages/DownloadHistory\";\nimport Pricing from \"@/pages/Pricing\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/merge\" component={MergePDF} />\n      <Route path=\"/split\" component={SplitPDF} />\n      <Route path=\"/protect\" component={ProtectPDF} />\n      <Route path=\"/unlock\" component={UnlockPDF} />\n      <Route path=\"/watermark\" component={WatermarkPDF} />\n      <Route path=\"/compress\" component={CompressPDF} />\n      <Route path=\"/pdf-to-word\" component={PDFToWord} />\n      <Route path=\"/remove-pages\" component={RemovePages} />\n      <Route path=\"/rotate\" component={RotatePDF} />\n      <Route path=\"/organize\" component={OrganizePDF} />\n      <Route path=\"/pdf-to-image\" component={PDFToImagePage} />\n      <Route path=\"/sign\" component={SignPDF} />\n      <Route path=\"/html-to-pdf\" component={HTMLtoPDF} />\n      <Route path=\"/repair\" component={RepairPDF} />\n      <Route path=\"/page-numbers\" component={PageNumberPDF} />\n      <Route path=\"/history\" component={DownloadHistory} />\n      <Route path=\"/pricing\" component={Pricing} />\n      {/* Fallback to 404 */}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <LanguageProvider>\n      <QueryClientProvider client={queryClient}>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </QueryClientProvider>\n    </LanguageProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":2554,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1522,"size_tokens":null},"client/src/pages/Home.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { ToolCard } from \"@/components/ToolCard\";\nimport { useLanguage } from \"@/lib/i18n\";\nimport { \n  Merge, \n  Scissors, \n  Minimize2, \n  FileType, \n  FileText, \n  Pencil, \n  Lock, \n  Unlock,\n  Image,\n  FileCheck,\n  Trash2,\n  RotateCw,\n  ArrowUpDown,\n  Code,\n  Wrench\n} from \"lucide-react\";\n\nexport default function Home() {\n  const { t, direction } = useLanguage();\n\n  const tools = [\n    {\n      title: t('tool.merge.title'),\n      description: t('tool.merge.desc'),\n      icon: Merge,\n      href: \"/merge\",\n      color: \"text-blue-500\"\n    },\n    {\n      title: t('tool.split.title'),\n      description: t('tool.split.desc'),\n      icon: Scissors,\n      href: \"/split\",\n      color: \"text-orange-500\"\n    },\n    {\n      title: t('tool.removePages.title'),\n      description: t('tool.removePages.desc'),\n      icon: Trash2,\n      href: \"/remove-pages\",\n      color: \"text-red-500\"\n    },\n    {\n      title: t('tool.rotate.title'),\n      description: t('tool.rotate.desc'),\n      icon: RotateCw,\n      href: \"/rotate\",\n      color: \"text-teal-500\"\n    },\n    {\n      title: t('tool.organize.title'),\n      description: t('tool.organize.desc'),\n      icon: ArrowUpDown,\n      href: \"/organize\",\n      color: \"text-indigo-500\"\n    },\n    {\n      title: t('tool.compress.title'),\n      description: t('tool.compress.desc'),\n      icon: Minimize2,\n      href: \"/compress\",\n      color: \"text-green-500\"\n    },\n    {\n      title: t('tool.pdfToWord.title'),\n      description: t('tool.pdfToWord.desc'),\n      icon: FileType,\n      href: \"/pdf-to-word\",\n      color: \"text-blue-600\"\n    },\n    {\n      title: t('tool.wordToPdf.title'),\n      description: t('tool.wordToPdf.desc'),\n      icon: FileText,\n      href: \"/word-to-pdf\",\n      color: \"text-blue-700\"\n    },\n    {\n      title: t('tool.edit.title'),\n      description: t('tool.edit.desc'),\n      icon: Pencil,\n      href: \"/edit\",\n      color: \"text-purple-500\"\n    },\n    {\n      title: t('tool.protect.title'),\n      description: t('tool.protect.desc'),\n      icon: Lock,\n      href: \"/protect\",\n      color: \"text-gray-600\"\n    },\n    {\n      title: t('tool.unlock.title'),\n      description: t('tool.unlock.desc'),\n      icon: Unlock,\n      href: \"/unlock\",\n      color: \"text-pink-500\"\n    },\n    {\n      title: t('tool.pdfToImage.title'),\n      description: t('tool.pdfToImage.desc'),\n      icon: Image,\n      href: \"/pdf-to-image\",\n      color: \"text-yellow-500\"\n    },\n     {\n      title: t('tool.sign.title'),\n      description: t('tool.sign.desc'),\n      icon: FileCheck,\n      href: \"/sign\",\n      color: \"text-red-500\"\n    },\n    {\n      title: t('tool.htmlToPdf.title'),\n      description: t('tool.htmlToPdf.desc'),\n      icon: Code,\n      href: \"/html-to-pdf\",\n      color: \"text-cyan-500\"\n    },\n    {\n      title: t('tool.repair.title'),\n      description: t('tool.repair.desc'),\n      icon: Wrench,\n      href: \"/repair\",\n      color: \"text-amber-500\"\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col font-sans\" dir={direction}>\n      <Navbar />\n      \n      <main className=\"flex-1\">\n        {/* Hero Section */}\n        <section className=\"relative pt-20 pb-32 px-4 md:px-6 overflow-hidden\">\n          <div className=\"absolute inset-0 -z-10 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-primary/5 via-background to-background\"></div>\n          \n          <div className=\"container mx-auto max-w-4xl text-center\">\n            <h1 className=\"text-4xl md:text-6xl lg:text-7xl font-bold tracking-tight text-foreground mb-6 animate-in fade-in slide-in-from-bottom-4 duration-700\">\n              {t('hero.title')}\n            </h1>\n            <p className=\"text-xl md:text-2xl text-muted-foreground mb-10 max-w-2xl mx-auto animate-in fade-in slide-in-from-bottom-4 duration-700 delay-150\">\n              {t('hero.subtitle')}\n            </p>\n            \n            <div className=\"flex flex-wrap justify-center gap-4 animate-in fade-in slide-in-from-bottom-4 duration-700 delay-300\">\n              <button className=\"bg-primary text-primary-foreground hover:bg-primary/90 rounded-full px-8 py-4 font-medium text-lg transition-all hover:scale-105 shadow-lg shadow-primary/25\">\n                {t('hero.cta.primary')}\n              </button>\n              <button className=\"bg-background text-foreground border border-border/50 hover:bg-secondary/50 rounded-full px-8 py-4 font-medium text-lg transition-all\">\n                {t('hero.cta.secondary')}\n              </button>\n            </div>\n          </div>\n        </section>\n\n        {/* Tools Grid */}\n        <section className=\"container mx-auto px-4 md:px-6 pb-24\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n            {tools.map((tool, index) => (\n              <ToolCard key={index} {...tool} />\n            ))}\n          </div>\n        </section>\n\n        {/* Features Section */}\n        <section className=\"bg-secondary/30 py-24 px-4 md:px-6\">\n          <div className=\"container mx-auto max-w-5xl\">\n             <div className=\"text-center mb-16\">\n              <h2 className=\"text-3xl md:text-4xl font-bold tracking-tight mb-4\">{t('features.title')}</h2>\n              <p className=\"text-lg text-muted-foreground\">{t('features.subtitle')}</p>\n            </div>\n            \n            <div className=\"grid md:grid-cols-3 gap-12 text-center\">\n              <div>\n                <div className=\"w-16 h-16 rounded-2xl bg-background shadow-sm border border-border/50 flex items-center justify-center mx-auto mb-6 text-primary\">\n                   <Lock className=\"w-8 h-8\" />\n                </div>\n                <h3 className=\"text-xl font-semibold mb-3\">{t('features.secure.title')}</h3>\n                <p className=\"text-muted-foreground\">{t('features.secure.desc')}</p>\n              </div>\n              <div>\n                <div className=\"w-16 h-16 rounded-2xl bg-background shadow-sm border border-border/50 flex items-center justify-center mx-auto mb-6 text-primary\">\n                   <Minimize2 className=\"w-8 h-8\" />\n                </div>\n                <h3 className=\"text-xl font-semibold mb-3\">{t('features.compat.title')}</h3>\n                <p className=\"text-muted-foreground\">{t('features.compat.desc')}</p>\n              </div>\n              <div>\n                <div className=\"w-16 h-16 rounded-2xl bg-background shadow-sm border border-border/50 flex items-center justify-center mx-auto mb-6 text-primary\">\n                   <FileText className=\"w-8 h-8\" />\n                </div>\n                <h3 className=\"text-xl font-semibold mb-3\">{t('features.quality.title')}</h3>\n                <p className=\"text-muted-foreground\">{t('features.quality.desc')}</p>\n              </div>\n            </div>\n          </div>\n        </section>\n      </main>\n      \n      <footer className=\"bg-background border-t border-border/50 py-12 px-4 md:px-6\">\n        <div className=\"container mx-auto flex flex-col md:flex-row justify-between items-center gap-6\">\n          <div className=\"flex items-center gap-2 font-semibold\">\n            <div className=\"flex h-6 w-6 items-center justify-center rounded bg-primary text-primary-foreground\">\n              <FileText className=\"h-3 w-3\" />\n            </div>\n            <span>{t('nav.brand')}</span>\n          </div>\n          <div className=\"text-sm text-muted-foreground\">\n            {t('footer.rights')}\n          </div>\n          <div className=\"flex gap-6 text-sm text-muted-foreground\">\n            <a href=\"#\" className=\"hover:text-foreground transition-colors\">{t('footer.privacy')}</a>\n            <a href=\"#\" className=\"hover:text-foreground transition-colors\">{t('footer.terms')}</a>\n            <a href=\"#\" className=\"hover:text-foreground transition-colors\">{t('footer.contact')}</a>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","path":null,"size_bytes":7929,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1037,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":649,"size_tokens":null},"client/src/pages/CompressPDF.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Download, CheckCircle, Loader2, RotateCcw, Image } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Label } from '@/components/ui/label';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface PageThumbnail {\n  pageNum: number;\n  imageUrl: string;\n  isLoading: boolean;\n}\n\ninterface CompressionResult {\n  originalSize: number;\n  compressedSize: number;\n  elapsedTime: number;\n  downloadUrl: string;\n  fileName: string;\n}\n\nexport default function CompressPDF() {\n  const { t, language, direction } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [compressionLevel, setCompressionLevel] = useState<'extreme' | 'recommended' | 'less'>('recommended');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [result, setResult] = useState<CompressionResult | null>(null);\n  const [thumbnails, setThumbnails] = useState<PageThumbnail[]>([]);\n  const [selectedPages, setSelectedPages] = useState<Set<number>>(new Set());\n  const [totalPages, setTotalPages] = useState(0);\n  const [isLoadingThumbnails, setIsLoadingThumbnails] = useState(false);\n  const [compressionMode, setCompressionMode] = useState<'all' | 'selected'>('all');\n  const pdfDocRef = useRef<any>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setResult(null);\n      setThumbnails([]);\n      setSelectedPages(new Set());\n      setTotalPages(0);\n    }\n  };\n\n  const renderPage = useCallback(async (pdfDoc: any, pageNum: number, renderScale: number = 0.3): Promise<string> => {\n    const page = await pdfDoc.getPage(pageNum);\n    const viewport = page.getViewport({ scale: renderScale });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d')!;\n    canvas.height = viewport.height;\n    canvas.width = viewport.width;\n\n    await page.render({ canvasContext: context, viewport }).promise;\n    return canvas.toDataURL('image/jpeg', 0.7);\n  }, []);\n\n  useEffect(() => {\n    if (!file) return;\n\n    const loadThumbnails = async () => {\n      setIsLoadingThumbnails(true);\n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        pdfDocRef.current = pdfDoc;\n        const numPages = pdfDoc.numPages;\n        setTotalPages(numPages);\n\n        const initialThumbs: PageThumbnail[] = Array.from({ length: numPages }, (_, i) => ({\n          pageNum: i + 1,\n          imageUrl: '',\n          isLoading: true\n        }));\n        setThumbnails(initialThumbs);\n\n        for (let i = 0; i < numPages; i++) {\n          const imageUrl = await renderPage(pdfDoc, i + 1);\n          setThumbnails(prev => prev.map((thumb, idx) => \n            idx === i ? { ...thumb, imageUrl, isLoading: false } : thumb\n          ));\n        }\n      } catch (err) {\n        console.error('Error loading PDF:', err);\n        toast({\n          title: language === 'ar' ? 'خطأ' : 'Error',\n          description: language === 'ar' ? 'فشل في تحميل الملف' : 'Failed to load PDF file',\n          variant: 'destructive'\n        });\n      } finally {\n        setIsLoadingThumbnails(false);\n      }\n    };\n\n    loadThumbnails();\n  }, [file, renderPage, language, toast]);\n\n  const handleTogglePage = (pageNum: number) => {\n    setSelectedPages(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(pageNum)) {\n        newSet.delete(pageNum);\n      } else {\n        newSet.add(pageNum);\n      }\n      return newSet;\n    });\n  };\n\n  const handleSelectAll = () => {\n    setSelectedPages(new Set(Array.from({ length: totalPages }, (_, i) => i + 1)));\n  };\n\n  const handleClearSelection = () => {\n    setSelectedPages(new Set());\n  };\n\n  const handleCompress = async () => {\n    if (!file) return;\n\n    setIsProcessing(true);\n    setResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('level', compressionLevel);\n      \n      if (compressionMode === 'selected' && selectedPages.size > 0) {\n        formData.append('pages', Array.from(selectedPages).join(','));\n      }\n\n      const response = await fetch('/api/pdf/compress', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to compress PDF');\n      }\n\n      const originalSize = parseInt(response.headers.get('X-Original-Size') || '0');\n      const compressedSize = parseInt(response.headers.get('X-Compressed-Size') || '0');\n      const elapsedTime = parseInt(response.headers.get('X-Elapsed-Time') || '0');\n\n      const blob = await response.blob();\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const fileName = `compressed-${file.name}`;\n\n      setResult({\n        originalSize,\n        compressedSize,\n        elapsedTime,\n        downloadUrl,\n        fileName\n      });\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: language === 'ar' \n          ? 'تم ضغط ملف PDF بنجاح' \n          : 'Your PDF has been compressed successfully.',\n      });\n    } catch (error: any) {\n      console.error('Error compressing PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في ضغط PDF. يرجى المحاولة مرة أخرى.' \n          : 'Failed to compress PDF. Please try again.'),\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!result) return;\n    \n    const a = document.createElement('a');\n    a.href = result.downloadUrl;\n    a.download = result.fileName;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    \n    window.URL.revokeObjectURL(result.downloadUrl);\n  };\n\n  const handleReset = () => {\n    if (result?.downloadUrl) {\n      window.URL.revokeObjectURL(result.downloadUrl);\n    }\n    setFile(null);\n    setResult(null);\n    setCompressionLevel('recommended');\n    setThumbnails([]);\n    setSelectedPages(new Set());\n    setTotalPages(0);\n    setCompressionMode('all');\n  };\n\n  const formatSize = (bytes: number) => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / 1024 / 1024).toFixed(2)} MB`;\n  };\n\n  const formatTime = (ms: number) => {\n    if (ms < 1000) return `${ms}ms`;\n    return `${(ms / 1000).toFixed(1)}s`;\n  };\n\n  const getReductionPercent = () => {\n    if (!result || result.originalSize === 0) return 0;\n    return ((1 - result.compressedSize / result.originalSize) * 100).toFixed(1);\n  };\n\n  const compressionOptions = [\n    {\n      id: 'extreme',\n      label: language === 'ar' ? 'أقصى ضغط' : 'Maximum',\n      desc: language === 'ar' ? 'أصغر حجم، جودة أقل' : 'Smallest file, lower quality',\n      reduction: '70-90%'\n    },\n    {\n      id: 'recommended',\n      label: language === 'ar' ? 'متوازن' : 'Balanced',\n      desc: language === 'ar' ? 'جودة جيدة، ضغط جيد' : 'Good quality, good compression',\n      reduction: '40-60%'\n    },\n    {\n      id: 'less',\n      label: language === 'ar' ? 'خفيف' : 'Light',\n      desc: language === 'ar' ? 'جودة عالية، ضغط خفيف' : 'High quality, light compression',\n      reduction: '20-40%'\n    }\n  ];\n\n  return (\n    <ToolPageLayout\n      title={t('tool.compress.title')}\n      description={t('tool.compress.desc')}\n      isProcessing={isProcessing}\n      actionButton={\n        !result && file && (\n          <Button \n            size=\"lg\" \n            onClick={handleCompress}\n            disabled={isProcessing || (compressionMode === 'selected' && selectedPages.size === 0)}\n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n            data-testid=\"button-compress\"\n          >\n            {isProcessing ? (\n              <>\n                <Loader2 className=\"h-5 w-5 animate-spin me-2\" />\n                {language === 'ar' ? 'جاري الضغط...' : 'Compressing...'}\n              </>\n            ) : (\n              language === 'ar' ? 'ضغط PDF' : 'Compress PDF'\n            )}\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF للضغط' : 'Select a PDF file to compress'}\n          />\n        </div>\n      ) : result ? (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          <div className=\"text-center space-y-4 py-8\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم ضغط PDF بنجاح!' : 'PDF Compressed Successfully!'}\n            </h3>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"bg-secondary/30 rounded-xl p-6 text-center border border-border/50\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الحجم الأصلي' : 'Original Size'}\n              </p>\n              <p className=\"text-2xl font-bold\" data-testid=\"text-original-size\">\n                {formatSize(result.originalSize)}\n              </p>\n            </div>\n            <div className=\"bg-green-50 dark:bg-green-950/30 rounded-xl p-6 text-center border border-green-200 dark:border-green-800\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الحجم الجديد' : 'Compressed Size'}\n              </p>\n              <p className=\"text-2xl font-bold text-green-600\" data-testid=\"text-compressed-size\">\n                {formatSize(result.compressedSize)}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex justify-center gap-8 text-center\">\n            <div>\n              <p className=\"text-3xl font-bold text-green-600\" data-testid=\"text-reduction\">\n                {getReductionPercent()}%\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                {language === 'ar' ? 'تم تقليل الحجم' : 'Size Reduced'}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-3xl font-bold text-primary\" data-testid=\"text-elapsed-time\">\n                {formatTime(result.elapsedTime)}\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                {language === 'ar' ? 'الوقت المستغرق' : 'Processing Time'}\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center pt-4\">\n            <Button \n              size=\"lg\"\n              onClick={handleDownload}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-download-compressed\"\n            >\n              <Download className=\"h-5 w-5 me-2\" />\n              {language === 'ar' ? 'تحميل PDF المضغوط' : 'Download Compressed PDF'}\n            </Button>\n            <Button \n              size=\"lg\"\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-compress-another\"\n            >\n              {language === 'ar' ? 'ضغط ملف آخر' : 'Compress Another'}\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-8 max-w-3xl mx-auto\">\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-green-500\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-file-name\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-size\">\n                {formatSize(file.size)}\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={handleReset}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <div className=\"space-y-4 p-4 bg-secondary/20 rounded-xl border border-border/30\">\n              <h3 className=\"text-lg font-semibold\">\n                {language === 'ar' ? 'مستوى الضغط' : 'Compression Level'}\n              </h3>\n              \n              <RadioGroup \n                value={compressionLevel} \n                onValueChange={(v) => setCompressionLevel(v as any)} \n                className=\"space-y-3\"\n              >\n                {compressionOptions.map((option) => (\n                  <div \n                    key={option.id}\n                    className={`\n                      cursor-pointer rounded-lg border-2 p-3 transition-all relative overflow-hidden\n                      ${compressionLevel === option.id ? 'border-primary bg-primary/5' : 'border-border hover:border-primary/30'}\n                    `}\n                    onClick={() => setCompressionLevel(option.id as any)}\n                    data-testid={`option-compression-${option.id}`}\n                  >\n                    <div className=\"flex items-center space-x-2 mb-1 rtl:space-x-reverse\">\n                      <RadioGroupItem value={option.id} id={option.id} />\n                      <Label \n                        htmlFor={option.id} \n                        className={`font-bold cursor-pointer transition-colors ${\n                          compressionLevel === option.id ? 'text-primary' : 'text-foreground'\n                        }`}\n                      >\n                        {option.label}\n                      </Label>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground ps-6\">\n                      {option.desc}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground ps-6 mt-0.5\">\n                      ~{option.reduction}\n                    </p>\n                  </div>\n                ))}\n              </RadioGroup>\n            </div>\n\n            <div className=\"space-y-4 p-4 bg-secondary/20 rounded-xl border border-border/30\">\n              <h4 className=\"font-medium flex items-center gap-2\">\n                <Image className=\"h-4 w-4\" />\n                {language === 'ar' ? 'الصفحات' : 'Pages'}\n              </h4>\n              \n              <RadioGroup value={compressionMode} onValueChange={(v) => setCompressionMode(v as 'all' | 'selected')} className=\"space-y-2\" data-testid=\"radio-compress-mode\">\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"all\" id=\"compress-mode-all\" data-testid=\"radio-compress-all\" />\n                  <Label htmlFor=\"compress-mode-all\" className=\"cursor-pointer\">\n                    {language === 'ar' ? `جميع الصفحات (${totalPages})` : `All pages (${totalPages})`}\n                  </Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"selected\" id=\"compress-mode-selected\" data-testid=\"radio-compress-selected\" />\n                  <Label htmlFor=\"compress-mode-selected\" className=\"cursor-pointer\">\n                    {language === 'ar' ? 'صفحات محددة' : 'Selected pages'}\n                    {selectedPages.size > 0 && ` (${selectedPages.size})`}\n                  </Label>\n                </div>\n              </RadioGroup>\n\n              {compressionMode === 'selected' && (\n                <div className=\"flex gap-2 pt-2\">\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleSelectAll} data-testid=\"button-select-all-compress\">\n                    {language === 'ar' ? 'اختيار الكل' : 'Select All'}\n                  </Button>\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleClearSelection} data-testid=\"button-clear-compress\">\n                    <RotateCcw className=\"h-3 w-3 me-1\" />\n                    {language === 'ar' ? 'إلغاء' : 'Clear'}\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {isLoadingThumbnails && thumbnails.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-8 gap-4\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n              <p className=\"text-muted-foreground\">\n                {language === 'ar' ? 'جاري تحميل صفحات PDF...' : 'Loading PDF pages...'}\n              </p>\n            </div>\n          ) : compressionMode === 'selected' && thumbnails.length > 0 ? (\n            <>\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-muted-foreground\">\n                  {language === 'ar' ? 'انقر على الصفحات لتحديدها' : 'Click pages to select'}\n                </span>\n                {selectedPages.size > 0 && (\n                  <span className=\"font-medium text-primary\">\n                    {language === 'ar' \n                      ? `تم تحديد ${selectedPages.size} صفحة`\n                      : `${selectedPages.size} page${selectedPages.size > 1 ? 's' : ''} selected`}\n                  </span>\n                )}\n              </div>\n\n              <div \n                className=\"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-7 gap-2\"\n                dir={direction}\n              >\n                {thumbnails.map((thumb) => {\n                  const isSelected = selectedPages.has(thumb.pageNum);\n                  \n                  return (\n                    <div\n                      key={thumb.pageNum}\n                      onClick={() => handleTogglePage(thumb.pageNum)}\n                      className={`\n                        relative aspect-[3/4] rounded-lg border-2 overflow-hidden\n                        transition-all duration-200 cursor-pointer hover:border-primary/50 hover:shadow-md\n                        ${isSelected ? 'border-primary ring-2 ring-primary/30' : 'border-border/50'}\n                      `}\n                      data-testid={`page-thumbnail-compress-${thumb.pageNum}`}\n                    >\n                      {thumb.isLoading ? (\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-secondary/50\">\n                          <Loader2 className=\"h-4 w-4 animate-spin text-primary\" />\n                        </div>\n                      ) : (\n                        <img \n                          src={thumb.imageUrl} \n                          alt={`Page ${thumb.pageNum}`}\n                          className=\"w-full h-full object-contain bg-white\"\n                        />\n                      )}\n                      \n                      <div className=\"absolute top-1 left-1 bg-black/70 text-white text-xs px-1 py-0.5 rounded\">\n                        {thumb.pageNum}\n                      </div>\n                      \n                      {isSelected && (\n                        <div className=\"absolute inset-0 bg-primary/20 flex items-center justify-center\">\n                          <CheckCircle className=\"h-6 w-6 text-primary\" />\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </>\n          ) : null}\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":20637,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"import * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload\n            .filter((item) => item.type !== \"none\")\n            .map((item, index) => {\n              const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n              const itemConfig = getPayloadConfigFromPayload(config, item, key)\n              const indicatorColor = color || item.payload.fill || item.color\n\n              return (\n                <div\n                  key={item.dataKey}\n                  className={cn(\n                    \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                    indicator === \"dot\" && \"items-center\"\n                  )}\n                >\n                  {formatter && item?.value !== undefined && item.name ? (\n                    formatter(item.value, item.name, item, index, item.payload)\n                  ) : (\n                    <>\n                      {itemConfig?.icon ? (\n                        <itemConfig.icon />\n                      ) : (\n                        !hideIndicator && (\n                          <div\n                            className={cn(\n                              \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                              {\n                                \"h-2.5 w-2.5\": indicator === \"dot\",\n                                \"w-1\": indicator === \"line\",\n                                \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                  indicator === \"dashed\",\n                                \"my-0.5\": nestLabel && indicator === \"dashed\",\n                              }\n                            )}\n                            style={\n                              {\n                                \"--color-bg\": indicatorColor,\n                                \"--color-border\": indicatorColor,\n                              } as React.CSSProperties\n                            }\n                          />\n                        )\n                      )}\n                      <div\n                        className={cn(\n                          \"flex flex-1 justify-between leading-none\",\n                          nestLabel ? \"items-end\" : \"items-center\"\n                        )}\n                      >\n                        <div className=\"grid gap-1.5\">\n                          {nestLabel ? tooltipLabel : null}\n                          <span className=\"text-muted-foreground\">\n                            {itemConfig?.label || item.name}\n                          </span>\n                        </div>\n                        {item.value && (\n                          <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                            {item.value.toLocaleString()}\n                          </span>\n                        )}\n                      </div>\n                    </>\n                  )}\n                </div>\n              )\n            })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload\n          .filter((item) => item.type !== \"none\")\n          .map((item) => {\n            const key = `${nameKey || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n            return (\n              <div\n                key={item.value}\n                className={cn(\n                  \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n                )}\n              >\n                {itemConfig?.icon && !hideIcon ? (\n                  <itemConfig.icon />\n                ) : (\n                  <div\n                    className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                    style={{\n                      backgroundColor: item.color,\n                    }}\n                  />\n                )}\n                {itemConfig?.label}\n              </div>\n            )\n          })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10763,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4887,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2143,"size_tokens":null},"client/src/components/ui/sonner.tsx":{"content":"\"use client\"\n\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n","path":null,"size_bytes":894,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1410,"size_tokens":null},"client/src/components/ui/button-group.tsx":{"content":"import { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Separator } from \"@/components/ui/separator\"\n\nconst buttonGroupVariants = cva(\n  \"flex w-fit items-stretch has-[>[data-slot=button-group]]:gap-2 [&>*]:focus-visible:relative [&>*]:focus-visible:z-10 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1\",\n  {\n    variants: {\n      orientation: {\n        horizontal:\n          \"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none\",\n        vertical:\n          \"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none\",\n      },\n    },\n    defaultVariants: {\n      orientation: \"horizontal\",\n    },\n  }\n)\n\nfunction ButtonGroup({\n  className,\n  orientation,\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof buttonGroupVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"button-group\"\n      data-orientation={orientation}\n      className={cn(buttonGroupVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupText({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  asChild?: boolean\n}) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      className={cn(\n        \"bg-muted shadow-xs flex items-center gap-2 rounded-md border px-4 text-sm font-medium [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction ButtonGroupSeparator({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"button-group-separator\"\n      orientation={orientation}\n      className={cn(\n        \"bg-input relative !m-0 self-stretch data-[orientation=vertical]:h-auto\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  ButtonGroup,\n  ButtonGroupSeparator,\n  ButtonGroupText,\n  buttonGroupVariants,\n}\n","path":null,"size_bytes":2209,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4280,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"import * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3007,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5124,"size_tokens":null},"client/src/components/ui/field.tsx":{"content":"\"use client\"\n\nimport { useMemo } from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\n\nfunction FieldSet({ className, ...props }: React.ComponentProps<\"fieldset\">) {\n  return (\n    <fieldset\n      data-slot=\"field-set\"\n      className={cn(\n        \"flex flex-col gap-6\",\n        \"has-[>[data-slot=checkbox-group]]:gap-3 has-[>[data-slot=radio-group]]:gap-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLegend({\n  className,\n  variant = \"legend\",\n  ...props\n}: React.ComponentProps<\"legend\"> & { variant?: \"legend\" | \"label\" }) {\n  return (\n    <legend\n      data-slot=\"field-legend\"\n      data-variant={variant}\n      className={cn(\n        \"mb-3 font-medium\",\n        \"data-[variant=legend]:text-base\",\n        \"data-[variant=label]:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-group\"\n      className={cn(\n        \"group/field-group @container/field-group flex w-full flex-col gap-7 data-[slot=checkbox-group]:gap-3 [&>[data-slot=field-group]]:gap-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nconst fieldVariants = cva(\n  \"group/field data-[invalid=true]:text-destructive flex w-full gap-3\",\n  {\n    variants: {\n      orientation: {\n        vertical: [\"flex-col [&>*]:w-full [&>.sr-only]:w-auto\"],\n        horizontal: [\n          \"flex-row items-center\",\n          \"[&>[data-slot=field-label]]:flex-auto\",\n          \"has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px has-[>[data-slot=field-content]]:items-start\",\n        ],\n        responsive: [\n          \"@md/field-group:flex-row @md/field-group:items-center @md/field-group:[&>*]:w-auto flex-col [&>*]:w-full [&>.sr-only]:w-auto\",\n          \"@md/field-group:[&>[data-slot=field-label]]:flex-auto\",\n          \"@md/field-group:has-[>[data-slot=field-content]]:items-start @md/field-group:has-[>[data-slot=field-content]]:[&>[role=checkbox],[role=radio]]:mt-px\",\n        ],\n      },\n    },\n    defaultVariants: {\n      orientation: \"vertical\",\n    },\n  }\n)\n\nfunction Field({\n  className,\n  orientation = \"vertical\",\n  ...props\n}: React.ComponentProps<\"div\"> & VariantProps<typeof fieldVariants>) {\n  return (\n    <div\n      role=\"group\"\n      data-slot=\"field\"\n      data-orientation={orientation}\n      className={cn(fieldVariants({ orientation }), className)}\n      {...props}\n    />\n  )\n}\n\nfunction FieldContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-content\"\n      className={cn(\n        \"group/field-content flex flex-1 flex-col gap-1.5 leading-snug\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof Label>) {\n  return (\n    <Label\n      data-slot=\"field-label\"\n      className={cn(\n        \"group/field-label peer/field-label flex w-fit gap-2 leading-snug group-data-[disabled=true]/field:opacity-50\",\n        \"has-[>[data-slot=field]]:w-full has-[>[data-slot=field]]:flex-col has-[>[data-slot=field]]:rounded-md has-[>[data-slot=field]]:border [&>[data-slot=field]]:p-4\",\n        \"has-data-[state=checked]:bg-primary/5 has-data-[state=checked]:border-primary dark:has-data-[state=checked]:bg-primary/10\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"field-label\"\n      className={cn(\n        \"flex w-fit items-center gap-2 text-sm font-medium leading-snug group-data-[disabled=true]/field:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldDescription({ className, ...props }: React.ComponentProps<\"p\">) {\n  return (\n    <p\n      data-slot=\"field-description\"\n      className={cn(\n        \"text-muted-foreground text-sm font-normal leading-normal group-has-[[data-orientation=horizontal]]/field:text-balance\",\n        \"nth-last-2:-mt-1 last:mt-0 [[data-variant=legend]+&]:-mt-1.5\",\n        \"[&>a:hover]:text-primary [&>a]:underline [&>a]:underline-offset-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction FieldSeparator({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  children?: React.ReactNode\n}) {\n  return (\n    <div\n      data-slot=\"field-separator\"\n      data-content={!!children}\n      className={cn(\n        \"relative -my-2 h-5 text-sm group-data-[variant=outline]/field-group:-mb-2\",\n        className\n      )}\n      {...props}\n    >\n      <Separator className=\"absolute inset-0 top-1/2\" />\n      {children && (\n        <span\n          className=\"bg-background text-muted-foreground relative mx-auto block w-fit px-2\"\n          data-slot=\"field-separator-content\"\n        >\n          {children}\n        </span>\n      )}\n    </div>\n  )\n}\n\nfunction FieldError({\n  className,\n  children,\n  errors,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  errors?: Array<{ message?: string } | undefined>\n}) {\n  const content = useMemo(() => {\n    if (children) {\n      return children\n    }\n\n    if (!errors) {\n      return null\n    }\n\n    if (errors?.length === 1 && errors[0]?.message) {\n      return errors[0].message\n    }\n\n    return (\n      <ul className=\"ml-4 flex list-disc flex-col gap-1\">\n        {errors.map(\n          (error, index) =>\n            error?.message && <li key={index}>{error.message}</li>\n        )}\n      </ul>\n    )\n  }, [children, errors])\n\n  if (!content) {\n    return null\n  }\n\n  return (\n    <div\n      role=\"alert\"\n      data-slot=\"field-error\"\n      className={cn(\"text-destructive text-sm font-normal\", className)}\n      {...props}\n    >\n      {content}\n    </div>\n  )\n}\n\nexport {\n  Field,\n  FieldLabel,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLegend,\n  FieldSeparator,\n  FieldSet,\n  FieldContent,\n  FieldTitle,\n}\n","path":null,"size_bytes":6044,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"@neondatabase/serverless\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1439,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"replit.md":{"content":"# PDF Master - Simple, Powerful PDF Tools\n\n## Overview\n\nPDF Master is a fully functional full-stack web application that provides PDF manipulation tools including merge, split, compress, protect, and convert-to-Word operations. The application is built with a React frontend and Express backend, currently operating in mock mode (returns processed versions of PDFs) and ready to connect to external PDF processing APIs (ILovePDF, PDF.co, CloudConvert). The architecture emphasizes simplicity, user experience, and secure API key management through a backend proxy pattern.\n\n### Current Status\n✅ **FULLY FUNCTIONAL** - All PDF operations are working end-to-end:\n- Merge multiple PDFs ✓\n- Split PDFs by page or custom ranges ✓\n- Compress PDFs (mock mode) ✓\n- Protect PDFs with password (mock mode) ✓\n- Convert PDF to Word (mock mode) ✓\n- Bilingual UI (English/Arabic with RTL support) ✓\n- Download History tracking ✓\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React with TypeScript, using Vite as the build tool and development server.\n\n**UI Components**: Built with Radix UI primitives and custom components following the shadcn/ui design system. The application uses a \"New York\" style variant with Tailwind CSS for styling.\n\n**Routing**: Client-side routing implemented with Wouter, a lightweight React router. The application supports multiple tool pages (Home, Merge, Split, Protect, Compress, PDF-to-Word, Download History, Pricing).\n\n**State Management**: TanStack Query (React Query) for server state management and API data fetching. Local component state managed with React hooks.\n\n**Internationalization**: Custom i18n context supporting English and Arabic with RTL (right-to-left) layout switching. Translation keys are defined in a centralized dictionary structure.\n\n**File Handling**: React Dropzone for drag-and-drop file uploads with PDF validation.\n\n**Design System**: Apple-inspired clean aesthetic with neutral color palette, rounded corners, subtle shadows, and smooth transitions. The theme uses CSS custom properties for consistent theming across light/dark modes.\n\n### Backend Architecture\n\n**Framework**: Express.js with TypeScript running on Node.js.\n\n**API Structure**: RESTful API endpoints under `/api` prefix:\n- `/api/health` - Health check and provider status\n- `/api/pdf/merge` - Merge multiple PDFs (working)\n- `/api/pdf/split` - Split PDF into pages or ranges (fully functional with pdf-lib)\n- `/api/pdf/compress` - Compress PDF file size\n- `/api/pdf/protect` - Add password protection\n- `/api/pdf/to-word` - Convert PDF to Word document\n\n**File Upload Handling**: Multer middleware for multipart form data processing with:\n- 50MB file size limit\n- PDF-only file type filtering\n- Temporary uploads directory storage\n- Automatic cleanup after processing\n\n**PDF Provider Pattern**: Abstraction layer (`PDFProvider` class) that supports multiple external PDF APIs:\n- **Mock Mode** (default, active): Uses pdf-lib for local processing\n  - Merge: Returns combined PDF of all uploaded files\n  - Split: Extracts requested pages (supports ranges like \"1-10, 15, 20-25\")\n  - Compress/Protect/Convert: Returns original file (placeholder for real API)\n- **ILovePDF**: Ready to integrate (requires API key)\n- **PDF.co**: Ready to integrate (requires API key)\n- **CloudConvert**: Ready to integrate (requires API key)\n\nProvider acts as a secure proxy, keeping API keys on the server and handling CORS restrictions. Provider selection via `PDF_PROVIDER` environment variable.\n\n**Logging**: Custom logging middleware that tracks request duration, method, path, and status codes with formatted timestamps.\n\n**Static File Serving**: Serves built frontend from `dist/public` directory in production with fallback to `index.html` for client-side routing.\n\n**Development Mode**: Vite dev server integration with HMR (Hot Module Replacement) for rapid development.\n\n### Database Schema\n\n**ORM**: Drizzle ORM with PostgreSQL dialect configuration.\n\n**Schema Design**: Currently minimal with a `users` table:\n- `id`: UUID primary key (auto-generated)\n- `username`: Unique text field\n- `password`: Text field for hashed passwords\n\n**Schema Location**: Defined in `shared/schema.ts` for code sharing between frontend and backend.\n\n**Migrations**: Drizzle Kit configured to output migrations to `./migrations` directory.\n\n**Storage Abstraction**: `IStorage` interface with `MemStorage` in-memory implementation for development. Provides methods for user CRUD operations.\n\n**Note**: The application uses Drizzle and expects PostgreSQL via `DATABASE_URL` environment variable, though the current implementation includes an in-memory storage option.\n\n### Build and Deployment\n\n**Build Process**: Custom build script (`script/build.ts`) using:\n- Vite for frontend bundling (outputs to `dist/public`)\n- esbuild for server bundling (outputs to `dist/index.cjs`)\n- Allowlist-based dependency bundling to reduce cold start times by minimizing syscalls\n\n**Production Server**: Node.js serving the bundled Express application with static frontend assets.\n\n**Development Workflow**: Separate dev commands for client (`vite dev`) and server (`tsx server/index.ts`).\n\n## External Dependencies\n\n### Core Framework Dependencies\n- **React 18+**: Frontend UI framework\n- **Express**: Backend web server\n- **TypeScript**: Type safety across frontend and backend\n- **Vite**: Frontend build tool and dev server\n\n### UI Component Libraries\n- **Radix UI**: Unstyled, accessible component primitives (@radix-ui/react-*)\n- **Tailwind CSS**: Utility-first CSS framework with custom theme\n- **Lucide React**: Icon library\n- **class-variance-authority**: Type-safe component variants\n- **tailwind-merge**: Utility for merging Tailwind classes\n\n### State Management and Data Fetching\n- **TanStack Query**: Server state management\n- **React Hook Form**: Form state and validation\n- **Zod**: Schema validation\n- **Drizzle Zod**: Drizzle ORM schema to Zod validation\n\n### File Handling\n- **Multer**: Multipart form data handling for file uploads\n- **React Dropzone**: Drag-and-drop file upload component\n- **file-saver**: Client-side file downloads\n\n### Database\n- **Drizzle ORM**: Type-safe SQL ORM\n- **@neondatabase/serverless**: PostgreSQL client for Neon (serverless Postgres)\n- **DATABASE_URL**: Required environment variable for database connection\n\n### External PDF Processing APIs\n- **ILovePDF** (Recommended): PDF manipulation API\n  - Environment variables: `PDF_PROVIDER=ilovepdf`, `PDF_API_KEY`\n  - Documentation: https://developer.ilovepdf.com/\n- **PDF.co**: Alternative PDF API\n  - Environment variables: `PDF_PROVIDER=pdfco`, `PDF_API_KEY`\n- **CloudConvert**: Alternative conversion API\n  - Environment variables: `PDF_PROVIDER=cloudconvert`, `PDF_API_KEY`\n- **Mock Mode** (Default): No API required, returns original files\n\n### HTTP Client\n- **Axios**: Promise-based HTTP client for external API requests\n- **Form-data**: Multipart form data for API requests\n\n### Development Tools\n- **tsx**: TypeScript execution for development\n- **Replit Plugins**: Development experience plugins (vite-plugin-runtime-error-modal, vite-plugin-cartographer, vite-plugin-dev-banner)\n- **Custom Vite Plugin**: Meta images plugin for OpenGraph image URL updates\n\n### Router\n- **Wouter**: Lightweight client-side routing (~1.2KB)\n\n### Utilities\n- **nanoid**: Unique ID generation\n- **date-fns**: Date manipulation utilities\n- **clsx**: Conditional className utility\n\n### Environment Configuration\nRequired environment variables:\n- `DATABASE_URL`: PostgreSQL connection string\n- `PDF_PROVIDER`: PDF service provider (mock|ilovepdf|pdfco|cloudconvert)\n- `PDF_API_KEY`: API key for selected PDF provider (not required for mock mode)\n- `NODE_ENV`: Environment mode (development|production)","path":null,"size_bytes":7875,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2859,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/pages/UnlockPDF.tsx":{"content":"import { useState } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Unlock } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\n\nexport default function UnlockPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [password, setPassword] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n    }\n  };\n\n  const handleUnlock = async () => {\n    if (!file) return;\n    \n    if (!password) {\n      toast({\n        title: language === 'ar' ? 'كلمة المرور مطلوبة' : 'Password required',\n        description: language === 'ar' \n          ? 'يرجى إدخال كلمة المرور الحالية للملف' \n          : 'Please enter the current password for this PDF.',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('password', password);\n\n      const response = await fetch('/api/pdf/unlock', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to unlock PDF');\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `unlocked-${file.name}`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast({\n        title: language === 'ar' ? 'تم بنجاح!' : 'Success!',\n        description: language === 'ar' \n          ? 'تم فك حماية ملف PDF بنجاح' \n          : 'Your PDF has been unlocked successfully.',\n      });\n      \n      // Reset form\n      setFile(null);\n      setPassword('');\n    } catch (error: any) {\n      console.error('Error unlocking PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في فك حماية الملف. تأكد من صحة كلمة المرور.' \n          : 'Failed to unlock PDF. Please check if the password is correct.'),\n        variant: 'destructive'\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.unlock.title')}\n      description={t('tool.unlock.desc')}\n      isProcessing={isProcessing}\n      actionButton={\n        file && (\n          <Button \n            size=\"lg\" \n            onClick={handleUnlock} \n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n            data-testid=\"button-unlock-pdf\"\n          >\n            {language === 'ar' ? 'فك الحماية' : 'Unlock PDF'}\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' \n              ? 'اختر ملف PDF محمي بكلمة مرور' \n              : 'Select a password-protected PDF file'}\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          {/* File Info */}\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-gray-600\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={() => { setFile(null); setPassword(''); }}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          {/* Password Form */}\n          <div className=\"bg-card p-6 rounded-2xl border border-border/50 space-y-4 shadow-sm\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Unlock className=\"w-5 h-5 text-primary\" />\n              <h3 className=\"text-lg font-semibold\">\n                {language === 'ar' ? 'أدخل كلمة المرور' : 'Enter Password'}\n              </h3>\n            </div>\n            \n            <p className=\"text-sm text-muted-foreground\">\n              {language === 'ar' \n                ? 'أدخل كلمة المرور الحالية لفك حماية ملف PDF هذا'\n                : 'Enter the current password to unlock this PDF file'}\n            </p>\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">\n                {language === 'ar' ? 'كلمة المرور الحالية' : 'Current Password'}\n              </Label>\n              <Input \n                id=\"password\" \n                type=\"password\" \n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                placeholder=\"••••••••\"\n                className=\"bg-background\"\n                data-testid=\"input-password\"\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') {\n                    handleUnlock();\n                  }\n                }}\n              />\n            </div>\n\n            <p className=\"text-xs text-muted-foreground mt-4\">\n              {language === 'ar' \n                ? 'سيتم إنشاء نسخة جديدة من الملف بدون حماية بكلمة مرور'\n                : 'A new copy of the file will be created without password protection'}\n            </p>\n          </div>\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":6434,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":266,"size_tokens":null},"client/src/components/PdfThumbnailGrid.tsx":{"content":"import { useState, useEffect, useRef, useCallback, memo } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport { Loader2, Trash2, Check, RotateCw } from 'lucide-react';\nimport { useLanguage } from '@/lib/i18n';\nimport { cn } from '@/lib/utils';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ntype GridMode = 'remove' | 'extract' | 'rotate';\n\ninterface PdfThumbnailGridProps {\n  file: File;\n  selectedPages: Set<number>;\n  onTogglePage?: (pageNum: number) => void;\n  onTotalPagesChange?: (total: number) => void;\n  mode?: GridMode;\n  rotationAngle?: 0 | 90 | 180 | 270;\n  pageRotations?: Map<number, 0 | 90 | 180 | 270>;\n  cumulativeRotations?: Map<number, number>;\n  disableSelection?: boolean;\n}\n\ninterface PageThumbnail {\n  pageNum: number;\n  imageUrl: string | null;\n  isLoading: boolean;\n}\n\nconst PageThumbnailItem = memo(({ \n  pageNum, \n  imageUrl, \n  isLoading, \n  isSelected, \n  onToggle,\n  direction,\n  mode = 'remove',\n  rotationAngle = 0,\n  pageRotation = 0,\n  cumulativeRotation = 0,\n  disabled = false\n}: { \n  pageNum: number; \n  imageUrl: string | null; \n  isLoading: boolean;\n  isSelected: boolean;\n  onToggle: () => void;\n  direction: string;\n  mode?: GridMode;\n  rotationAngle?: 0 | 90 | 180 | 270;\n  pageRotation?: 0 | 90 | 180 | 270;\n  cumulativeRotation?: number;\n  disabled?: boolean;\n}) => {\n  const { language } = useLanguage();\n  const isExtract = mode === 'extract';\n  const isRotate = mode === 'rotate';\n  const Icon = isRotate ? RotateCw : isExtract ? Check : Trash2;\n  \n  const getRotationStyle = () => {\n    // In \"all pages\" mode (disabled), show rotation for all pages\n    if (isRotate && disabled && cumulativeRotation !== 0) {\n      return { \n        transform: `rotate(${cumulativeRotation}deg)`,\n        transition: 'transform 0.3s ease-in-out'\n      };\n    }\n    if (!isRotate || !isSelected) return {};\n    return { \n      transform: `rotate(${cumulativeRotation}deg)`,\n      transition: 'transform 0.3s ease-in-out'\n    };\n  };\n  \n  const getSelectText = () => {\n    if (isSelected) {\n      return language === 'ar' ? 'إلغاء التحديد' : 'Deselect';\n    }\n    if (isRotate) {\n      return language === 'ar' ? 'تحديد للتدوير' : 'Select to Rotate';\n    }\n    if (isExtract) {\n      return language === 'ar' ? 'تحديد للاستخراج' : 'Select to Extract';\n    }\n    return language === 'ar' ? 'تحديد للحذف' : 'Select to Remove';\n  };\n  \n  return (\n    <div\n      className={cn(\n        \"relative group rounded-lg overflow-hidden border-2 transition-all duration-200\",\n        disabled ? \"cursor-default\" : \"cursor-pointer\",\n        isSelected \n          ? isRotate\n            ? \"border-teal-500 ring-2 ring-teal-500/30 scale-[1.02]\"\n            : isExtract \n              ? \"border-primary ring-2 ring-primary/30 scale-[1.02]\" \n              : \"border-red-500 ring-2 ring-red-500/30 scale-95\"\n          : disabled\n            ? \"border-border/30\"\n            : \"border-border/50 hover:border-primary/50 hover:shadow-md\"\n      )}\n      onClick={disabled ? undefined : onToggle}\n      data-testid={`thumbnail-page-${pageNum}`}\n    >\n      <div className=\"aspect-[3/4] bg-secondary/30 flex items-center justify-center overflow-hidden\">\n        {isLoading ? (\n          <Loader2 className=\"w-6 h-6 animate-spin text-muted-foreground\" />\n        ) : imageUrl ? (\n          <img \n            src={imageUrl} \n            alt={`Page ${pageNum}`}\n            className={cn(\n              \"w-full h-full object-contain\",\n              isSelected && !isExtract && !isRotate && \"opacity-50\"\n            )}\n            style={getRotationStyle()}\n          />\n        ) : (\n          <div className=\"text-muted-foreground text-sm\">\n            {language === 'ar' ? `صفحة ${pageNum}` : `Page ${pageNum}`}\n          </div>\n        )}\n      </div>\n      \n      <div className={cn(\n        \"absolute bottom-0 inset-x-0 py-1.5 px-2 text-center text-sm font-medium transition-colors\",\n        isSelected \n          ? isRotate \n            ? \"bg-teal-500 text-white\"\n            : isExtract ? \"bg-primary text-white\" : \"bg-red-500 text-white\"\n          : \"bg-background/90 text-foreground\"\n      )}>\n        {pageNum}\n      </div>\n      \n      {isSelected && (\n        <div className={cn(\n          \"absolute top-2 end-2 text-white rounded-full p-1.5 shadow-lg\",\n          isRotate ? \"bg-teal-500\" : isExtract ? \"bg-primary\" : \"bg-red-500\"\n        )}>\n          <Icon className=\"w-4 h-4\" />\n        </div>\n      )}\n      \n      {!disabled && (\n        <div className={cn(\n          \"absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity\",\n          isSelected && \"opacity-100\"\n        )}>\n          <span className=\"bg-white/90 text-foreground px-3 py-1.5 rounded-full text-sm font-medium shadow-lg\">\n            {getSelectText()}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n});\n\nPageThumbnailItem.displayName = 'PageThumbnailItem';\n\nexport function PdfThumbnailGrid({ \n  file, \n  selectedPages, \n  onTogglePage,\n  onTotalPagesChange,\n  mode = 'remove',\n  rotationAngle = 0,\n  pageRotations = new Map(),\n  cumulativeRotations = new Map(),\n  disableSelection = false\n}: PdfThumbnailGridProps) {\n  const { language, direction } = useLanguage();\n  const [thumbnails, setThumbnails] = useState<PageThumbnail[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [totalPages, setTotalPages] = useState(0);\n  const pdfDocRef = useRef<pdfjsLib.PDFDocumentProxy | null>(null);\n  const imageUrlsRef = useRef<string[]>([]);\n\n  const renderPage = useCallback(async (doc: pdfjsLib.PDFDocumentProxy, pageNum: number): Promise<string> => {\n    const page = await doc.getPage(pageNum);\n    const scale = 0.4;\n    const viewport = page.getViewport({ scale });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    if (!context) throw new Error('Canvas context not available');\n    \n    canvas.width = viewport.width;\n    canvas.height = viewport.height;\n    \n    await page.render({\n      canvasContext: context,\n      viewport: viewport,\n      canvas: canvas\n    } as any).promise;\n    \n    return new Promise((resolve) => {\n      canvas.toBlob((blob) => {\n        if (blob) {\n          const url = URL.createObjectURL(blob);\n          imageUrlsRef.current.push(url);\n          resolve(url);\n        } else {\n          resolve('');\n        }\n      }, 'image/jpeg', 0.7);\n    });\n  }, []);\n\n  useEffect(() => {\n    let isMounted = true;\n    \n    const loadPdf = async () => {\n      setIsLoading(true);\n      setError(null);\n      \n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const doc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        \n        if (!isMounted) {\n          doc.destroy();\n          return;\n        }\n        \n        pdfDocRef.current = doc;\n        const numPages = doc.numPages;\n        setTotalPages(numPages);\n        onTotalPagesChange?.(numPages);\n        \n        const initialThumbnails: PageThumbnail[] = Array.from({ length: numPages }, (_, i) => ({\n          pageNum: i + 1,\n          imageUrl: null,\n          isLoading: true\n        }));\n        setThumbnails(initialThumbnails);\n        setIsLoading(false);\n        \n        const BATCH_SIZE = 4;\n        for (let i = 0; i < numPages; i += BATCH_SIZE) {\n          if (!isMounted) break;\n          \n          const batch = [];\n          for (let j = i; j < Math.min(i + BATCH_SIZE, numPages); j++) {\n            batch.push(renderPage(doc, j + 1));\n          }\n          \n          const results = await Promise.all(batch);\n          \n          if (!isMounted) break;\n          \n          setThumbnails(prev => {\n            const updated = [...prev];\n            results.forEach((url, idx) => {\n              const pageIdx = i + idx;\n              if (pageIdx < updated.length) {\n                updated[pageIdx] = {\n                  ...updated[pageIdx],\n                  imageUrl: url,\n                  isLoading: false\n                };\n              }\n            });\n            return updated;\n          });\n        }\n      } catch (err: any) {\n        if (isMounted) {\n          console.error('Error loading PDF:', err);\n          setError(err.message || 'Failed to load PDF');\n          setIsLoading(false);\n        }\n      }\n    };\n    \n    loadPdf();\n    \n    return () => {\n      isMounted = false;\n      imageUrlsRef.current.forEach(url => URL.revokeObjectURL(url));\n      imageUrlsRef.current = [];\n      if (pdfDocRef.current) {\n        pdfDocRef.current.destroy();\n        pdfDocRef.current = null;\n      }\n    };\n  }, [file, renderPage, onTotalPagesChange]);\n\n  if (isLoading && thumbnails.length === 0) {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-12 gap-4\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n        <p className=\"text-muted-foreground\">\n          {language === 'ar' ? 'جاري تحميل صفحات PDF...' : 'Loading PDF pages...'}\n        </p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-12 gap-4 text-destructive\">\n        <p>{language === 'ar' ? 'خطأ في تحميل الملف' : 'Error loading file'}</p>\n        <p className=\"text-sm text-muted-foreground\">{error}</p>\n      </div>\n    );\n  }\n\n  const isExtract = mode === 'extract';\n  const isRotate = mode === 'rotate';\n\n  const getInstructionText = () => {\n    // When selection is disabled (e.g., \"All Pages\" mode), show preview text\n    if (disableSelection) {\n      if (language === 'ar') {\n        return `${totalPages} صفحة - معاينة`;\n      }\n      return `${totalPages} pages - Preview`;\n    }\n    \n    if (language === 'ar') {\n      if (isRotate) return `${totalPages} صفحة - انقر على الصفحات لتحديدها للتدوير`;\n      if (isExtract) return `${totalPages} صفحة - انقر على الصفحات لتحديدها للاستخراج`;\n      return `${totalPages} صفحة - انقر على الصفحات لتحديدها للحذف`;\n    }\n    if (isRotate) return `${totalPages} pages - Click on pages to select for rotation`;\n    if (isExtract) return `${totalPages} pages - Click on pages to select for extraction`;\n    return `${totalPages} pages - Click on pages to select for removal`;\n  };\n\n  const getSelectedText = () => {\n    const count = selectedPages.size;\n    const plural = count > 1 ? 's' : '';\n    if (language === 'ar') {\n      if (isRotate) return `تم تحديد ${count} صفحة للتدوير`;\n      if (isExtract) return `تم تحديد ${count} صفحة للاستخراج`;\n      return `تم تحديد ${count} صفحة للحذف`;\n    }\n    if (isRotate) return `${count} page${plural} selected for rotation`;\n    if (isExtract) return `${count} page${plural} selected for extraction`;\n    return `${count} page${plural} selected for removal`;\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between text-sm flex-wrap gap-2\">\n        <span className=\"text-muted-foreground\">\n          {getInstructionText()}\n        </span>\n        {selectedPages.size > 0 && (\n          <span className={cn(\n            \"font-medium\", \n            isRotate ? \"text-teal-500\" : isExtract ? \"text-primary\" : \"text-red-500\"\n          )}>\n            {getSelectedText()}\n          </span>\n        )}\n      </div>\n      \n      <div \n        className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3\"\n        dir={direction}\n      >\n        {thumbnails.map((thumb) => (\n          <PageThumbnailItem\n            key={thumb.pageNum}\n            pageNum={thumb.pageNum}\n            imageUrl={thumb.imageUrl}\n            isLoading={thumb.isLoading}\n            isSelected={selectedPages.has(thumb.pageNum)}\n            onToggle={() => onTogglePage?.(thumb.pageNum)}\n            direction={direction}\n            mode={mode}\n            rotationAngle={rotationAngle}\n            pageRotation={pageRotations.get(thumb.pageNum) || 0}\n            cumulativeRotation={cumulativeRotations.get(thumb.pageNum) || 0}\n            disabled={disableSelection}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":12420,"size_tokens":null},"client/src/lib/i18n.tsx":{"content":"import React, { createContext, useContext, useState, useEffect } from 'react';\n\ntype Language = 'en' | 'ar';\ntype Direction = 'ltr' | 'rtl';\n\ninterface LanguageContextType {\n  language: Language;\n  direction: Direction;\n  setLanguage: (lang: Language) => void;\n  t: (key: string) => string;\n}\n\nconst translations: Record<string, Record<Language, string>> = {\n  // Navbar\n  'nav.brand': { en: 'PDF Master', ar: 'ماستر بي دي اف' },\n  'nav.allTools': { en: 'All Tools', ar: 'كل الأدوات' },\n  'nav.pricing': { en: 'Pricing', ar: 'الأسعار' },\n  'nav.desktop': { en: 'Desktop', ar: 'تطبيق سطح المكتب' },\n  'nav.login': { en: 'Log in', ar: 'تسجيل الدخول' },\n  'nav.signup': { en: 'Get Started', ar: 'ابدأ الآن' },\n\n  // Hero\n  'hero.title': { en: 'Every tool you need to work with PDFs.', ar: 'كل الأدوات التي تحتاجها للعمل مع ملفات PDF.' },\n  'hero.subtitle': { en: 'All the tools you need to use PDFs, at your fingertips. All are 100% FREE and easy to use!', ar: 'جميع أدوات PDF التي تحتاجها في متناول يدك. مجانية 100٪ وسهلة الاستخدام!' },\n  'hero.cta.primary': { en: 'Get Started for Free', ar: 'ابدأ مجانًا' },\n  'hero.cta.secondary': { en: 'Explore All Tools', ar: 'استكشف جميع الأدوات' },\n\n  // Tools\n  'tool.merge.title': { en: 'Merge PDF', ar: 'دمج PDF' },\n  'tool.merge.desc': { en: 'Combine multiple PDFs into one unified document in seconds.', ar: 'دمج ملفات PDF متعددة في مستند واحد موحد في ثوانٍ.' },\n  'tool.merge.fastMode': { en: 'Fast Mode', ar: 'الوضع السريع' },\n  'tool.merge.fastModeDesc': { en: 'Without compression (faster)', ar: 'بدون ضغط (أسرع)' },\n  'tool.merge.compressMode': { en: 'Compressed', ar: 'مضغوط' },\n  'tool.merge.compressModeDesc': { en: 'Smaller file size (slower)', ar: 'حجم ملف أصغر (أبطأ)' },\n  \n  'tool.split.title': { en: 'Split PDF', ar: 'تقسيم PDF' },\n  'tool.split.desc': { en: 'Separate PDF pages or extract specific pages into new documents.', ar: 'فصل صفحات PDF أو استخراج صفحات محددة إلى مستندات جديدة.' },\n  \n  'tool.compress.title': { en: 'Compress PDF', ar: 'ضغط PDF' },\n  'tool.compress.desc': { en: 'Reduce file size while maintaining the best possible quality.', ar: 'تقليل حجم الملف مع الحفاظ على أفضل جودة ممكنة.' },\n  \n  'tool.pdfToWord.title': { en: 'PDF to Word', ar: 'PDF إلى Word' },\n  'tool.pdfToWord.desc': { en: 'Convert your PDF files to editable Word documents easily.', ar: 'حول ملفات PDF الخاصة بك إلى مستندات Word قابلة للتعديل بسهولة.' },\n  \n  'tool.wordToPdf.title': { en: 'Word to PDF', ar: 'Word إلى PDF' },\n  'tool.wordToPdf.desc': { en: 'Make DOC and DOCX files into easy-to-read PDF documents.', ar: 'حول ملفات DOC و DOCX إلى مستندات PDF سهلة القراءة.' },\n  \n  'tool.edit.title': { en: 'Edit PDF', ar: 'تعديل PDF' },\n  'tool.edit.desc': { en: 'Add text, shapes, comments and highlights to your PDF file.', ar: 'أضف نصوصًا وأشكالًا وتعليقات وعلامات إلى ملف PDF الخاص بك.' },\n  \n  'tool.protect.title': { en: 'Protect PDF', ar: 'حماية PDF' },\n  'tool.protect.desc': { en: 'Encrypt your PDF file with a password.', ar: 'شفر ملف PDF الخاص بك بكلمة مرور.' },\n  \n  'tool.unlock.title': { en: 'Unlock PDF', ar: 'فك حماية PDF' },\n  'tool.unlock.desc': { en: 'Remove password security from PDF files.', ar: 'أزل حماية كلمة المرور من ملفات PDF.' },\n  \n  'tool.pdfToJpg.title': { en: 'PDF to JPG', ar: 'PDF إلى JPG' },\n  'tool.pdfToJpg.desc': { en: 'Extract images from your PDF or save each page as a separate image.', ar: 'استخرج الصور من ملف PDF أو احفظ كل صفحة كصورة منفصلة.' },\n  \n  'tool.sign.title': { en: 'Sign PDF', ar: 'توقيع PDF' },\n  'tool.sign.desc': { en: 'Sign yourself or request electronic signatures from others.', ar: 'وقع بنفسك أو اطلب توقيعات إلكترونية من الآخرين.' },\n  \n  'tool.removePages.title': { en: 'Remove Pages', ar: 'حذف صفحات' },\n  'tool.removePages.desc': { en: 'Delete specific pages from your PDF document.', ar: 'احذف صفحات محددة من مستند PDF الخاص بك.' },\n  \n  'tool.rotate.title': { en: 'Rotate PDF', ar: 'تدوير PDF' },\n  'tool.rotate.desc': { en: 'Rotate pages in your PDF document to any angle.', ar: 'دوّر صفحات مستند PDF الخاص بك إلى أي زاوية.' },\n  \n  'tool.organize.title': { en: 'Organize PDF', ar: 'ترتيب PDF' },\n  'tool.organize.desc': { en: 'Rearrange pages in your PDF by drag and drop.', ar: 'أعد ترتيب صفحات PDF الخاص بك بالسحب والإفلات.' },\n  \n  'tool.pdfToImage.title': { en: 'PDF to Image', ar: 'PDF إلى صورة' },\n  'tool.pdfToImage.desc': { en: 'Convert PDF pages to high-quality JPG or PNG images.', ar: 'حوّل صفحات PDF إلى صور JPG أو PNG عالية الجودة.' },\n  \n  'tool.watermark.title': { en: 'Watermark PDF', ar: 'علامة مائية PDF' },\n  'tool.watermark.desc': { en: 'Add text or image watermarks to your PDF documents.', ar: 'أضف علامات مائية نصية أو صورية إلى مستندات PDF الخاصة بك.' },\n\n  'tool.htmlToPdf.title': { en: 'HTML to PDF', ar: 'HTML إلى PDF' },\n  'tool.htmlToPdf.desc': { en: 'Convert HTML content or web pages to PDF documents.', ar: 'حوّل محتوى HTML أو صفحات الويب إلى مستندات PDF.' },\n  'tool.htmlToPdf.inputType': { en: 'Input Type', ar: 'نوع الإدخال' },\n  'tool.htmlToPdf.htmlCode': { en: 'HTML Code', ar: 'كود HTML' },\n  'tool.htmlToPdf.webUrl': { en: 'Web URL', ar: 'رابط الويب' },\n  'tool.htmlToPdf.enterHtml': { en: 'Enter your HTML code here...', ar: 'أدخل كود HTML هنا...' },\n  'tool.htmlToPdf.enterUrl': { en: 'Enter website URL (e.g., https://example.com)', ar: 'أدخل رابط الموقع (مثال: https://example.com)' },\n  'tool.htmlToPdf.preview': { en: 'Preview', ar: 'معاينة' },\n  'tool.htmlToPdf.convert': { en: 'Convert to PDF', ar: 'تحويل إلى PDF' },\n  'tool.htmlToPdf.converting': { en: 'Converting...', ar: 'جاري التحويل...' },\n  'tool.htmlToPdf.download': { en: 'Download PDF', ar: 'تحميل PDF' },\n  'tool.htmlToPdf.pageSize': { en: 'Page Size', ar: 'حجم الصفحة' },\n  'tool.htmlToPdf.orientation': { en: 'Orientation', ar: 'الاتجاه' },\n  'tool.htmlToPdf.portrait': { en: 'Portrait', ar: 'طولي' },\n  'tool.htmlToPdf.landscape': { en: 'Landscape', ar: 'عرضي' },\n  'tool.htmlToPdf.margins': { en: 'Margins', ar: 'الهوامش' },\n  'tool.htmlToPdf.noMargins': { en: 'No Margins', ar: 'بدون هوامش' },\n  'tool.htmlToPdf.normalMargins': { en: 'Normal', ar: 'عادي' },\n  'tool.htmlToPdf.wideMargins': { en: 'Wide', ar: 'واسع' },\n  'tool.htmlToPdf.includeBackground': { en: 'Include Background', ar: 'تضمين الخلفية' },\n  'tool.htmlToPdf.error.emptyHtml': { en: 'Please enter HTML code', ar: 'الرجاء إدخال كود HTML' },\n  'tool.htmlToPdf.error.emptyUrl': { en: 'Please enter a valid URL', ar: 'الرجاء إدخال رابط صحيح' },\n  'tool.htmlToPdf.error.invalidUrl': { en: 'Please enter a valid URL starting with http:// or https://', ar: 'الرجاء إدخال رابط صحيح يبدأ بـ http:// أو https://' },\n  'tool.htmlToPdf.success': { en: 'PDF generated successfully!', ar: 'تم إنشاء PDF بنجاح!' },\n  'tool.htmlToPdf.error.conversion': { en: 'Failed to convert to PDF', ar: 'فشل التحويل إلى PDF' },\n\n  // Page Number PDF\n  'tool.pageNumber.title': { en: 'Add Page Numbers', ar: 'إضافة أرقام الصفحات' },\n  'tool.pageNumber.desc': { en: 'Add customizable page numbers to your PDF documents.', ar: 'أضف أرقام صفحات قابلة للتخصيص إلى مستندات PDF الخاصة بك.' },\n  'tool.pageNumber.uploadDesc': { en: 'Upload a PDF file to add page numbers', ar: 'ارفع ملف PDF لإضافة أرقام الصفحات' },\n  'tool.pageNumber.processing': { en: 'Adding page numbers...', ar: 'جاري إضافة أرقام الصفحات...' },\n  'tool.pageNumber.addButton': { en: 'Add Page Numbers', ar: 'إضافة أرقام الصفحات' },\n  'tool.pageNumber.download': { en: 'Download PDF', ar: 'تحميل PDF' },\n  'tool.pageNumber.success': { en: 'Page numbers added successfully!', ar: 'تم إضافة أرقام الصفحات بنجاح!' },\n  'tool.pageNumber.error': { en: 'Failed to add page numbers', ar: 'فشل إضافة أرقام الصفحات' },\n  'tool.pageNumber.preview': { en: 'Preview with Page Numbers', ar: 'معاينة مع أرقام الصفحات' },\n  'tool.pageNumber.position': { en: 'Position', ar: 'الموضع' },\n  'tool.pageNumber.positionTop': { en: 'Top', ar: 'أعلى' },\n  'tool.pageNumber.positionBottom': { en: 'Bottom', ar: 'أسفل' },\n  'tool.pageNumber.alignment': { en: 'Alignment', ar: 'المحاذاة' },\n  'tool.pageNumber.alignLeft': { en: 'Left', ar: 'يسار' },\n  'tool.pageNumber.alignCenter': { en: 'Center', ar: 'وسط' },\n  'tool.pageNumber.alignRight': { en: 'Right', ar: 'يمين' },\n  'tool.pageNumber.format': { en: 'Number Format', ar: 'تنسيق الرقم' },\n  'tool.pageNumber.formatNumber': { en: 'Number only (1, 2, 3...)', ar: 'رقم فقط (1، 2، 3...)' },\n  'tool.pageNumber.formatPage': { en: 'Page X (Page 1, Page 2...)', ar: 'صفحة X (صفحة 1، صفحة 2...)' },\n  'tool.pageNumber.formatOfTotal': { en: 'X of Y (1 of 10, 2 of 10...)', ar: 'X من Y (1 من 10، 2 من 10...)' },\n  'tool.pageNumber.formatDash': { en: '- X - (- 1 -, - 2 -...)', ar: '- X - (- 1 -، - 2 -...)' },\n  'tool.pageNumber.startingNumber': { en: 'Starting Number', ar: 'رقم البداية' },\n  'tool.pageNumber.fontSize': { en: 'Font Size', ar: 'حجم الخط' },\n  'tool.pageNumber.textColor': { en: 'Text Color', ar: 'لون النص' },\n  'tool.pageNumber.skipFirst': { en: 'Skip first page (cover)', ar: 'تخطي الصفحة الأولى (الغلاف)' },\n  'tool.pageNumber.margin': { en: 'Margin from edge', ar: 'الهامش من الحافة' },\n\n  // Repair PDF\n  'tool.repair.title': { en: 'Repair PDF', ar: 'إصلاح PDF' },\n  'tool.repair.desc': { en: 'Fix corrupted or damaged PDF files and recover content.', ar: 'إصلاح ملفات PDF التالفة واستعادة المحتوى.' },\n  'tool.repair.uploadDesc': { en: 'Upload a corrupted or damaged PDF file to repair', ar: 'ارفع ملف PDF تالف أو معطوب لإصلاحه' },\n  'tool.repair.repairing': { en: 'Repairing PDF...', ar: 'جاري إصلاح PDF...' },\n  'tool.repair.repairButton': { en: 'Repair PDF', ar: 'إصلاح PDF' },\n  'tool.repair.downloadRepaired': { en: 'Download Repaired PDF', ar: 'تحميل PDF المُصلح' },\n  'tool.repair.success': { en: 'PDF repaired successfully!', ar: 'تم إصلاح PDF بنجاح!' },\n  'tool.repair.error': { en: 'Failed to repair PDF', ar: 'فشل إصلاح PDF' },\n  'tool.repair.preview': { en: 'Repaired PDF Preview', ar: 'معاينة PDF المُصلح' },\n  'tool.repair.method': { en: 'Repair Method', ar: 'طريقة الإصلاح' },\n  'tool.repair.methodQuick': { en: 'Quick Repair (qpdf)', ar: 'إصلاح سريع (qpdf)' },\n  'tool.repair.methodQuickDesc': { en: 'Fixes structural issues, cross-references', ar: 'يصلح المشاكل الهيكلية والمراجع' },\n  'tool.repair.methodDeep': { en: 'Deep Repair (Ghostscript)', ar: 'إصلاح عميق (Ghostscript)' },\n  'tool.repair.methodDeepDesc': { en: 'Full re-render for severe damage', ar: 'إعادة عرض كاملة للتلف الشديد' },\n  'tool.repair.methodAuto': { en: 'Auto (Try both)', ar: 'تلقائي (جرب كليهما)' },\n  'tool.repair.methodAutoDesc': { en: 'Quick first, then deep if needed', ar: 'سريع أولاً، ثم عميق إذا لزم الأمر' },\n\n  // Features\n  'features.title': { en: 'Why choose PDF Master?', ar: 'لماذا تختار ماستر بي دي اف؟' },\n  'features.subtitle': { en: 'Simple, secure, and powerful tools for everyone.', ar: 'أدوات بسيطة وآمنة وقوية للجميع.' },\n  \n  'features.secure.title': { en: '100% Secure', ar: 'آمن 100٪' },\n  'features.secure.desc': { en: \"We don't store your files. All documents are automatically deleted from our servers after 2 hours.\", ar: 'نحن لا نخزن ملفاتك. يتم حذف جميع المستندات تلقائيًا من خوادمنا بعد ساعتين.' },\n  \n  'features.compat.title': { en: 'Universal Compatibility', ar: 'توافق عالمي' },\n  'features.compat.desc': { en: 'Works on all platforms. Whether you use Mac, Windows, Linux, iOS or Android.', ar: 'يعمل على جميع المنصات. سواء كنت تستخدم Mac أو Windows أو Linux أو iOS أو Android.' },\n  \n  'features.quality.title': { en: 'High Quality', ar: 'جودة عالية' },\n  'features.quality.desc': { en: 'We preserve your document layout and formatting for the best possible conversion quality.', ar: 'نحافظ على تخطيط وتنسيق المستند الخاص بك للحصول على أفضل جودة تحويل ممكنة.' },\n\n  // Footer\n  'footer.rights': { en: '© 2024 PDF Master. All rights reserved.', ar: '© 2024 ماستر بي دي اف. جميع الحقوق محفوظة.' },\n  'footer.privacy': { en: 'Privacy', ar: 'الخصوصية' },\n  'footer.terms': { en: 'Terms', ar: 'الشروط' },\n  'footer.contact': { en: 'Contact', ar: 'اتصل بنا' },\n\n  // Pricing\n  'pricing.title': { en: 'Support PDF Master', ar: 'ادعم ماستر بي دي اف' },\n  'pricing.subtitle': { en: 'We believe in free tools for everyone.', ar: 'نحن نؤمن بأدوات مجانية للجميع.' },\n  'pricing.free.title': { en: 'Free Forever', ar: 'مجاني للأبد' },\n  'pricing.free.desc': { en: 'All these services are for free, and we only need your support for donations to keep this website alive', ar: 'جميع هذه الخدمات مجانية، ونحتاج فقط لدعمكم بالتبرعات للحفاظ على استمرارية هذا الموقع' },\n  'pricing.donate.title': { en: 'Make a Donation', ar: 'تبرع الآن' },\n  'pricing.donate.desc': { en: 'Help us cover server costs and development.', ar: 'ساعدنا في تغطية تكاليف الخادم والتطوير.' },\n  'pricing.donate.button': { en: 'Donate Now', ar: 'تبرع الآن' },\n};\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\nexport function LanguageProvider({ children }: { children: React.ReactNode }) {\n  const [language, setLanguage] = useState<Language>('en');\n  const [direction, setDirection] = useState<Direction>('ltr');\n\n  useEffect(() => {\n    const dir = language === 'ar' ? 'rtl' : 'ltr';\n    setDirection(dir);\n    document.documentElement.dir = dir;\n    document.documentElement.lang = language;\n  }, [language]);\n\n  const t = (key: string) => {\n    return translations[key]?.[language] || key;\n  };\n\n  return (\n    <LanguageContext.Provider value={{ language, direction, setLanguage, t }}>\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useLanguage() {\n  const context = useContext(LanguageContext);\n  if (context === undefined) {\n    throw new Error('useLanguage must be used within a LanguageProvider');\n  }\n  return context;\n}\n","path":null,"size_bytes":15748,"size_tokens":null},"client/src/pages/DownloadHistory.tsx":{"content":"import { Navbar } from '@/components/Navbar';\nimport { useLanguage } from '@/lib/i18n';\nimport { FileText, Download, Clock, CheckCircle2 } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function DownloadHistory() {\n  const { t, direction } = useLanguage();\n\n  // Mock data for history\n  const historyItems = [\n    {\n      id: 1,\n      name: \"contract-signed.pdf\",\n      type: \"Sign PDF\",\n      date: \"Just now\",\n      size: \"2.4 MB\",\n      status: \"Ready\"\n    },\n    {\n      id: 2,\n      name: \"merged-documents.pdf\",\n      type: \"Merge PDF\",\n      date: \"2 hours ago\",\n      size: \"14.2 MB\",\n      status: \"Expired\"\n    },\n    {\n      id: 3,\n      name: \"presentation-compressed.pdf\",\n      type: \"Compress PDF\",\n      date: \"Yesterday\",\n      size: \"5.1 MB\",\n      status: \"Expired\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col font-sans\" dir={direction}>\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4 md:px-6\">\n        <div className=\"container mx-auto max-w-4xl\">\n          <div className=\"mb-8\">\n             <h1 className=\"text-3xl font-bold tracking-tight\">Download History</h1>\n             <p className=\"text-muted-foreground mt-2\">Access your recently processed files.</p>\n          </div>\n\n          <div className=\"bg-card border border-border/50 rounded-3xl shadow-sm overflow-hidden\">\n            {historyItems.length > 0 ? (\n              <div className=\"divide-y divide-border/50\">\n                {historyItems.map((item) => (\n                  <div key={item.id} className=\"p-6 flex items-center gap-4 hover:bg-secondary/20 transition-colors\">\n                    <div className={`\n                      h-12 w-12 rounded-xl flex items-center justify-center shadow-sm border border-border/50\n                      ${item.status === 'Ready' ? 'bg-green-50 text-green-600 dark:bg-green-900/20' : 'bg-secondary text-muted-foreground'}\n                    `}>\n                      <FileText className=\"h-6 w-6\" />\n                    </div>\n                    \n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                         <h3 className=\"font-semibold truncate\">{item.name}</h3>\n                         <span className=\"text-xs px-2 py-0.5 rounded-full bg-secondary text-secondary-foreground font-medium\">\n                           {item.type}\n                         </span>\n                      </div>\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                        <span className=\"flex items-center gap-1\">\n                          <Clock className=\"h-3 w-3\" /> {item.date}\n                        </span>\n                        <span>{item.size}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-3\">\n                      {item.status === 'Ready' ? (\n                        <Button size=\"sm\" className=\"rounded-full gap-2\">\n                          <Download className=\"h-4 w-4\" />\n                          Download\n                        </Button>\n                      ) : (\n                        <span className=\"text-sm text-muted-foreground italic px-4\">\n                          File Expired\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"p-12 text-center\">\n                <div className=\"w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-4 text-muted-foreground\">\n                  <Clock className=\"w-8 h-8\" />\n                </div>\n                <h3 className=\"text-lg font-medium mb-2\">No Recent Files</h3>\n                <p className=\"text-muted-foreground mb-6\">Process a file to see it here.</p>\n                <Link href=\"/\" className=\"inline-block\">\n                  <span className=\"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90 transition-colors\">\n                    Go to Tools\n                  </span>\n                </Link>\n              </div>\n            )}\n          </div>\n          \n          <div className=\"mt-6 text-center text-sm text-muted-foreground\">\n            <p>Files are automatically deleted from our servers after 2 hours for your privacy.</p>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":4601,"size_tokens":null},"client/src/pages/Pricing.tsx":{"content":"import { Navbar } from '@/components/Navbar';\nimport { useLanguage } from '@/lib/i18n';\nimport { Heart, Coffee, CheckCircle2 } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\nexport default function Pricing() {\n  const { t, direction } = useLanguage();\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col font-sans\" dir={direction}>\n      <Navbar />\n      \n      <main className=\"flex-1 py-16 px-4 md:px-6\">\n        <div className=\"container mx-auto max-w-4xl text-center\">\n          <div className=\"mb-12 space-y-4\">\n             <h1 className=\"text-4xl md:text-5xl font-bold tracking-tight text-foreground animate-in fade-in slide-in-from-bottom-2 duration-500\">\n               {t('pricing.title')}\n             </h1>\n             <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto animate-in fade-in slide-in-from-bottom-3 duration-500 delay-100\">\n               {t('pricing.subtitle')}\n             </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-1 gap-8 max-w-2xl mx-auto\">\n            {/* Donation Card - Highlighted */}\n            <div className=\"relative overflow-hidden bg-card border-2 border-primary/20 rounded-3xl shadow-lg p-8 md:p-12 animate-in fade-in scale-[0.98] duration-500 delay-200 hover:border-primary/50 transition-colors\">\n              <div className=\"absolute top-0 right-0 p-4 opacity-10\">\n                <Heart className=\"w-32 h-32 text-primary\" />\n              </div>\n              \n              <div className=\"relative z-10 flex flex-col items-center\">\n                <div className=\"h-20 w-20 rounded-full bg-primary/10 flex items-center justify-center mb-6 text-primary\">\n                  <Heart className=\"h-10 w-10 fill-current\" />\n                </div>\n                \n                <h2 className=\"text-3xl font-bold mb-4\">{t('pricing.free.title')}</h2>\n                \n                <p className=\"text-lg text-muted-foreground leading-relaxed mb-8 max-w-lg\">\n                  {t('pricing.free.desc')}\n                </p>\n                \n                <div className=\"w-full space-y-4\">\n                   <Button size=\"lg\" className=\"w-full rounded-full text-lg py-6 shadow-lg shadow-primary/20 hover:scale-105 transition-transform\">\n                     <Coffee className=\"mr-2 h-5 w-5\" />\n                     {t('pricing.donate.button')}\n                   </Button>\n                   <p className=\"text-xs text-muted-foreground\">\n                     {t('pricing.donate.desc')}\n                   </p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"mt-16 grid md:grid-cols-3 gap-8 text-center\">\n             <div className=\"p-6\">\n               <CheckCircle2 className=\"w-10 h-10 text-primary mx-auto mb-4\" />\n               <h3 className=\"font-semibold mb-2\">No Registration</h3>\n               <p className=\"text-sm text-muted-foreground\">Use all tools without creating an account.</p>\n             </div>\n             <div className=\"p-6\">\n               <CheckCircle2 className=\"w-10 h-10 text-primary mx-auto mb-4\" />\n               <h3 className=\"font-semibold mb-2\">No Watermarks</h3>\n               <p className=\"text-sm text-muted-foreground\">Clean documents with no added branding.</p>\n             </div>\n             <div className=\"p-6\">\n               <CheckCircle2 className=\"w-10 h-10 text-primary mx-auto mb-4\" />\n               <h3 className=\"font-semibold mb-2\">Unlimited Use</h3>\n               <p className=\"text-sm text-muted-foreground\">Process as many files as you need.</p>\n             </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":3677,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/pages/PDFToImage.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Slider } from '@/components/ui/slider';\nimport { FileText, X, Download, CheckCircle, Loader2, RotateCcw, Image, ImageIcon } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport JSZip from 'jszip';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface PageThumbnail {\n  pageNum: number;\n  imageUrl: string;\n  isLoading: boolean;\n}\n\ninterface ConversionResult {\n  images: { pageNum: number; dataUrl: string; filename: string }[];\n  format: string;\n  totalPages: number;\n}\n\nexport default function PDFToImage() {\n  const { language, direction } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [thumbnails, setThumbnails] = useState<PageThumbnail[]>([]);\n  const [selectedPages, setSelectedPages] = useState<Set<number>>(new Set());\n  const [totalPages, setTotalPages] = useState(0);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [result, setResult] = useState<ConversionResult | null>(null);\n  const [isLoadingThumbnails, setIsLoadingThumbnails] = useState(false);\n  const [format, setFormat] = useState<'jpg' | 'png'>('jpg');\n  const [quality, setQuality] = useState(90);\n  const [scale, setScale] = useState(2);\n  const [conversionMode, setConversionMode] = useState<'all' | 'selected'>('all');\n  const [progress, setProgress] = useState(0);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const pdfDocRef = useRef<any>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setResult(null);\n      setThumbnails([]);\n      setSelectedPages(new Set());\n      setTotalPages(0);\n      setProgress(0);\n    }\n  };\n\n  const renderPage = useCallback(async (pdfDoc: any, pageNum: number, renderScale: number = 0.3): Promise<string> => {\n    const page = await pdfDoc.getPage(pageNum);\n    const viewport = page.getViewport({ scale: renderScale });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d')!;\n    canvas.height = viewport.height;\n    canvas.width = viewport.width;\n\n    await page.render({ canvasContext: context, viewport }).promise;\n    return canvas.toDataURL('image/jpeg', 0.7);\n  }, []);\n\n  useEffect(() => {\n    if (!file) return;\n\n    const loadThumbnails = async () => {\n      setIsLoadingThumbnails(true);\n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        pdfDocRef.current = pdfDoc;\n        const numPages = pdfDoc.numPages;\n        setTotalPages(numPages);\n\n        const initialThumbs: PageThumbnail[] = Array.from({ length: numPages }, (_, i) => ({\n          pageNum: i + 1,\n          imageUrl: '',\n          isLoading: true\n        }));\n        setThumbnails(initialThumbs);\n\n        for (let i = 0; i < numPages; i++) {\n          const imageUrl = await renderPage(pdfDoc, i + 1);\n          setThumbnails(prev => prev.map((thumb, idx) => \n            idx === i ? { ...thumb, imageUrl, isLoading: false } : thumb\n          ));\n        }\n      } catch (err) {\n        console.error('Error loading PDF:', err);\n        toast({\n          title: language === 'ar' ? 'خطأ' : 'Error',\n          description: language === 'ar' ? 'فشل في تحميل الملف' : 'Failed to load PDF file',\n          variant: 'destructive'\n        });\n      } finally {\n        setIsLoadingThumbnails(false);\n      }\n    };\n\n    loadThumbnails();\n  }, [file, renderPage, language, toast]);\n\n  useEffect(() => {\n    if (isProcessing) {\n      timerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleTogglePage = useCallback((pageNum: number) => {\n    // Automatically switch to 'selected' mode when clicking a page\n    setConversionMode('selected');\n    setSelectedPages(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(pageNum)) {\n        newSet.delete(pageNum);\n      } else {\n        newSet.add(pageNum);\n      }\n      return newSet;\n    });\n  }, []);\n\n  const handleSelectAll = useCallback(() => {\n    setSelectedPages(new Set(Array.from({ length: totalPages }, (_, i) => i + 1)));\n  }, [totalPages]);\n\n  const handleClearSelection = useCallback(() => {\n    setSelectedPages(new Set());\n  }, []);\n\n  const handleConvert = async () => {\n    if (!file || !pdfDocRef.current) return;\n\n    const pagesToConvert = conversionMode === 'all' \n      ? Array.from({ length: totalPages }, (_, i) => i + 1)\n      : Array.from(selectedPages).sort((a, b) => a - b);\n\n    if (pagesToConvert.length === 0) {\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: language === 'ar' ? 'الرجاء اختيار صفحات للتحويل' : 'Please select pages to convert',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n    setElapsedTime(0);\n    setProgress(0);\n    setResult(null);\n\n    try {\n      const pdfDoc = pdfDocRef.current;\n      const images: { pageNum: number; dataUrl: string; filename: string }[] = [];\n      const baseName = file.name.replace(/\\.pdf$/i, '');\n\n      for (let i = 0; i < pagesToConvert.length; i++) {\n        const pageNum = pagesToConvert[i];\n        const page = await pdfDoc.getPage(pageNum);\n        const viewport = page.getViewport({ scale });\n        \n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d')!;\n        canvas.height = viewport.height;\n        canvas.width = viewport.width;\n\n        await page.render({ canvasContext: context, viewport }).promise;\n\n        const mimeType = format === 'png' ? 'image/png' : 'image/jpeg';\n        const qualityValue = format === 'png' ? undefined : quality / 100;\n        const dataUrl = canvas.toDataURL(mimeType, qualityValue);\n        const ext = format === 'png' ? 'png' : 'jpg';\n        const filename = `${baseName}_page_${pageNum}.${ext}`;\n\n        images.push({ pageNum, dataUrl, filename });\n        setProgress(Math.round(((i + 1) / pagesToConvert.length) * 100));\n      }\n\n      setResult({\n        images,\n        format,\n        totalPages: images.length\n      });\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: language === 'ar' \n          ? `تم تحويل ${images.length} صفحة إلى صور`\n          : `${images.length} page${images.length > 1 ? 's' : ''} converted to images`,\n      });\n    } catch (error: any) {\n      console.error('Error converting PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في تحويل PDF. يرجى المحاولة مرة أخرى.'\n          : 'Failed to convert PDF. Please try again.'),\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownloadSingle = (image: { pageNum: number; dataUrl: string; filename: string }) => {\n    const a = document.createElement('a');\n    a.href = image.dataUrl;\n    a.download = image.filename;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n  };\n\n  const handleDownloadAll = async () => {\n    if (!result) return;\n\n    if (result.images.length === 1) {\n      handleDownloadSingle(result.images[0]);\n      return;\n    }\n\n    const zip = new JSZip();\n    const baseName = file?.name.replace(/\\.pdf$/i, '') || 'images';\n\n    for (const img of result.images) {\n      const base64Data = img.dataUrl.split(',')[1];\n      zip.file(img.filename, base64Data, { base64: true });\n    }\n\n    const blob = await zip.generateAsync({ type: 'blob' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `${baseName}_images.zip`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  };\n\n  const handleReset = () => {\n    setFile(null);\n    setResult(null);\n    setThumbnails([]);\n    setSelectedPages(new Set());\n    setTotalPages(0);\n    setElapsedTime(0);\n    setProgress(0);\n  };\n\n  return (\n    <ToolPageLayout\n      title={language === 'ar' ? 'PDF إلى صورة' : 'PDF to Image'}\n      description={language === 'ar' ? 'حوّل صفحات PDF إلى صور JPG أو PNG عالية الجودة.' : 'Convert PDF pages to high-quality JPG or PNG images.'}\n      isProcessing={isProcessing}\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لتحويله إلى صور' : 'Select a PDF file to convert to images'}\n          />\n        </div>\n      ) : result ? (\n        <div className=\"space-y-8\">\n          <div className=\"text-center space-y-4 py-8\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم التحويل بنجاح!' : 'Conversion Complete!'}\n            </h3>\n            <p className=\"text-muted-foreground\">\n              {language === 'ar' \n                ? `تم تحويل ${result.totalPages} صفحة إلى ${result.format.toUpperCase()}`\n                : `${result.totalPages} page${result.totalPages > 1 ? 's' : ''} converted to ${result.format.toUpperCase()}`}\n            </p>\n          </div>\n\n          <div className=\"flex justify-center gap-4\">\n            <Button \n              size=\"lg\"\n              onClick={handleDownloadAll}\n              className=\"rounded-full px-8\"\n              data-testid=\"button-download-all\"\n            >\n              <Download className=\"h-5 w-5 me-2\" />\n              {result.images.length > 1 \n                ? (language === 'ar' ? 'تحميل الكل (ZIP)' : 'Download All (ZIP)')\n                : (language === 'ar' ? 'تحميل الصورة' : 'Download Image')}\n            </Button>\n            <Button \n              size=\"lg\"\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"rounded-full px-8\"\n              data-testid=\"button-convert-another\"\n            >\n              {language === 'ar' ? 'تحويل ملف آخر' : 'Convert Another'}\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-8\">\n            {result.images.map((img) => (\n              <div \n                key={img.pageNum}\n                className=\"relative aspect-[3/4] rounded-lg border-2 border-border/50 overflow-hidden bg-white group\"\n              >\n                <img \n                  src={img.dataUrl} \n                  alt={`Page ${img.pageNum}`}\n                  className=\"w-full h-full object-contain\"\n                />\n                <div className=\"absolute top-1 left-1 bg-black/70 text-white text-xs px-1.5 py-0.5 rounded\">\n                  {img.pageNum}\n                </div>\n                <button\n                  onClick={() => handleDownloadSingle(img)}\n                  className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\"\n                  data-testid={`button-download-page-${img.pageNum}`}\n                >\n                  <Download className=\"h-8 w-8 text-white\" />\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-primary\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-file-name\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-size\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB {totalPages > 0 && `• ${totalPages} ${language === 'ar' ? 'صفحة' : 'pages'}`}\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={handleReset}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <div className=\"space-y-4 p-4 bg-secondary/20 rounded-xl border border-border/30\">\n              <h4 className=\"font-medium flex items-center gap-2\">\n                <ImageIcon className=\"h-4 w-4\" />\n                {language === 'ar' ? 'إعدادات التحويل' : 'Conversion Settings'}\n              </h4>\n              \n              <div className=\"space-y-3\">\n                <Label>{language === 'ar' ? 'تنسيق الصورة' : 'Image Format'}</Label>\n                <RadioGroup value={format} onValueChange={(v) => setFormat(v as 'jpg' | 'png')} className=\"flex gap-4\" data-testid=\"radio-format\">\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"jpg\" id=\"format-jpg\" data-testid=\"radio-format-jpg\" />\n                    <Label htmlFor=\"format-jpg\" className=\"cursor-pointer\">JPG</Label>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <RadioGroupItem value=\"png\" id=\"format-png\" data-testid=\"radio-format-png\" />\n                    <Label htmlFor=\"format-png\" className=\"cursor-pointer\">PNG</Label>\n                  </div>\n                </RadioGroup>\n              </div>\n\n              {format === 'jpg' && (\n                <div className=\"space-y-3\">\n                  <div className=\"flex justify-between\">\n                    <Label>{language === 'ar' ? 'الجودة' : 'Quality'}</Label>\n                    <span className=\"text-sm text-muted-foreground\" data-testid=\"text-quality\">{quality}%</span>\n                  </div>\n                  <Slider\n                    value={[quality]}\n                    onValueChange={(v) => setQuality(v[0])}\n                    min={10}\n                    max={100}\n                    step={5}\n                    className=\"w-full\"\n                    data-testid=\"slider-quality\"\n                  />\n                </div>\n              )}\n\n              <div className=\"space-y-3\">\n                <div className=\"flex justify-between\">\n                  <Label>{language === 'ar' ? 'الدقة' : 'Resolution'}</Label>\n                  <span className=\"text-sm text-muted-foreground\" data-testid=\"text-resolution\">{scale}x</span>\n                </div>\n                <Slider\n                  value={[scale]}\n                  onValueChange={(v) => setScale(v[0])}\n                  min={1}\n                  max={4}\n                  step={0.5}\n                  className=\"w-full\"\n                  data-testid=\"slider-resolution\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  {language === 'ar' \n                    ? 'دقة أعلى = صور أكبر وأوضح'\n                    : 'Higher resolution = larger, clearer images'}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"space-y-4 p-4 bg-secondary/20 rounded-xl border border-border/30\">\n              <h4 className=\"font-medium flex items-center gap-2\">\n                <Image className=\"h-4 w-4\" />\n                {language === 'ar' ? 'الصفحات' : 'Pages'}\n              </h4>\n              \n              <RadioGroup value={conversionMode} onValueChange={(v) => setConversionMode(v as 'all' | 'selected')} className=\"space-y-2\" data-testid=\"radio-mode\">\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"all\" id=\"mode-all\" data-testid=\"radio-mode-all\" />\n                  <Label htmlFor=\"mode-all\" className=\"cursor-pointer\">\n                    {language === 'ar' ? `جميع الصفحات (${totalPages})` : `All pages (${totalPages})`}\n                  </Label>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <RadioGroupItem value=\"selected\" id=\"mode-selected\" data-testid=\"radio-mode-selected\" />\n                  <Label htmlFor=\"mode-selected\" className=\"cursor-pointer\">\n                    {language === 'ar' ? 'صفحات محددة' : 'Selected pages'}\n                    {selectedPages.size > 0 && ` (${selectedPages.size})`}\n                  </Label>\n                </div>\n              </RadioGroup>\n\n              {conversionMode === 'selected' && (\n                <div className=\"flex gap-2 pt-2\">\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleSelectAll} data-testid=\"button-select-all\">\n                    {language === 'ar' ? 'اختيار الكل' : 'Select All'}\n                  </Button>\n                  <Button size=\"sm\" variant=\"outline\" onClick={handleClearSelection} data-testid=\"button-clear-selection\">\n                    <RotateCcw className=\"h-3 w-3 me-1\" />\n                    {language === 'ar' ? 'إلغاء' : 'Clear'}\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {isLoadingThumbnails && thumbnails.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 gap-4\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n              <p className=\"text-muted-foreground\">\n                {language === 'ar' ? 'جاري تحميل صفحات PDF...' : 'Loading PDF pages...'}\n              </p>\n            </div>\n          ) : (\n            <>\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-muted-foreground\">\n                  {conversionMode === 'selected' \n                    ? (language === 'ar' ? 'انقر على الصفحات لتحديدها للتحويل' : 'Click pages to select for conversion')\n                    : (language === 'ar' ? 'معاينة الصفحات' : 'Page preview')}\n                </span>\n                {conversionMode === 'selected' && selectedPages.size > 0 && (\n                  <span className=\"font-medium text-primary\">\n                    {language === 'ar' \n                      ? `تم تحديد ${selectedPages.size} صفحة`\n                      : `${selectedPages.size} page${selectedPages.size > 1 ? 's' : ''} selected`}\n                  </span>\n                )}\n              </div>\n\n              <div \n                className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3\"\n                dir={direction}\n              >\n                {thumbnails.map((thumb) => {\n                  const isSelected = conversionMode === 'selected' && selectedPages.has(thumb.pageNum);\n                  \n                  return (\n                    <div\n                      key={thumb.pageNum}\n                      onClick={() => handleTogglePage(thumb.pageNum)}\n                      className={`\n                        relative aspect-[3/4] rounded-lg border-2 overflow-hidden\n                        transition-all duration-200 cursor-pointer hover:border-primary/50 hover:shadow-md\n                        ${isSelected ? 'border-primary ring-2 ring-primary/30' : 'border-border/50'}\n                      `}\n                      data-testid={`page-thumbnail-${thumb.pageNum}`}\n                    >\n                      {thumb.isLoading ? (\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-secondary/50\">\n                          <Loader2 className=\"h-6 w-6 animate-spin text-primary\" />\n                        </div>\n                      ) : thumb.imageUrl ? (\n                        <img \n                          src={thumb.imageUrl} \n                          alt={`Page ${thumb.pageNum}`}\n                          className=\"w-full h-full object-contain bg-white\"\n                        />\n                      ) : (\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-secondary/30\">\n                          <FileText className=\"h-8 w-8 text-muted-foreground\" />\n                        </div>\n                      )}\n                      \n                      <div className=\"absolute top-1 left-1 bg-black/70 text-white text-xs px-1.5 py-0.5 rounded\">\n                        {thumb.pageNum}\n                      </div>\n                      \n                      {isSelected && (\n                        <div className=\"absolute inset-0 bg-primary/20 flex items-center justify-center\">\n                          <CheckCircle className=\"h-8 w-8 text-primary\" />\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            </>\n          )}\n\n          <div className=\"flex justify-center pt-4\">\n            <Button\n              size=\"lg\"\n              onClick={handleConvert}\n              disabled={isProcessing || (conversionMode === 'selected' && selectedPages.size === 0)}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-convert\"\n            >\n              {isProcessing ? (\n                <>\n                  <Loader2 className=\"h-5 w-5 me-2 animate-spin\" />\n                  {language === 'ar' ? `جاري التحويل... ${progress}%` : `Converting... ${progress}%`}\n                </>\n              ) : (\n                <>\n                  <Image className=\"h-5 w-5 me-2\" />\n                  {conversionMode === 'all'\n                    ? (language === 'ar' ? `تحويل ${totalPages} صفحة` : `Convert ${totalPages} Pages`)\n                    : (language === 'ar' ? `تحويل ${selectedPages.size} صفحة` : `Convert ${selectedPages.size} Page${selectedPages.size > 1 ? 's' : ''}`)}\n                </>\n              )}\n            </Button>\n          </div>\n\n          {isProcessing && (\n            <div className=\"space-y-2\">\n              <div className=\"w-full bg-secondary rounded-full h-2\">\n                <div \n                  className=\"bg-primary h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${progress}%` }}\n                />\n              </div>\n              <p className=\"text-center text-sm text-muted-foreground\">\n                {language === 'ar' ? 'الوقت المنقضي:' : 'Elapsed time:'} {formatTime(elapsedTime)}\n              </p>\n            </div>\n          )}\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":23996,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1828,"size_tokens":null},"client/src/components/ToolPageLayout.tsx":{"content":"import { useState } from 'react';\nimport { Navbar } from '@/components/Navbar';\nimport { Button } from '@/components/ui/button';\nimport { useLanguage } from '@/lib/i18n';\nimport { ArrowLeft, ArrowRight, Loader2, CheckCircle2 } from 'lucide-react';\nimport { Link } from 'wouter';\n\ninterface ToolPageLayoutProps {\n  title: string;\n  description: string;\n  children: React.ReactNode;\n  actionButton?: React.ReactNode;\n  isProcessing?: boolean;\n}\n\nexport function ToolPageLayout({ \n  title, \n  description, \n  children, \n  actionButton,\n  isProcessing \n}: ToolPageLayoutProps) {\n  const { t, direction } = useLanguage();\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col font-sans\" dir={direction}>\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4 md:px-6\">\n        <div className=\"container mx-auto max-w-5xl\">\n          {/* Breadcrumb / Back */}\n          <div className=\"mb-8\">\n            <Link href=\"/\" className=\"inline-flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-primary transition-colors\">\n              {direction === 'rtl' ? <ArrowRight className=\"h-4 w-4\" /> : <ArrowLeft className=\"h-4 w-4\" />}\n              {t('nav.allTools')}\n            </Link>\n          </div>\n\n          {/* Header */}\n          <div className=\"text-center mb-12 space-y-4\">\n            <h1 className=\"text-3xl md:text-5xl font-bold tracking-tight text-foreground animate-in fade-in slide-in-from-bottom-2 duration-500\">\n              {title}\n            </h1>\n            <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto animate-in fade-in slide-in-from-bottom-3 duration-500 delay-100\">\n              {description}\n            </p>\n          </div>\n\n          {/* Main Content Area */}\n          <div className=\"bg-card border border-border/50 rounded-3xl shadow-sm p-6 md:p-12 min-h-[400px] relative overflow-hidden animate-in fade-in scale-[0.98] duration-500 delay-200\">\n            {isProcessing && (\n              <div className=\"absolute inset-0 z-50 bg-background/80 backdrop-blur-sm flex flex-col items-center justify-center gap-4 animate-in fade-in duration-300\">\n                <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n                <p className=\"text-lg font-medium text-muted-foreground\">Processing your files...</p>\n              </div>\n            )}\n            \n            <div className=\"h-full flex flex-col\">\n              <div className=\"flex-1\">\n                {children}\n              </div>\n              \n              {actionButton && (\n                <div className=\"mt-8 flex justify-center pt-8 border-t border-border/50\">\n                  {actionButton}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":2800,"size_tokens":null},"server/pdf-provider.ts":{"content":"import axios from 'axios';\nimport FormData from 'form-data';\nimport fs from 'fs';\nimport path from 'path';\nimport { execFileSync } from 'child_process';\nimport { PDFDocument } from 'pdf-lib';\nimport { log } from './index';\n\n// Use /tmp for faster I/O\nconst TEMP_DIR = '/tmp/pdf-temp';\n\n// Ensure temp directory exists\nif (!fs.existsSync(TEMP_DIR)) {\n  fs.mkdirSync(TEMP_DIR, { recursive: true });\n}\n\n/**\n * PDF Provider Service\n * \n * This service acts as a middle layer between your application and external PDF APIs.\n * Currently supports:\n * - ILovePDF API (https://developer.ilovepdf.com/)\n * - Can be extended to support PDF.co, CloudConvert, etc.\n * \n * Set PDFAPI_PROVIDER environment variable to: 'ilovepdf', 'pdfco', or 'cloudconvert'\n */\n\nexport interface PDFProviderConfig {\n  provider: 'ilovepdf' | 'pdfco' | 'cloudconvert' | 'mock';\n  apiKey?: string;\n  apiSecret?: string;\n}\n\nexport interface MergeOptions {\n  compress?: boolean;\n}\n\nexport class PDFProvider {\n  private config: PDFProviderConfig;\n\n  constructor(config: PDFProviderConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Merge multiple PDF files into one\n   */\n  async mergePDFs(filePaths: string[], options: MergeOptions = {}): Promise<Buffer> {\n    log(`[PDF Provider] Merging ${filePaths.length} PDFs using ${this.config.provider}, compress: ${options.compress ?? false}`);\n\n    if (this.config.provider === 'mock') {\n      return this.localMergePDF(filePaths, options);\n    }\n\n    if (this.config.provider === 'ilovepdf') {\n      return this.ilovePDFMerge(filePaths);\n    }\n\n    throw new Error(`Provider ${this.config.provider} not implemented for merge`);\n  }\n\n  /**\n   * Split PDF into separate pages using qpdf\n   * Returns output directory with individual PDF files\n   */\n  async splitPDF(filePath: string, mode: 'all' | 'range', ranges?: string): Promise<{ outputDir: string; pageCount: number; files: string[] }> {\n    log(`[PDF Provider] Splitting PDF using ${this.config.provider}, mode: ${mode}, ranges: ${ranges}`);\n\n    // Always use local qpdf for splitting (fast and free)\n    return this.localSplitPDF(filePath, mode, ranges);\n  }\n\n  /**\n   * Remove specific pages from a PDF using qpdf\n   * Returns a buffer of the PDF with specified pages removed\n   */\n  async removePages(filePath: string, pagesToRemove: string): Promise<{ buffer: Buffer; originalPageCount: number; removedCount: number; finalPageCount: number }> {\n    log(`[PDF Provider] Removing pages from PDF: ${pagesToRemove}`);\n    return this.qpdfRemovePages(filePath, pagesToRemove);\n  }\n\n  /**\n   * Rotate specific pages in a PDF using pdf-lib\n   * Returns a buffer of the PDF with specified pages rotated\n   */\n  async rotatePages(filePath: string, pagesToRotate: string, angle: number): Promise<{ buffer: Buffer; totalPages: number; rotatedCount: number }> {\n    log(`[PDF Provider] Rotating pages in PDF: ${pagesToRotate} by ${angle}°`);\n    return this.pdfLibRotatePages(filePath, pagesToRotate, angle);\n  }\n\n  /**\n   * Rotate pages with per-page angles using pdf-lib\n   * Accepts an object mapping page numbers to rotation angles\n   */\n  async rotatePagesPerPage(filePath: string, pageRotations: Record<string, number>): Promise<{ buffer: Buffer; totalPages: number; rotatedCount: number }> {\n    log(`[PDF Provider] Rotating pages with per-page angles`);\n    return this.pdfLibRotatePagesPerPage(filePath, pageRotations);\n  }\n\n  /**\n   * Organize PDF pages in a new order using pdf-lib\n   * Returns a buffer of the PDF with pages reorganized\n   */\n  async organizePages(filePath: string, pageOrder: number[]): Promise<{ buffer: Buffer; totalPages: number }> {\n    log(`[PDF Provider] Organizing PDF pages to new order: ${pageOrder.join(', ')}`);\n    return this.pdfLibOrganizePages(filePath, pageOrder);\n  }\n\n  /**\n   * Organize pages using pdf-lib\n   */\n  private async pdfLibOrganizePages(filePath: string, pageOrder: number[]): Promise<{ buffer: Buffer; totalPages: number }> {\n    try {\n      const pdfBytes = fs.readFileSync(filePath);\n      const srcPdf = await PDFDocument.load(pdfBytes);\n      const totalPages = srcPdf.getPageCount();\n      \n      log(`[PDF Provider] Original PDF has ${totalPages} pages`);\n      \n      // Validate page order - must be a valid permutation of 1..N\n      if (pageOrder.length !== totalPages) {\n        throw new Error(`Page order must contain exactly ${totalPages} pages`);\n      }\n      \n      // Check that it's a valid permutation (all pages 1..N appear exactly once)\n      const sortedOrder = [...pageOrder].sort((a, b) => a - b);\n      for (let i = 0; i < totalPages; i++) {\n        if (sortedOrder[i] !== i + 1) {\n          throw new Error(`Invalid page order: each page from 1 to ${totalPages} must appear exactly once`);\n        }\n      }\n      \n      // Create a new PDF with pages in the new order\n      const newPdf = await PDFDocument.create();\n      \n      for (const pageNum of pageOrder) {\n        const [copiedPage] = await newPdf.copyPages(srcPdf, [pageNum - 1]);\n        newPdf.addPage(copiedPage);\n      }\n      \n      const modifiedPdfBytes = await newPdf.save();\n      \n      log(`[PDF Provider] Reorganized ${totalPages} pages`);\n      \n      return {\n        buffer: Buffer.from(modifiedPdfBytes),\n        totalPages\n      };\n    } catch (error: any) {\n      log(`[PDF Provider] Error organizing pages: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Rotate pages with per-page angles using pdf-lib\n   */\n  private async pdfLibRotatePagesPerPage(filePath: string, pageRotations: Record<string, number>): Promise<{ buffer: Buffer; totalPages: number; rotatedCount: number }> {\n    try {\n      const pdfBytes = fs.readFileSync(filePath);\n      const pdfDoc = await PDFDocument.load(pdfBytes);\n      const totalPages = pdfDoc.getPageCount();\n      \n      log(`[PDF Provider] Original PDF has ${totalPages} pages`);\n      \n      const pages = pdfDoc.getPages();\n      let rotatedCount = 0;\n      \n      for (const [pageStr, angle] of Object.entries(pageRotations)) {\n        const pageNum = parseInt(pageStr);\n        if (!isNaN(pageNum) && pageNum > 0 && pageNum <= totalPages && angle !== 0) {\n          const page = pages[pageNum - 1];\n          const currentRotation = page.getRotation().angle;\n          const newRotation = (currentRotation + angle) % 360;\n          page.setRotation({ angle: newRotation, type: 'degrees' } as any);\n          rotatedCount++;\n        }\n      }\n      \n      const modifiedPdfBytes = await pdfDoc.save();\n      \n      return {\n        buffer: Buffer.from(modifiedPdfBytes),\n        totalPages,\n        rotatedCount\n      };\n    } catch (error: any) {\n      log(`[PDF Provider] Error rotating pages: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Rotate pages using pdf-lib\n   */\n  private async pdfLibRotatePages(filePath: string, pagesToRotate: string, angle: number): Promise<{ buffer: Buffer; totalPages: number; rotatedCount: number }> {\n    try {\n      const pdfBytes = fs.readFileSync(filePath);\n      const pdfDoc = await PDFDocument.load(pdfBytes);\n      const totalPages = pdfDoc.getPageCount();\n      \n      log(`[PDF Provider] Original PDF has ${totalPages} pages`);\n      \n      // Parse pages to rotate\n      const rotateSet = new Set<number>();\n      const parts = pagesToRotate.split(',').map(p => p.trim()).filter(p => p.length > 0);\n      \n      for (const part of parts) {\n        if (part.includes('-')) {\n          const [start, end] = part.split('-').map(n => parseInt(n.trim()));\n          if (!isNaN(start) && !isNaN(end)) {\n            for (let i = start; i <= end; i++) {\n              if (i > 0 && i <= totalPages) {\n                rotateSet.add(i);\n              }\n            }\n          }\n        } else {\n          const page = parseInt(part);\n          if (!isNaN(page) && page > 0 && page <= totalPages) {\n            rotateSet.add(page);\n          }\n        }\n      }\n      \n      if (rotateSet.size === 0) {\n        throw new Error('No valid pages specified for rotation.');\n      }\n      \n      log(`[PDF Provider] Rotating ${rotateSet.size} pages by ${angle}°`);\n      \n      // Rotate each selected page\n      const pages = pdfDoc.getPages();\n      const pageNumbers = Array.from(rotateSet);\n      for (let i = 0; i < pageNumbers.length; i++) {\n        const pageNum = pageNumbers[i];\n        const page = pages[pageNum - 1]; // Pages are 0-indexed\n        const currentRotation = page.getRotation().angle;\n        const newRotation = (currentRotation + angle) % 360;\n        page.setRotation({ angle: newRotation, type: 'degrees' } as any);\n      }\n      \n      const modifiedPdfBytes = await pdfDoc.save();\n      \n      return {\n        buffer: Buffer.from(modifiedPdfBytes),\n        totalPages,\n        rotatedCount: rotateSet.size\n      };\n    } catch (error: any) {\n      log(`[PDF Provider] Error rotating pages: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Remove pages using qpdf - calculates pages to keep and extracts them\n   */\n  private async qpdfRemovePages(filePath: string, pagesToRemove: string): Promise<{ buffer: Buffer; originalPageCount: number; removedCount: number; finalPageCount: number }> {\n    const startTime = Date.now();\n    \n    try {\n      // Get total page count\n      const pageCountOutput = execFileSync('qpdf', ['--show-npages', filePath], {\n        encoding: 'utf-8',\n        timeout: 60000\n      }).trim();\n      const totalPages = parseInt(pageCountOutput);\n      log(`[PDF Provider] Original PDF has ${totalPages} pages`);\n      \n      // Parse pages to remove - filter out empty tokens\n      const removeSet = new Set<number>();\n      const parts = pagesToRemove.split(',').map(p => p.trim()).filter(p => p.length > 0);\n      \n      for (const part of parts) {\n        if (part.includes('-')) {\n          const [start, end] = part.split('-').map(n => parseInt(n.trim()));\n          if (!isNaN(start) && !isNaN(end)) {\n            for (let i = start; i <= end; i++) {\n              if (i > 0 && i <= totalPages) {\n                removeSet.add(i);\n              }\n            }\n          }\n        } else {\n          const page = parseInt(part);\n          if (!isNaN(page) && page > 0 && page <= totalPages) {\n            removeSet.add(page);\n          }\n        }\n      }\n      \n      if (removeSet.size === 0) {\n        throw new Error('No valid pages specified for removal.');\n      }\n      \n      if (removeSet.size >= totalPages) {\n        throw new Error('Cannot remove all pages from the PDF.');\n      }\n      \n      // Calculate pages to keep (all pages minus removed ones)\n      const pagesToKeep: number[] = [];\n      for (let i = 1; i <= totalPages; i++) {\n        if (!removeSet.has(i)) {\n          pagesToKeep.push(i);\n        }\n      }\n      \n      log(`[PDF Provider] Removing ${removeSet.size} pages, keeping ${pagesToKeep.length} pages`);\n      \n      // Build page range string for qpdf\n      const pageRangeStr = pagesToKeep.join(',');\n      \n      // Extract pages to keep into new PDF\n      const outputPath = path.join(TEMP_DIR, `removed_${Date.now()}_${Math.random().toString(36).slice(2)}.pdf`);\n      \n      execFileSync('qpdf', [\n        filePath,\n        '--pages', filePath, pageRangeStr, '--',\n        outputPath\n      ], { \n        timeout: 600000,\n        maxBuffer: 1024 * 1024 * 100\n      });\n      \n      // Read result\n      const resultBuffer = fs.readFileSync(outputPath);\n      \n      // Cleanup\n      try {\n        fs.unlinkSync(outputPath);\n      } catch (e) {}\n      \n      const elapsed = Date.now() - startTime;\n      log(`[PDF Provider] Removed ${removeSet.size} pages in ${elapsed}ms (${totalPages} → ${pagesToKeep.length} pages)`);\n      \n      return {\n        buffer: resultBuffer,\n        originalPageCount: totalPages,\n        removedCount: removeSet.size,\n        finalPageCount: pagesToKeep.length\n      };\n    } catch (error: any) {\n      log(`[PDF Provider] Error removing pages: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Local PDF merging using qpdf (native tool - 5-10x faster than pdf-lib)\n   * Falls back to pdf-lib if qpdf is not available\n   */\n  private async localMergePDF(filePaths: string[], options: MergeOptions = {}): Promise<Buffer> {\n    try {\n      return await this.qpdfMergePDF(filePaths, options);\n    } catch (error: any) {\n      log(`[PDF Provider] qpdf failed, falling back to pdf-lib: ${error.message}`);\n      return this.pdfLibMergePDF(filePaths);\n    }\n  }\n\n  /**\n   * Fast PDF merging using qpdf native command-line tool\n   * Uses execFileSync with argument array to prevent command injection\n   */\n  private async qpdfMergePDF(filePaths: string[], options: MergeOptions = {}): Promise<Buffer> {\n    const startTime = Date.now();\n    const compress = options.compress ?? false;\n    log(`[PDF Provider] Starting qpdf merge of ${filePaths.length} PDFs (compress: ${compress})...`);\n\n    const outputPath = path.join(TEMP_DIR, `merged_${Date.now()}_${Math.random().toString(36).slice(2)}.pdf`);\n    \n    try {\n      for (const filePath of filePaths) {\n        if (!fs.existsSync(filePath)) {\n          throw new Error(`File not found: ${filePath}`);\n        }\n      }\n\n      const args: string[] = [];\n      \n      if (compress) {\n        args.push('--recompress-flate');\n        args.push('--compression-level=9');\n        args.push('--object-streams=generate');\n      } else {\n        args.push('--compress-streams=n');\n        args.push('--decode-level=none');\n      }\n      \n      args.push('--empty', '--pages', ...filePaths, '--', outputPath);\n      \n      log(`[PDF Provider] Executing qpdf merge with ${filePaths.length} files (mode: ${compress ? 'compressed' : 'fast'})...`);\n      execFileSync('qpdf', args, { \n        maxBuffer: 1024 * 1024 * 100,\n        timeout: 600000\n      });\n      \n      const mergedBuffer = fs.readFileSync(outputPath);\n      \n      try {\n        fs.unlinkSync(outputPath);\n      } catch (cleanupError) {\n        log(`[PDF Provider] Cleanup warning: ${cleanupError}`);\n      }\n\n      const totalTime = Date.now() - startTime;\n      log(`[PDF Provider] qpdf merge complete - ${filePaths.length} PDFs combined in ${totalTime}ms (mode: ${compress ? 'compressed' : 'fast'})`);\n      \n      return mergedBuffer;\n    } catch (error: any) {\n      try {\n        if (fs.existsSync(outputPath)) {\n          fs.unlinkSync(outputPath);\n        }\n      } catch (cleanupError) {}\n      \n      throw error;\n    }\n  }\n\n  /**\n   * Fallback PDF merging using pdf-lib (JavaScript-based, slower but always works)\n   */\n  private async pdfLibMergePDF(filePaths: string[]): Promise<Buffer> {\n    try {\n      log(`[PDF Provider] Loading ${filePaths.length} PDFs in parallel...`);\n      const startLoad = Date.now();\n      \n      const loadPromises = filePaths.map((filePath, i) => \n        (async () => {\n          try {\n            const fileBuffer = fs.readFileSync(filePath);\n            const pdf = await PDFDocument.load(fileBuffer);\n            return { pdf, index: i, filePath };\n          } catch (fileError: any) {\n            log(`Error loading PDF file ${i + 1}: ${fileError.message}`);\n            throw new Error(`File ${i + 1} is invalid or corrupted: ${fileError.message}`);\n          }\n        })()\n      );\n\n      const loadedPdfs = await Promise.all(loadPromises);\n      const loadTime = Date.now() - startLoad;\n      log(`[PDF Provider] All ${filePaths.length} PDFs loaded in ${loadTime}ms`);\n\n      log(`[PDF Provider] Merging all pages...`);\n      const startMerge = Date.now();\n      const mergedPdf = await PDFDocument.create();\n      \n      for (let i = 0; i < loadedPdfs.length; i++) {\n        const { pdf } = loadedPdfs[i];\n        const pageIndices = pdf.getPageIndices();\n        const pages = await mergedPdf.copyPages(pdf, pageIndices);\n        pages.forEach(page => mergedPdf.addPage(page));\n        \n        if ((i + 1) % 10 === 0) {\n          log(`[PDF Provider] Merged ${i + 1}/${loadedPdfs.length} files`);\n        }\n      }\n\n      log(`[PDF Provider] Saving merged PDF with compression...`);\n      const startSave = Date.now();\n      const pdfBytes = await mergedPdf.save({ \n        useObjectStreams: true,\n        addDefaultPage: false\n      });\n      const saveTime = Date.now() - startSave;\n      const mergeTime = Date.now() - startMerge;\n      \n      log(`[PDF Provider] Merge complete - ${filePaths.length} PDFs combined in ${mergeTime}ms (save: ${saveTime}ms)`);\n      return Buffer.from(pdfBytes);\n    } catch (error: any) {\n      log(`Error in pdf-lib merge: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Local PDF splitting using qpdf (native tool - much faster than pdf-lib)\n   * Returns an object with outputDir containing individual PDF files\n   */\n  private async localSplitPDF(filePath: string, mode: 'all' | 'range', ranges?: string): Promise<{ outputDir: string; pageCount: number; files: string[] }> {\n    const startTime = Date.now();\n    \n    try {\n      // Get page count first using qpdf\n      const pageCountOutput = execFileSync('qpdf', ['--show-npages', filePath], {\n        encoding: 'utf-8',\n        timeout: 60000\n      }).trim();\n      const totalPages = parseInt(pageCountOutput);\n      log(`[PDF Provider] PDF has ${totalPages} pages`);\n      \n      // Create output directory\n      const outputDir = path.join(TEMP_DIR, `split_${Date.now()}_${Math.random().toString(36).slice(2)}`);\n      fs.mkdirSync(outputDir, { recursive: true });\n      \n      const files: string[] = [];\n\n      if (mode === 'all') {\n        // Split into individual pages using qpdf --split-pages (single command, much faster)\n        log(`[PDF Provider] Splitting all ${totalPages} pages using qpdf --split-pages...`);\n        \n        const outputPattern = path.join(outputDir, 'page-%04d.pdf');\n        execFileSync('qpdf', [\n          filePath,\n          '--split-pages',\n          outputPattern\n        ], { \n          timeout: 600000,\n          maxBuffer: 1024 * 1024 * 100\n        });\n        \n        // Read the generated files\n        const generatedFiles = fs.readdirSync(outputDir)\n          .filter(f => f.endsWith('.pdf'))\n          .sort()\n          .map(f => path.join(outputDir, f));\n        \n        files.push(...generatedFiles);\n        log(`[PDF Provider] Split complete - found ${files.length} output files`);\n      } else if (mode === 'range' && ranges) {\n        // Parse range input and validate (e.g., \"1-5, 8, 11-13\")\n        const pagesToExtract: number[] = [];\n        const parts = ranges.split(',').map(p => p.trim());\n\n        for (const part of parts) {\n          if (part.includes('-')) {\n            const [start, end] = part.split('-').map(n => parseInt(n.trim()));\n            if (!isNaN(start) && !isNaN(end)) {\n              for (let i = start; i <= end; i++) {\n                if (i > 0 && i <= totalPages && !pagesToExtract.includes(i)) {\n                  pagesToExtract.push(i);\n                }\n              }\n            }\n          } else {\n            const page = parseInt(part);\n            if (!isNaN(page) && page > 0 && page <= totalPages && !pagesToExtract.includes(page)) {\n              pagesToExtract.push(page);\n            }\n          }\n        }\n\n        // Sort pages\n        pagesToExtract.sort((a, b) => a - b);\n        \n        // Validate: ensure we have pages to extract\n        if (pagesToExtract.length === 0) {\n          throw new Error('No valid pages to extract. Please check your page range.');\n        }\n        \n        log(`[PDF Provider] Extracting ${pagesToExtract.length} pages as individual PDFs using qpdf...`);\n        \n        // Extract each page as a separate PDF file\n        for (let i = 0; i < pagesToExtract.length; i++) {\n          const pageNum = pagesToExtract[i];\n          const outputPath = path.join(outputDir, `page-${String(i + 1).padStart(4, '0')}.pdf`);\n          \n          execFileSync('qpdf', [\n            filePath,\n            '--pages', filePath, pageNum.toString(), '--',\n            outputPath\n          ], { \n            timeout: 600000,\n            maxBuffer: 1024 * 1024 * 100\n          });\n          \n          files.push(outputPath);\n        }\n        \n        const elapsed = Date.now() - startTime;\n        log(`[PDF Provider] Extracted ${pagesToExtract.length} pages into ${files.length} individual PDFs in ${elapsed}ms`);\n        \n        // Return the actual page count for range mode\n        return { outputDir, pageCount: pagesToExtract.length, files };\n      }\n\n      const elapsed = Date.now() - startTime;\n      log(`[PDF Provider] qpdf split complete - ${files.length} pages extracted in ${elapsed}ms`);\n\n      return { outputDir, pageCount: files.length, files };\n    } catch (error: any) {\n      log(`Error in qpdf split: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Compress PDF file using Ghostscript\n   * Levels:\n   * - extreme: Maximum compression, lower image quality (screen quality)\n   * - recommended: Balanced compression with good quality (ebook quality)\n   * - less: Light compression, high quality preserved (printer quality)\n   */\n  async compressPDF(filePath: string, level: 'extreme' | 'recommended' | 'less'): Promise<{ buffer: Buffer; originalSize: number; compressedSize: number }> {\n    log(`[PDF Provider] Compressing PDF using Ghostscript, level: ${level}`);\n    \n    return this.ghostscriptCompress(filePath, level);\n  }\n\n  /**\n   * Ghostscript PDF compression\n   * Uses different PDFSETTINGS presets for different quality levels\n   */\n  private async ghostscriptCompress(filePath: string, level: 'extreme' | 'recommended' | 'less'): Promise<{ buffer: Buffer; originalSize: number; compressedSize: number }> {\n    const startTime = Date.now();\n    \n    // Get original file size\n    const originalSize = fs.statSync(filePath).size;\n    log(`[PDF Provider] Original file size: ${(originalSize / 1024 / 1024).toFixed(2)} MB`);\n    \n    // Map compression levels to Ghostscript PDFSETTINGS\n    // /screen = 72 dpi (smallest file, lowest quality)\n    // /ebook = 150 dpi (good for on-screen viewing)\n    // /printer = 300 dpi (high quality for printing)\n    // /prepress = 300 dpi color preserving (highest quality)\n    const pdfSettings: Record<string, string> = {\n      extreme: '/screen',      // Maximum compression, lowest quality\n      recommended: '/ebook',   // Balanced compression\n      less: '/printer'         // Light compression, high quality\n    };\n    \n    const setting = pdfSettings[level] || '/ebook';\n    \n    const outputPath = path.join(TEMP_DIR, `compressed_${Date.now()}_${Math.random().toString(36).slice(2)}.pdf`);\n    \n    try {\n      // Ghostscript command for PDF compression\n      const args = [\n        '-sDEVICE=pdfwrite',\n        '-dCompatibilityLevel=1.4',\n        `-dPDFSETTINGS=${setting}`,\n        '-dNOPAUSE',\n        '-dQUIET',\n        '-dBATCH',\n        '-dDetectDuplicateImages=true',\n        '-dCompressFonts=true',\n        '-dSubsetFonts=true',\n        `-sOutputFile=${outputPath}`,\n        filePath\n      ];\n      \n      // Add extra optimization for extreme compression\n      if (level === 'extreme') {\n        args.splice(3, 0, \n          '-dColorImageResolution=72',\n          '-dGrayImageResolution=72',\n          '-dMonoImageResolution=72',\n          '-dDownsampleColorImages=true',\n          '-dDownsampleGrayImages=true',\n          '-dDownsampleMonoImages=true'\n        );\n      }\n      \n      log(`[PDF Provider] Executing Ghostscript compression (${level})...`);\n      execFileSync('gs', args, {\n        maxBuffer: 1024 * 1024 * 200, // 200MB buffer\n        timeout: 600000 // 10 minute timeout\n      });\n      \n      // Read compressed file\n      const compressedBuffer = fs.readFileSync(outputPath);\n      const compressedSize = compressedBuffer.length;\n      \n      // Cleanup\n      try {\n        fs.unlinkSync(outputPath);\n      } catch (cleanupError) {\n        log(`[PDF Provider] Cleanup warning: ${cleanupError}`);\n      }\n      \n      const elapsed = Date.now() - startTime;\n      const reductionPercent = ((1 - compressedSize / originalSize) * 100).toFixed(1);\n      \n      log(`[PDF Provider] Ghostscript compression complete in ${elapsed}ms`);\n      log(`[PDF Provider] Size: ${(originalSize / 1024 / 1024).toFixed(2)} MB → ${(compressedSize / 1024 / 1024).toFixed(2)} MB (${reductionPercent}% reduction)`);\n      \n      return {\n        buffer: compressedBuffer,\n        originalSize,\n        compressedSize\n      };\n    } catch (error: any) {\n      // Cleanup on error\n      try {\n        if (fs.existsSync(outputPath)) {\n          fs.unlinkSync(outputPath);\n        }\n      } catch (cleanupError) {}\n      \n      log(`[PDF Provider] Ghostscript error: ${error.message}`);\n      throw new Error(`PDF compression failed: ${error.message}`);\n    }\n  }\n\n  /**\n   * Protect PDF with password using qpdf encryption\n   */\n  async protectPDF(filePath: string, password: string): Promise<Buffer> {\n    log(`[PDF Provider] Protecting PDF with password encryption`);\n\n    // Always use local qpdf for password protection (fast and free)\n    return this.qpdfProtect(filePath, password);\n  }\n\n  /**\n   * Encrypt PDF with password using qpdf\n   * Uses AES-256 encryption for maximum security\n   */\n  private async qpdfProtect(filePath: string, password: string): Promise<Buffer> {\n    const startTime = Date.now();\n    \n    const outputPath = path.join(TEMP_DIR, `protected_${Date.now()}_${Math.random().toString(36).slice(2)}.pdf`);\n    \n    try {\n      log(`[PDF Provider] Encrypting PDF with qpdf (AES-256)...`);\n      \n      // qpdf --encrypt user-password owner-password key-length -- input.pdf output.pdf\n      // user-password: Required to open the PDF\n      // owner-password: Required for full permissions (we use the same password)\n      // 256: AES-256 encryption (strongest available)\n      execFileSync('qpdf', [\n        '--encrypt', password, password, '256',\n        '--',\n        filePath,\n        outputPath\n      ], { \n        timeout: 120000,\n        maxBuffer: 1024 * 1024 * 100\n      });\n      \n      const resultBuffer = fs.readFileSync(outputPath);\n      \n      // Cleanup\n      try {\n        fs.unlinkSync(outputPath);\n      } catch (e) {}\n      \n      const elapsed = Date.now() - startTime;\n      log(`[PDF Provider] PDF encrypted successfully in ${elapsed}ms`);\n      \n      return resultBuffer;\n    } catch (error: any) {\n      // Cleanup on error\n      try {\n        if (fs.existsSync(outputPath)) {\n          fs.unlinkSync(outputPath);\n        }\n      } catch (e) {}\n      \n      log(`[PDF Provider] Error encrypting PDF: ${error.message}`);\n      throw new Error(`Failed to encrypt PDF: ${error.message}`);\n    }\n  }\n\n  /**\n   * Unlock/Decrypt a password-protected PDF\n   */\n  async unlockPDF(filePath: string, password: string): Promise<Buffer> {\n    log(`[PDF Provider] Unlocking password-protected PDF`);\n\n    // Always use local qpdf for decryption (fast and free)\n    return this.qpdfUnlock(filePath, password);\n  }\n\n  /**\n   * Use qpdf to decrypt a password-protected PDF\n   */\n  private async qpdfUnlock(filePath: string, password: string): Promise<Buffer> {\n    const startTime = Date.now();\n    \n    const outputPath = path.join(TEMP_DIR, `unlocked_${Date.now()}_${Math.random().toString(36).slice(2)}.pdf`);\n    \n    try {\n      log(`[PDF Provider] Decrypting PDF with qpdf...`);\n      \n      // qpdf --password=password --decrypt input.pdf output.pdf\n      execFileSync('qpdf', [\n        `--password=${password}`,\n        '--decrypt',\n        filePath,\n        outputPath\n      ], { \n        timeout: 120000,\n        maxBuffer: 1024 * 1024 * 100\n      });\n      \n      const resultBuffer = fs.readFileSync(outputPath);\n      \n      // Cleanup\n      try {\n        fs.unlinkSync(outputPath);\n      } catch (e) {}\n      \n      const elapsed = Date.now() - startTime;\n      log(`[PDF Provider] PDF decrypted successfully in ${elapsed}ms`);\n      \n      return resultBuffer;\n    } catch (error: any) {\n      // Cleanup on error\n      try {\n        if (fs.existsSync(outputPath)) {\n          fs.unlinkSync(outputPath);\n        }\n      } catch (e) {}\n      \n      // Convert error to string for checking (stderr may contain password info)\n      const errorStr = (error.stderr?.toString() || error.message || '').toLowerCase();\n      \n      // Check for wrong password error - don't log actual error as it may contain password\n      if (errorStr.includes('invalid password') || \n          errorStr.includes('password is incorrect') || \n          errorStr.includes('incorrect password') ||\n          errorStr.includes('password needed') ||\n          errorStr.includes('password required')) {\n        log(`[PDF Provider] Unlock failed: invalid password provided`);\n        throw { type: 'INVALID_PASSWORD', message: 'Invalid password. Please check and try again.' };\n      }\n      \n      // For other errors, log generic message without exposing details\n      log(`[PDF Provider] Unlock failed: PDF decryption error`);\n      throw { type: 'DECRYPT_ERROR', message: 'Failed to decrypt PDF. The file may be corrupted or not password-protected.' };\n    }\n  }\n\n  /**\n   * Convert PDF to Word\n   */\n  async pdfToWord(filePath: string): Promise<Buffer> {\n    log(`[PDF Provider] Converting PDF to Word using ${this.config.provider}`);\n\n    if (this.config.provider === 'mock') {\n      return this.mockOperation(filePath, 'converted');\n    }\n\n    if (this.config.provider === 'ilovepdf') {\n      return this.ilovePDFPdfToWord(filePath);\n    }\n\n    throw new Error(`Provider ${this.config.provider} not implemented for PDF to Word`);\n  }\n\n  // ============================================================================\n  // ILOVEPDF API IMPLEMENTATIONS\n  // ============================================================================\n\n  private async ilovePDFMerge(filePaths: string[]): Promise<Buffer> {\n    // ILovePDF API workflow:\n    // 1. Get auth token\n    // 2. Start task\n    // 3. Upload files\n    // 4. Process task\n    // 5. Download result\n\n    const authToken = await this.ilovePDFAuth();\n    const taskId = await this.ilovePDFStartTask(authToken, 'merge');\n    \n    // Upload all files\n    for (const filePath of filePaths) {\n      await this.ilovePDFUploadFile(authToken, taskId, filePath);\n    }\n\n    // Process\n    await this.ilovePDFProcess(authToken, taskId, 'merge', {});\n\n    // Download\n    return await this.ilovePDFDownload(authToken, taskId);\n  }\n\n  private async ilovePDFSplit(filePath: string, mode: string, ranges?: string): Promise<Buffer[]> {\n    const authToken = await this.ilovePDFAuth();\n    const taskId = await this.ilovePDFStartTask(authToken, 'split');\n    \n    await this.ilovePDFUploadFile(authToken, taskId, filePath);\n    \n    const params = mode === 'all' ? { split_mode: 'pages' } : { split_mode: 'ranges', ranges };\n    await this.ilovePDFProcess(authToken, taskId, 'split', params);\n\n    const result = await this.ilovePDFDownload(authToken, taskId);\n    return [result]; // Simplified - real implementation would return multiple files\n  }\n\n  private async ilovePDFCompress(filePath: string, level: string): Promise<Buffer> {\n    const authToken = await this.ilovePDFAuth();\n    const taskId = await this.ilovePDFStartTask(authToken, 'compress');\n    \n    await this.ilovePDFUploadFile(authToken, taskId, filePath);\n    \n    const compressionLevel = level === 'extreme' ? 'extreme' : level === 'recommended' ? 'recommended' : 'low';\n    await this.ilovePDFProcess(authToken, taskId, 'compress', { compression_level: compressionLevel });\n\n    return await this.ilovePDFDownload(authToken, taskId);\n  }\n\n  private async ilovePDFProtect(filePath: string, password: string): Promise<Buffer> {\n    const authToken = await this.ilovePDFAuth();\n    const taskId = await this.ilovePDFStartTask(authToken, 'protect');\n    \n    await this.ilovePDFUploadFile(authToken, taskId, filePath);\n    \n    await this.ilovePDFProcess(authToken, taskId, 'protect', { password });\n\n    return await this.ilovePDFDownload(authToken, taskId);\n  }\n\n  private async ilovePDFPdfToWord(filePath: string): Promise<Buffer> {\n    const authToken = await this.ilovePDFAuth();\n    const taskId = await this.ilovePDFStartTask(authToken, 'pdftodocx');\n    \n    await this.ilovePDFUploadFile(authToken, taskId, filePath);\n    \n    await this.ilovePDFProcess(authToken, taskId, 'pdftodocx', {});\n\n    return await this.ilovePDFDownload(authToken, taskId);\n  }\n\n  // ILovePDF Helper Methods\n\n  private async ilovePDFAuth(): Promise<string> {\n    if (!this.config.apiKey) {\n      throw new Error('ILovePDF API key not configured');\n    }\n\n    const response = await axios.post('https://api.ilovepdf.com/v1/auth', {\n      public_key: this.config.apiKey,\n    });\n\n    return response.data.token;\n  }\n\n  private async ilovePDFStartTask(token: string, tool: string): Promise<string> {\n    const response = await axios.get(`https://api.ilovepdf.com/v1/start/${tool}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n\n    return response.data.server;\n  }\n\n  private async ilovePDFUploadFile(token: string, server: string, filePath: string): Promise<void> {\n    const formData = new FormData();\n    formData.append('task', server);\n    formData.append('file', fs.createReadStream(filePath));\n\n    await axios.post(`https://${server}/v1/upload`, formData, {\n      headers: {\n        ...formData.getHeaders(),\n        Authorization: `Bearer ${token}`,\n      },\n    });\n  }\n\n  private async ilovePDFProcess(token: string, server: string, tool: string, params: any): Promise<void> {\n    await axios.post(\n      `https://${server}/v1/process`,\n      { task: server, tool, ...params },\n      { headers: { Authorization: `Bearer ${token}` } }\n    );\n  }\n\n  private async ilovePDFDownload(token: string, server: string): Promise<Buffer> {\n    const response = await axios.get(`https://${server}/v1/download`, {\n      headers: { Authorization: `Bearer ${token}` },\n      responseType: 'arraybuffer',\n    });\n\n    return Buffer.from(response.data);\n  }\n\n  // ============================================================================\n  // MOCK OPERATIONS (for testing without API keys)\n  // ============================================================================\n\n  private async mockOperation(filePath: string, operation: string): Promise<Buffer> {\n    log(`[PDF Provider] MOCK ${operation} - returning original file`);\n    return fs.readFileSync(filePath);\n  }\n}\n\n// Factory function\nexport function createPDFProvider(): PDFProvider {\n  const provider = (process.env.PDF_PROVIDER || 'mock') as PDFProviderConfig['provider'];\n  const apiKey = process.env.PDF_API_KEY;\n  const apiSecret = process.env.PDF_API_SECRET;\n\n  return new PDFProvider({\n    provider,\n    apiKey,\n    apiSecret,\n  });\n}\n","path":null,"size_bytes":34700,"size_tokens":null},"PDF_PROVIDER_SETUP.md":{"content":"# PDF Provider Setup Guide\n\nYour application is now configured to work with external PDF processing APIs. The backend acts as a secure proxy that protects your API keys and handles CORS restrictions.\n\n## Supported Providers\n\nCurrently supported PDF service providers:\n\n1. **ILovePDF** (Recommended) - https://developer.ilovepdf.com/\n2. **PDF.co** - https://pdf.co/\n3. **CloudConvert** - https://cloudconvert.com/\n4. **Mock** (Default) - For testing without API keys\n\n## Quick Start (Mock Mode)\n\nBy default, the application runs in **mock mode** which returns the original uploaded file without processing. This is useful for testing the UI and workflow.\n\nNo configuration needed - just use the app!\n\n## Production Setup\n\n### Option 1: ILovePDF (Recommended)\n\n1. Sign up at https://developer.ilovepdf.com/\n2. Get your API **Public Key** from the dashboard\n3. Set environment variables:\n   - `PDF_PROVIDER=ilovepdf`\n   - `PDF_API_KEY=your_public_key_here`\n\n### Option 2: PDF.co\n\n1. Sign up at https://pdf.co/\n2. Get your API key from the dashboard\n3. Set environment variables:\n   - `PDF_PROVIDER=pdfco`\n   - `PDF_API_KEY=your_api_key_here`\n\n### Option 3: CloudConvert\n\n1. Sign up at https://cloudconvert.com/\n2. Get your API key\n3. Set environment variables:\n   - `PDF_PROVIDER=cloudconvert`\n   - `PDF_API_KEY=your_api_key_here`\n\n## Setting Environment Variables in Replit\n\nYou can set environment variables through:\n\n1. **Replit Secrets Tab** (Recommended for API keys)\n   - Click on \"Secrets\" in the left sidebar\n   - Add `PDF_PROVIDER` and `PDF_API_KEY`\n\n2. **Direct Environment Variables**\n   - The agent can set them for you using the environment variable tools\n\n## Features by Provider\n\n| Feature | Mock | ILovePDF | PDF.co | CloudConvert |\n|---------|------|----------|--------|--------------|\n| Merge PDFs | ✓ | ✓ | ✓ | ✓ |\n| Split PDFs | ✓ | ✓ | ✓ | ✓ |\n| Compress | ✓ | ✓ | ✓ | ✓ |\n| Protect | ✓ | ✓ | ✓ | ✓ |\n| PDF to Word | ✓ | ✓ | ✓ | ✓ |\n\n**Note:** Mock mode returns the original file unchanged - useful for UI testing only.\n\n## Cost Considerations\n\n- **ILovePDF**: Free tier available, pay-per-use\n- **PDF.co**: Free tier with 100 credits/month\n- **CloudConvert**: Pay per conversion\n\n## Extending Support\n\nTo add support for a new PDF provider, edit `server/pdf-provider.ts` and implement the provider-specific methods following the existing pattern.\n\n## Troubleshooting\n\n- **\"Provider not configured\" error**: Make sure `PDF_PROVIDER` and `PDF_API_KEY` environment variables are set\n- **API errors**: Check your API key and provider account status\n- **Files not processing**: Verify you're not in mock mode if you expect real processing\n","path":null,"size_bytes":2693,"size_tokens":null},"vite-plugin-meta-images.ts":{"content":"import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\n/**\n * Vite plugin that updates og:image and twitter:image meta tags\n * to point to the app's opengraph image with the correct Replit domain.\n */\nexport function metaImagesPlugin(): Plugin {\n  return {\n    name: 'vite-plugin-meta-images',\n    transformIndexHtml(html) {\n      const baseUrl = getDeploymentUrl();\n      if (!baseUrl) {\n        log('[meta-images] no Replit deployment domain found, skipping meta tag updates');\n        return html;\n      }\n\n      // Check if opengraph image exists in public directory\n      const publicDir = path.resolve(process.cwd(), 'client', 'public');\n      const opengraphPngPath = path.join(publicDir, 'opengraph.png');\n      const opengraphJpgPath = path.join(publicDir, 'opengraph.jpg');\n      const opengraphJpegPath = path.join(publicDir, 'opengraph.jpeg');\n\n      let imageExt: string | null = null;\n      if (fs.existsSync(opengraphPngPath)) {\n        imageExt = 'png';\n      } else if (fs.existsSync(opengraphJpgPath)) {\n        imageExt = 'jpg';\n      } else if (fs.existsSync(opengraphJpegPath)) {\n        imageExt = 'jpeg';\n      }\n\n      if (!imageExt) {\n        log('[meta-images] OpenGraph image not found, skipping meta tag updates');\n        return html;\n      }\n\n      const imageUrl = `${baseUrl}/opengraph.${imageExt}`;\n\n      log('[meta-images] updating meta image tags to:', imageUrl);\n\n      html = html.replace(\n        /<meta\\s+property=\"og:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta property=\"og:image\" content=\"${imageUrl}\" />`\n      );\n\n      html = html.replace(\n        /<meta\\s+name=\"twitter:image\"\\s+content=\"[^\"]*\"\\s*\\/>/g,\n        `<meta name=\"twitter:image\" content=\"${imageUrl}\" />`\n      );\n\n      return html;\n    },\n  };\n}\n\nfunction getDeploymentUrl(): string | null {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    log('[meta-images] using internal app domain:', url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    log('[meta-images] using dev domain:', url);\n    return url;\n  }\n\n  return null;\n}\n\nfunction log(...args: any[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    console.log(...args);\n  }\n}\n","path":null,"size_bytes":2333,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogClose,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3835,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/SelectedPagesPreview.tsx":{"content":"import { useState, useEffect, useRef, useCallback, memo } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport { Loader2, Check, AlertCircle } from 'lucide-react';\nimport { useLanguage } from '@/lib/i18n';\nimport { cn } from '@/lib/utils';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface SelectedPagesPreviewProps {\n  file: File;\n  selectedPages: number[];\n  mode: 'extract' | 'remove';\n  onValidationChange?: (isValid: boolean, totalPages: number) => void;\n}\n\ninterface PagePreview {\n  pageNum: number;\n  imageUrl: string | null;\n  isLoading: boolean;\n  isValid: boolean;\n}\n\nconst PreviewThumbnail = memo(({ \n  pageNum, \n  imageUrl, \n  isLoading, \n  isValid,\n  mode\n}: { \n  pageNum: number; \n  imageUrl: string | null; \n  isLoading: boolean;\n  isValid: boolean;\n  mode: 'extract' | 'remove';\n}) => {\n  const { language } = useLanguage();\n  const borderColor = mode === 'remove' ? 'border-red-500' : 'border-primary';\n  const bgColor = mode === 'remove' ? 'bg-red-500' : 'bg-primary';\n  \n  return (\n    <div\n      className={cn(\n        \"relative rounded-lg overflow-hidden border-2 transition-all duration-200 shadow-sm\",\n        isValid ? borderColor : \"border-red-400 opacity-60\"\n      )}\n    >\n      <div className=\"aspect-[3/4] bg-secondary/30 flex items-center justify-center\" style={{ minWidth: '80px', maxWidth: '120px' }}>\n        {isLoading ? (\n          <Loader2 className=\"w-5 h-5 animate-spin text-muted-foreground\" />\n        ) : !isValid ? (\n          <div className=\"flex flex-col items-center justify-center p-2 text-center\">\n            <AlertCircle className=\"w-6 h-6 text-red-400 mb-1\" />\n            <span className=\"text-xs text-red-400\">\n              {language === 'ar' ? 'غير موجودة' : 'Not found'}\n            </span>\n          </div>\n        ) : imageUrl ? (\n          <img \n            src={imageUrl} \n            alt={`Page ${pageNum}`}\n            className=\"w-full h-full object-contain\"\n          />\n        ) : (\n          <div className=\"text-muted-foreground text-xs p-2 text-center\">\n            {language === 'ar' ? `صفحة ${pageNum}` : `Page ${pageNum}`}\n          </div>\n        )}\n      </div>\n      \n      <div className={cn(\n        \"absolute bottom-0 inset-x-0 py-1 px-1.5 text-center text-xs font-medium\",\n        isValid ? `${bgColor} text-white` : \"bg-red-400 text-white\"\n      )}>\n        {pageNum}\n      </div>\n      \n      {isValid && (\n        <div className={cn(\n          \"absolute top-1 end-1 rounded-full p-0.5 shadow-sm\",\n          bgColor, \"text-white\"\n        )}>\n          <Check className=\"w-3 h-3\" />\n        </div>\n      )}\n    </div>\n  );\n});\n\nPreviewThumbnail.displayName = 'PreviewThumbnail';\n\nexport function SelectedPagesPreview({ \n  file, \n  selectedPages,\n  mode,\n  onValidationChange\n}: SelectedPagesPreviewProps) {\n  const { language } = useLanguage();\n  const [previews, setPreviews] = useState<PagePreview[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [totalPages, setTotalPages] = useState(0);\n  const pdfDocRef = useRef<pdfjsLib.PDFDocumentProxy | null>(null);\n  const imageUrlsRef = useRef<string[]>([]);\n\n  const sortedPages = [...selectedPages].sort((a, b) => a - b);\n\n  const renderPage = useCallback(async (doc: pdfjsLib.PDFDocumentProxy, pageNum: number): Promise<string> => {\n    const page = await doc.getPage(pageNum);\n    const scale = 0.3;\n    const viewport = page.getViewport({ scale });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    if (!context) throw new Error('Canvas context not available');\n    \n    canvas.height = viewport.height;\n    canvas.width = viewport.width;\n    \n    await page.render({ canvasContext: context, viewport, canvas } as any).promise;\n    \n    return new Promise((resolve) => {\n      canvas.toBlob((blob) => {\n        if (blob) {\n          const url = URL.createObjectURL(blob);\n          imageUrlsRef.current.push(url);\n          resolve(url);\n        } else {\n          resolve('');\n        }\n      }, 'image/jpeg', 0.7);\n    });\n  }, []);\n\n  useEffect(() => {\n    if (sortedPages.length > 0 && onValidationChange) {\n      const hasInvalidPage = sortedPages.some(p => p <= 0);\n      if (!hasInvalidPage) {\n        onValidationChange(true, totalPages);\n      }\n    } else if (sortedPages.length === 0 && onValidationChange) {\n      onValidationChange(false, totalPages);\n    }\n  }, [sortedPages.join(','), onValidationChange, totalPages]);\n\n  useEffect(() => {\n    if (!file || sortedPages.length === 0) {\n      setPreviews([]);\n      setIsLoading(false);\n      return;\n    }\n\n    let isMounted = true;\n    setIsLoading(true);\n\n    const loadPreviews = async () => {\n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const doc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        \n        if (!isMounted) {\n          doc.destroy();\n          return;\n        }\n        \n        pdfDocRef.current = doc;\n        const numPages = doc.numPages;\n        setTotalPages(numPages);\n\n        const initialPreviews: PagePreview[] = sortedPages.map(pageNum => ({\n          pageNum,\n          imageUrl: null,\n          isLoading: pageNum <= numPages,\n          isValid: pageNum <= numPages && pageNum > 0\n        }));\n        setPreviews(initialPreviews);\n        \n        const validPages = sortedPages.filter(p => p > 0 && p <= numPages);\n        const invalidPages = sortedPages.filter(p => p <= 0 || p > numPages);\n        \n        if (onValidationChange) {\n          onValidationChange(invalidPages.length === 0 && validPages.length > 0, numPages);\n        }\n        \n        setIsLoading(false);\n\n        for (let i = 0; i < validPages.length; i++) {\n          if (!isMounted) break;\n          \n          const pageNum = validPages[i];\n          const imageUrl = await renderPage(doc, pageNum);\n          \n          if (!isMounted) break;\n          \n          setPreviews(prev => {\n            const updated = [...prev];\n            const idx = updated.findIndex(p => p.pageNum === pageNum);\n            if (idx !== -1) {\n              updated[idx] = { ...updated[idx], imageUrl, isLoading: false };\n            }\n            return updated;\n          });\n        }\n      } catch (err) {\n        console.error('Error loading previews:', err);\n        setIsLoading(false);\n        if (onValidationChange) {\n          onValidationChange(false, 0);\n        }\n      }\n    };\n\n    loadPreviews();\n\n    return () => {\n      isMounted = false;\n      imageUrlsRef.current.forEach(url => URL.revokeObjectURL(url));\n      imageUrlsRef.current = [];\n      if (pdfDocRef.current) {\n        pdfDocRef.current.destroy();\n        pdfDocRef.current = null;\n      }\n    };\n  }, [file, sortedPages.join(','), renderPage, onValidationChange]);\n\n  if (sortedPages.length === 0) {\n    return null;\n  }\n\n  const invalidCount = previews.filter(p => !p.isValid).length;\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center justify-between\">\n        <h4 className=\"text-sm font-medium text-muted-foreground\">\n          {mode === 'extract' \n            ? (language === 'ar' ? 'صفحات للاستخراج:' : 'Pages to extract:')\n            : (language === 'ar' ? 'صفحات للحذف:' : 'Pages to remove:')\n          }\n        </h4>\n        {invalidCount > 0 && (\n          <span className=\"text-xs text-red-500 flex items-center gap-1\">\n            <AlertCircle className=\"w-3 h-3\" />\n            {language === 'ar' \n              ? `${invalidCount} صفحة غير صالحة`\n              : `${invalidCount} invalid page${invalidCount > 1 ? 's' : ''}`\n            }\n          </span>\n        )}\n      </div>\n      \n      {isLoading ? (\n        <div className=\"flex items-center gap-2 py-4 justify-center\">\n          <Loader2 className=\"w-5 h-5 animate-spin text-primary\" />\n          <span className=\"text-sm text-muted-foreground\">\n            {language === 'ar' ? 'جاري تحميل المعاينة...' : 'Loading preview...'}\n          </span>\n        </div>\n      ) : (\n        <div className=\"flex flex-wrap gap-3 p-3 bg-secondary/20 rounded-xl border border-border/50\">\n          {previews.map(preview => (\n            <PreviewThumbnail\n              key={preview.pageNum}\n              pageNum={preview.pageNum}\n              imageUrl={preview.imageUrl}\n              isLoading={preview.isLoading}\n              isValid={preview.isValid}\n              mode={mode}\n            />\n          ))}\n        </div>\n      )}\n      \n      {totalPages > 0 && (\n        <p className=\"text-xs text-muted-foreground text-center\">\n          {language === 'ar' \n            ? `الملف يحتوي على ${totalPages} صفحة`\n            : `Document has ${totalPages} pages`\n          }\n        </p>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":8882,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":768,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { execSync } from \"child_process\";\n// @ts-ignore\nimport AdmZip from \"adm-zip\";\nimport archiver from \"archiver\";\nimport puppeteer from \"puppeteer\";\nimport { createPDFProvider } from \"./pdf-provider\";\nimport { log } from \"./index\";\n\n// Use /tmp for faster I/O (tmpfs on Linux)\nconst UPLOADS_DIR = '/tmp/pdf-uploads';\nconst DOWNLOADS_DIR = '/tmp/pdf-downloads';\n\n// Set up multer for file uploads\nconst upload = multer({\n  dest: UPLOADS_DIR,\n  limits: {\n    fileSize: 1024 * 1024 * 1024, // 1GB limit\n  },\n  fileFilter: (_req, file, cb) => {\n    if (file.mimetype === \"application/pdf\" || file.originalname.endsWith(\".pdf\")) {\n      cb(null, true);\n    } else {\n      cb(new Error(\"Only PDF files are allowed\"));\n    }\n  },\n});\n\n// Ensure directories exist\nif (!fs.existsSync(UPLOADS_DIR)) {\n  fs.mkdirSync(UPLOADS_DIR, { recursive: true });\n}\n\nif (!fs.existsSync(DOWNLOADS_DIR)) {\n  fs.mkdirSync(DOWNLOADS_DIR, { recursive: true });\n}\n\nlog(`[Performance] Using temp storage for uploads: ${UPLOADS_DIR}`);\nlog(`[Performance] Using temp storage for downloads: ${DOWNLOADS_DIR}`);\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  const pdfProvider = createPDFProvider();\n\n  // Health check\n  app.get(\"/api/health\", (_req, res) => {\n    res.json({ status: \"ok\", provider: process.env.PDF_PROVIDER || \"mock\" });\n  });\n\n  // Merge PDFs\n  app.post(\"/api/pdf/merge\", upload.array(\"files\", 50), async (req, res) => {\n    try {\n      const files = req.files as Express.Multer.File[];\n      const mode = (req.body?.mode || 'fast') as 'fast' | 'compress';\n      \n      if (!files || files.length < 2) {\n        return res.status(400).json({ error: \"At least 2 PDF files are required\" });\n      }\n\n      log(`Merging ${files.length} PDFs with mode: ${mode}`);\n\n      const filePaths = files.map((f) => f.path);\n      const mergedPDF = await pdfProvider.mergePDFs(filePaths, { compress: mode === 'compress' });\n\n      // Clean up uploaded files\n      filePaths.forEach((fp) => {\n        try {\n          fs.unlinkSync(fp);\n        } catch {}\n      });\n\n      // Save merged PDF to RAM disk for fast access\n      const downloadId = `merge-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n      const downloadPath = path.join(DOWNLOADS_DIR, `${downloadId}.pdf`);\n      \n      try {\n        await fs.promises.writeFile(downloadPath, mergedPDF);\n        log(`Merged PDF saved: ${downloadPath}`);\n      } catch (writeError: any) {\n        log(`Error writing PDF file: ${writeError.message}`);\n        throw new Error(`Failed to save merged PDF: ${writeError.message}`);\n      }\n\n      res.json({\n        success: true,\n        downloadId,\n        downloadUrl: `/api/pdf/download/${downloadId}`,\n        expiresIn: 3600\n      });\n    } catch (error: any) {\n      log(`Error merging PDFs: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Split PDF - uses qpdf for fast splitting\n  app.post(\"/api/pdf/split\", upload.single(\"file\"), async (req, res) => {\n    let outputDir: string | null = null;\n    try {\n      const file = req.file;\n      const mode = (req.body?.mode || req.headers['x-split-mode'] || 'all') as string;\n      const ranges = (req.body?.ranges || req.headers['x-split-ranges'] || '') as string;\n      const downloadFormat = (req.body?.format || req.headers['x-download-format'] || 'combined') as string;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      log(`Splitting PDF with qpdf, mode: ${mode}, ranges: ${ranges}, format: ${downloadFormat}`);\n      const startTime = Date.now();\n\n      // Split PDF using qpdf\n      const result = await pdfProvider.splitPDF(file.path, mode as any, ranges);\n      outputDir = result.outputDir;\n      \n      const splitTime = Date.now() - startTime;\n\n      // Handle format preference for custom range mode\n      if (mode === 'range' && downloadFormat === 'separate' && result.files.length > 1) {\n        // Multiple files for separate format - create ZIP\n        const downloadId = `split-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        const downloadPath = path.join(DOWNLOADS_DIR, `${downloadId}.zip`);\n        \n        // Create ZIP using AdmZip\n        const zip = new AdmZip();\n        for (const filePath of result.files) {\n          const fileName = path.basename(filePath);\n          zip.addLocalFile(filePath, '', fileName);\n        }\n        zip.writeZip(downloadPath);\n        \n        const totalTime = Date.now() - startTime;\n        log(`ZIP created for separate format: ${downloadPath} (${result.pageCount} pages in ${totalTime}ms)`);\n\n        // Return ZIP as direct download instead of link (for custom range)\n        const zipBuffer = fs.readFileSync(downloadPath);\n        res.setHeader(\"Content-Type\", \"application/zip\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=extracted-pages.zip`);\n        res.setHeader(\"X-Processing-Time\", totalTime.toString());\n        res.setHeader(\"X-Page-Count\", result.pageCount.toString());\n        res.setHeader(\"X-Format\", \"separate\");\n        res.send(zipBuffer);\n        \n        // Clean up zip file\n        try {\n          fs.unlinkSync(downloadPath);\n        } catch (e) {}\n      } else if (mode === 'range' && downloadFormat === 'combined' && result.files.length > 1) {\n        // Multiple files but user wants combined - merge them\n        log(`Merging ${result.files.length} extracted pages for combined format`);\n        const mergedPDF = await pdfProvider.mergePDFs(result.files);\n        \n        const totalTime = Date.now() - startTime;\n        log(`Pages merged for combined format (${result.pageCount} pages in ${totalTime}ms)`);\n        \n        res.setHeader(\"Content-Type\", \"application/pdf\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=extracted-pages.pdf`);\n        res.setHeader(\"X-Processing-Time\", totalTime.toString());\n        res.setHeader(\"X-Page-Count\", result.pageCount.toString());\n        res.setHeader(\"X-Format\", \"combined\");\n        res.send(mergedPDF);\n      } else if (result.files.length === 1) {\n        // Single file - return as PDF directly (for range mode or single page)\n        const pdfBuffer = fs.readFileSync(result.files[0]);\n        const filename = mode === 'range' ? 'extracted-pages.pdf' : 'extracted-page.pdf';\n        log(`Returning single PDF: ${filename} (${result.pageCount} pages in ${splitTime}ms)`);\n        \n        res.setHeader(\"Content-Type\", \"application/pdf\");\n        res.setHeader(\"Content-Disposition\", `attachment; filename=${filename}`);\n        res.setHeader(\"X-Processing-Time\", splitTime.toString());\n        res.setHeader(\"X-Page-Count\", result.pageCount.toString());\n        res.setHeader(\"X-Format\", \"combined\");\n        res.send(pdfBuffer);\n      } else {\n        // Multiple files (all pages mode) - create single ZIP on RAM disk with download link\n        const downloadId = `split-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        const downloadPath = path.join(DOWNLOADS_DIR, `${downloadId}.zip`);\n        \n        // Create ZIP using AdmZip\n        const zip = new AdmZip();\n        for (const filePath of result.files) {\n          const fileName = path.basename(filePath);\n          zip.addLocalFile(filePath, '', fileName);\n        }\n        zip.writeZip(downloadPath);\n        \n        const totalTime = Date.now() - startTime;\n        log(`ZIP created: ${downloadPath} (${result.pageCount} pages in ${totalTime}ms)`);\n\n        // Return download link\n        res.json({\n          success: true,\n          downloadId,\n          downloadUrl: `/api/pdf/download/${downloadId}`,\n          pageCount: result.pageCount,\n          processingTime: totalTime,\n          expiresIn: 3600\n        });\n      }\n    } catch (error: any) {\n      log(`Error splitting PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    } finally {\n      // Clean up uploaded file\n      if (req.file) {\n        try {\n          fs.unlinkSync(req.file.path);\n        } catch (e) {}\n      }\n      \n      // Clean up temp directory with split PDFs\n      if (outputDir && fs.existsSync(outputDir)) {\n        try {\n          const files = fs.readdirSync(outputDir);\n          for (const f of files) {\n            fs.unlinkSync(path.join(outputDir, f));\n          }\n          fs.rmdirSync(outputDir);\n          log(`Cleaned up temp directory: ${outputDir}`);\n        } catch (e) {}\n      }\n    }\n  });\n\n  // Download file from RAM disk storage (supports both zip and pdf)\n  app.get(\"/api/pdf/download/:downloadId\", (req, res) => {\n    try {\n      const { downloadId } = req.params;\n      \n      // Try both .zip and .pdf files from RAM disk\n      let downloadPath = path.join(DOWNLOADS_DIR, `${downloadId}.zip`);\n      let fileType = 'zip';\n      let filename = 'split-pages.zip';\n      \n      if (!fs.existsSync(downloadPath)) {\n        downloadPath = path.join(DOWNLOADS_DIR, `${downloadId}.pdf`);\n        fileType = 'pdf';\n        filename = 'merged-document.pdf';\n      }\n      \n      // Validate path to prevent directory traversal\n      if (!downloadPath.startsWith(DOWNLOADS_DIR)) {\n        return res.status(403).json({ error: 'Invalid download ID' });\n      }\n      \n      if (!fs.existsSync(downloadPath)) {\n        return res.status(404).json({ error: 'Download expired or not found' });\n      }\n      \n      log(`Downloading ${fileType}: ${downloadId}`);\n      \n      const contentType = fileType === 'zip' ? 'application/zip' : 'application/pdf';\n      res.setHeader(\"Content-Type\", contentType);\n      res.setHeader(\"Content-Disposition\", `attachment; filename=${filename}`);\n      res.setHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n      \n      const stream = fs.createReadStream(downloadPath);\n      stream.pipe(res);\n      \n      // Delete file after download completes\n      res.on('finish', () => {\n        try {\n          fs.unlinkSync(downloadPath);\n          log(`Deleted download: ${downloadId}`);\n        } catch (e) {}\n      });\n    } catch (error: any) {\n      log(`Error downloading file: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Compress PDF\n  app.post(\"/api/pdf/compress\", upload.single(\"file\"), async (req, res) => {\n    const file = req.file;\n    try {\n      const { level } = req.body;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      const startTime = Date.now();\n      log(`Compressing PDF, level: ${level}`);\n\n      const result = await pdfProvider.compressPDF(file.path, level || \"recommended\");\n      \n      const elapsed = Date.now() - startTime;\n      const reductionPercent = ((1 - result.compressedSize / result.originalSize) * 100).toFixed(1);\n      \n      log(`Compression complete: ${(result.originalSize / 1024 / 1024).toFixed(2)} MB → ${(result.compressedSize / 1024 / 1024).toFixed(2)} MB (${reductionPercent}% reduction) in ${elapsed}ms`);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=compressed.pdf\");\n      res.setHeader(\"X-Original-Size\", result.originalSize.toString());\n      res.setHeader(\"X-Compressed-Size\", result.compressedSize.toString());\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(result.buffer);\n    } catch (error: any) {\n      log(`Error compressing PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    } finally {\n      if (file?.path) {\n        try { fs.unlinkSync(file.path); } catch (e) {}\n      }\n    }\n  });\n\n  // Protect PDF\n  app.post(\"/api/pdf/protect\", upload.single(\"file\"), async (req, res) => {\n    try {\n      const file = req.file;\n      const { password } = req.body;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      if (!password) {\n        return res.status(400).json({ error: \"Password is required\" });\n      }\n\n      log(`Protecting PDF with password`);\n\n      const protectedPDF = await pdfProvider.protectPDF(file.path, password);\n\n      // Clean up uploaded file\n      fs.unlinkSync(file.path);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=protected.pdf\");\n      res.send(protectedPDF);\n    } catch (error: any) {\n      log(`Error protecting PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Unlock/Decrypt PDF\n  app.post(\"/api/pdf/unlock\", upload.single(\"file\"), async (req, res) => {\n    const file = req.file;\n    try {\n      const { password } = req.body;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      if (!password) {\n        return res.status(400).json({ error: \"Password is required\" });\n      }\n\n      log(`Unlocking password-protected PDF`);\n\n      const unlockedPDF = await pdfProvider.unlockPDF(file.path, password);\n\n      // Clean up uploaded file\n      try { fs.unlinkSync(file.path); } catch {}\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=unlocked.pdf\");\n      res.send(unlockedPDF);\n    } catch (error: any) {\n      // Clean up uploaded file on error\n      if (file?.path) {\n        try { fs.unlinkSync(file.path); } catch {}\n      }\n      \n      // Handle typed errors from provider\n      if (error.type === 'INVALID_PASSWORD') {\n        log(`Unlock failed: invalid password`);\n        return res.status(400).json({ error: error.message });\n      }\n      \n      // Generic error - don't expose internal details\n      log(`Unlock failed: decryption error`);\n      res.status(500).json({ error: error.message || 'Failed to unlock PDF' });\n    }\n  });\n\n  // Remove Pages from PDF\n  app.post(\"/api/pdf/remove-pages\", upload.single(\"file\"), async (req, res) => {\n    const file = req.file;\n    try {\n      const { pages } = req.body;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      if (!pages || !pages.trim()) {\n        return res.status(400).json({ error: \"Pages to remove are required\" });\n      }\n\n      const startTime = Date.now();\n      log(`Removing pages from PDF: ${pages}`);\n\n      const result = await pdfProvider.removePages(file.path, pages);\n      \n      const elapsed = Date.now() - startTime;\n      log(`Removed ${result.removedCount} pages in ${elapsed}ms (${result.originalPageCount} → ${result.finalPageCount} pages)`);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=pages-removed.pdf\");\n      res.setHeader(\"X-Original-Page-Count\", result.originalPageCount.toString());\n      res.setHeader(\"X-Removed-Count\", result.removedCount.toString());\n      res.setHeader(\"X-Final-Page-Count\", result.finalPageCount.toString());\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(result.buffer);\n    } catch (error: any) {\n      log(`Error removing pages: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    } finally {\n      if (file?.path) {\n        try { fs.unlinkSync(file.path); } catch (e) {}\n      }\n    }\n  });\n\n  // Rotate Pages in PDF\n  app.post(\"/api/pdf/rotate\", upload.single(\"file\"), async (req, res) => {\n    const file = req.file;\n    try {\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      // Support both old format (pages + angle) and new format (pageRotations)\n      let result;\n      const startTime = Date.now();\n      \n      if (req.body.pageRotations) {\n        // Per-page rotation format\n        const pageRotations = JSON.parse(req.body.pageRotations);\n        log(`Rotating pages with per-page angles`);\n        result = await pdfProvider.rotatePagesPerPage(file.path, pageRotations);\n      } else {\n        // Legacy format\n        const { pages, angle } = req.body;\n        if (!pages || !pages.trim()) {\n          return res.status(400).json({ error: \"Pages to rotate are required\" });\n        }\n        const rotationAngle = parseInt(angle) || 90;\n        if (![0, 90, 180, 270].includes(rotationAngle)) {\n          return res.status(400).json({ error: \"Rotation angle must be 0, 90, 180, or 270 degrees\" });\n        }\n        log(`Rotating pages in PDF: ${pages} by ${rotationAngle}°`);\n        result = await pdfProvider.rotatePages(file.path, pages, rotationAngle);\n      }\n      \n      const elapsed = Date.now() - startTime;\n      log(`Rotated ${result.rotatedCount} pages in ${elapsed}ms`);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=rotated.pdf\");\n      res.setHeader(\"X-Total-Pages\", result.totalPages.toString());\n      res.setHeader(\"X-Rotated-Count\", result.rotatedCount.toString());\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(result.buffer);\n    } catch (error: any) {\n      log(`Error rotating pages: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    } finally {\n      if (file?.path) {\n        try { fs.unlinkSync(file.path); } catch (e) {}\n      }\n    }\n  });\n\n  // Organize PDF pages\n  app.post(\"/api/pdf/organize\", upload.single(\"file\"), async (req, res) => {\n    const file = req.file;\n    try {\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      const pageOrderStr = req.body.pageOrder;\n      if (!pageOrderStr) {\n        return res.status(400).json({ error: \"Page order is required\" });\n      }\n\n      const pageOrder = JSON.parse(pageOrderStr);\n      if (!Array.isArray(pageOrder) || pageOrder.length === 0) {\n        return res.status(400).json({ error: \"Invalid page order format\" });\n      }\n\n      const startTime = Date.now();\n      log(`Organizing PDF pages to order: ${pageOrder.join(', ')}`);\n\n      const result = await pdfProvider.organizePages(file.path, pageOrder);\n      \n      const elapsed = Date.now() - startTime;\n      log(`Organized ${result.totalPages} pages in ${elapsed}ms`);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=organized.pdf\");\n      res.setHeader(\"X-Total-Pages\", result.totalPages.toString());\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(result.buffer);\n    } catch (error: any) {\n      log(`Error organizing PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    } finally {\n      if (file?.path) {\n        try { fs.unlinkSync(file.path); } catch (e) {}\n      }\n    }\n  });\n\n  // PDF to Word\n  app.post(\"/api/pdf/to-word\", upload.single(\"file\"), async (req, res) => {\n    try {\n      const file = req.file;\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      log(`Converting PDF to Word`);\n\n      const wordDoc = await pdfProvider.pdfToWord(file.path);\n\n      // Clean up uploaded file\n      fs.unlinkSync(file.path);\n\n      res.setHeader(\"Content-Type\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=converted.docx\");\n      res.send(wordDoc);\n    } catch (error: any) {\n      log(`Error converting PDF to Word: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // HTML to PDF - Convert HTML content to PDF using Puppeteer\n  app.post(\"/api/pdf/from-html\", async (req, res) => {\n    let browser = null;\n    try {\n      let { \n        type, // 'html' or 'url'\n        content, // HTML code or URL\n        pageSize = 'A4',\n        orientation = 'portrait',\n        margins = 'normal',\n        includeBackground = true\n      } = req.body;\n\n      if (!type || !content) {\n        return res.status(400).json({ error: \"Type and content are required\" });\n      }\n\n      // If URL, navigate to it; otherwise use HTML content\n      const startTime = Date.now();\n      log(`Converting ${type} to PDF (size: ${pageSize}, orientation: ${orientation})`);\n\n      // Launch Puppeteer browser\n      browser = await puppeteer.launch({\n        headless: true,\n        args: [\n          '--no-sandbox',\n          '--disable-setuid-sandbox',\n          '--disable-dev-shm-usage',\n          '--disable-gpu',\n          '--single-process'\n        ]\n      });\n\n      const page = await browser.newPage();\n\n      // Set page size mapping\n      const pageSizeMap: any = {\n        'A4': 'A4',\n        'A3': 'A3',\n        'Letter': 'Letter',\n        'Legal': 'Legal',\n        'Tabloid': 'Tabloid'\n      };\n\n      // Set margins mapping in mm (Puppeteer uses mm by default)\n      const marginMap: any = {\n        'none': { top: 5, bottom: 5, left: 5, right: 5 },\n        'normal': { top: 10, bottom: 10, left: 10, right: 10 },\n        'wide': { top: 25, bottom: 25, left: 25, right: 25 }\n      };\n\n      if (type === 'url') {\n        // Navigate to URL\n        await page.goto(content, { waitUntil: 'networkidle2', timeout: 30000 });\n      } else {\n        // Set HTML content\n        await page.setContent(content, { waitUntil: 'networkidle0', timeout: 30000 });\n      }\n\n      // Generate PDF\n      const pdfBuffer = await page.pdf({\n        format: pageSizeMap[pageSize] || 'A4',\n        landscape: orientation === 'landscape',\n        margin: marginMap[margins] || marginMap['normal'],\n        printBackground: includeBackground\n      });\n\n      await browser.close();\n      browser = null;\n\n      const elapsed = Date.now() - startTime;\n      log(`PDF generated from ${type} in ${elapsed}ms (${(pdfBuffer.length / 1024).toFixed(1)} KB)`);\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=converted.pdf\");\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(Buffer.from(pdfBuffer));\n    } catch (error: any) {\n      if (browser) {\n        try { await browser.close(); } catch {}\n      }\n      log(`Error converting HTML to PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Repair PDF - Fix corrupted or damaged PDFs using qpdf and Ghostscript\n  app.post(\"/api/pdf/repair\", upload.single(\"file\"), async (req, res) => {\n    let outputPath: string | null = null;\n    try {\n      const file = req.file;\n      const method = (req.body?.method || 'auto') as 'auto' | 'quick' | 'deep';\n\n      if (!file) {\n        return res.status(400).json({ error: \"PDF file is required\" });\n      }\n\n      log(`Repairing PDF with method: ${method}`);\n      const startTime = Date.now();\n\n      const downloadId = `repair-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n      outputPath = path.join(DOWNLOADS_DIR, `${downloadId}.pdf`);\n\n      let repairSuccess = false;\n      let usedMethod = '';\n\n      // Helper to run command and capture output\n      const runRepairCommand = (cmd: string, timeout: number = 60000): { success: boolean; output: string } => {\n        try {\n          const output = execSync(cmd, { timeout, encoding: 'utf8', stdio: ['pipe', 'pipe', 'pipe'] });\n          return { success: true, output };\n        } catch (err: any) {\n          return { success: false, output: err.stderr || err.stdout || err.message };\n        }\n      };\n\n      // Try quick repair with qpdf first (if auto or quick)\n      if (method === 'auto' || method === 'quick') {\n        // Method 1: qpdf with linearize (basic repair)\n        const qpdfOutput1 = path.join(DOWNLOADS_DIR, `${downloadId}-qpdf1.pdf`);\n        let result = runRepairCommand(`qpdf --linearize --warning-exit-0 \"${file.path}\" \"${qpdfOutput1}\"`);\n        if (result.success && fs.existsSync(qpdfOutput1) && fs.statSync(qpdfOutput1).size > 0) {\n          fs.renameSync(qpdfOutput1, outputPath);\n          repairSuccess = true;\n          usedMethod = 'qpdf-linearize';\n          log(`Quick repair (qpdf linearize) successful`);\n        } else {\n          log(`qpdf linearize failed: ${result.output}`);\n          try { fs.unlinkSync(qpdfOutput1); } catch {}\n        }\n\n        // Method 2: qpdf attempting to read damaged file and output valid PDF\n        if (!repairSuccess) {\n          const qpdfOutput2 = path.join(DOWNLOADS_DIR, `${downloadId}-qpdf2.pdf`);\n          // Use empty password to help with some damaged files, ignore xref issues\n          result = runRepairCommand(`qpdf --warning-exit-0 --password=\"\" \"${file.path}\" \"${qpdfOutput2}\"`);\n          if (result.success && fs.existsSync(qpdfOutput2) && fs.statSync(qpdfOutput2).size > 0) {\n            fs.renameSync(qpdfOutput2, outputPath);\n            repairSuccess = true;\n            usedMethod = 'qpdf-basic';\n            log(`Quick repair (qpdf basic) successful`);\n          } else {\n            log(`qpdf basic failed: ${result.output}`);\n            try { fs.unlinkSync(qpdfOutput2); } catch {}\n          }\n        }\n\n        // Method 3: qpdf QDF mode (deconstructs and rebuilds PDF)\n        if (!repairSuccess) {\n          const qpdfOutput3 = path.join(DOWNLOADS_DIR, `${downloadId}-qpdf3.pdf`);\n          result = runRepairCommand(`qpdf --warning-exit-0 --qdf --object-streams=disable \"${file.path}\" \"${qpdfOutput3}\"`);\n          if (result.success && fs.existsSync(qpdfOutput3) && fs.statSync(qpdfOutput3).size > 0) {\n            fs.renameSync(qpdfOutput3, outputPath);\n            repairSuccess = true;\n            usedMethod = 'qpdf-qdf';\n            log(`Quick repair (qpdf QDF) successful`);\n          } else {\n            log(`qpdf QDF failed: ${result.output}`);\n            try { fs.unlinkSync(qpdfOutput3); } catch {}\n          }\n        }\n      }\n\n      // Try mutool clean (mupdf) - good for structural repairs\n      if (!repairSuccess && (method === 'auto' || method === 'quick')) {\n        const mutoolOutput = path.join(DOWNLOADS_DIR, `${downloadId}-mutool.pdf`);\n        const result = runRepairCommand(`mutool clean -gggg -D \"${file.path}\" \"${mutoolOutput}\"`);\n        if (result.success && fs.existsSync(mutoolOutput) && fs.statSync(mutoolOutput).size > 0) {\n          fs.renameSync(mutoolOutput, outputPath);\n          repairSuccess = true;\n          usedMethod = 'mutool';\n          log(`Repair (mutool clean) successful`);\n        } else {\n          log(`mutool clean failed: ${result.output}`);\n          try { fs.unlinkSync(mutoolOutput); } catch {}\n        }\n      }\n\n      // Try deep repair with Ghostscript (if auto and previous failed, or if deep)\n      if (!repairSuccess && (method === 'auto' || method === 'deep')) {\n        const gsOutput = path.join(DOWNLOADS_DIR, `${downloadId}-gs.pdf`);\n        \n        // Ghostscript re-renders the PDF completely - most aggressive repair\n        const result = runRepairCommand(\n          `gs -dNOPAUSE -dBATCH -dSAFER -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/prepress -dAutoRotatePages=/None -sOutputFile=\"${gsOutput}\" \"${file.path}\"`,\n          120000\n        );\n        \n        if (result.success && fs.existsSync(gsOutput) && fs.statSync(gsOutput).size > 0) {\n          fs.renameSync(gsOutput, outputPath);\n          repairSuccess = true;\n          usedMethod = 'ghostscript';\n          log(`Deep repair (Ghostscript) successful`);\n        } else {\n          log(`Ghostscript failed: ${result.output}`);\n          try { fs.unlinkSync(gsOutput); } catch {}\n        }\n\n        // Try Ghostscript with more permissive settings\n        if (!repairSuccess) {\n          const gsOutput2 = path.join(DOWNLOADS_DIR, `${downloadId}-gs2.pdf`);\n          const result2 = runRepairCommand(\n            `gs -dNOPAUSE -dBATCH -dQUIET -sDEVICE=pdfwrite -dPDFSETTINGS=/default -sOutputFile=\"${gsOutput2}\" \"${file.path}\"`,\n            120000\n          );\n          \n          if (result2.success && fs.existsSync(gsOutput2) && fs.statSync(gsOutput2).size > 0) {\n            fs.renameSync(gsOutput2, outputPath);\n            repairSuccess = true;\n            usedMethod = 'ghostscript-permissive';\n            log(`Deep repair (Ghostscript permissive) successful`);\n          } else {\n            log(`Ghostscript permissive failed: ${result2.output}`);\n            try { fs.unlinkSync(gsOutput2); } catch {}\n          }\n        }\n      }\n\n      // Clean up uploaded file\n      try {\n        fs.unlinkSync(file.path);\n      } catch {}\n\n      if (!repairSuccess || !outputPath || !fs.existsSync(outputPath)) {\n        return res.status(500).json({ \n          error: \"Unable to repair PDF. The file may be too damaged or not a valid PDF.\" \n        });\n      }\n\n      const elapsed = Date.now() - startTime;\n      log(`PDF repaired using ${usedMethod} in ${elapsed}ms`);\n\n      // Read the repaired file and send it\n      const repairedPdf = fs.readFileSync(outputPath);\n\n      // Clean up temp file\n      try {\n        fs.unlinkSync(outputPath);\n      } catch {}\n\n      res.setHeader(\"Content-Type\", \"application/pdf\");\n      res.setHeader(\"Content-Disposition\", \"attachment; filename=repaired.pdf\");\n      res.setHeader(\"X-Repair-Method\", usedMethod);\n      res.setHeader(\"X-Elapsed-Time\", elapsed.toString());\n      res.send(repairedPdf);\n    } catch (error: any) {\n      // Clean up on error\n      if (outputPath && fs.existsSync(outputPath)) {\n        try { fs.unlinkSync(outputPath); } catch {}\n      }\n      log(`Error repairing PDF: ${error.message}`);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":29691,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"grid place-content-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1031,"size_tokens":null},"client/src/index.css":{"content":"@import \"tailwindcss\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:is(.dark *));\n\n@theme inline {\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  --color-chart-1: hsl(var(--chart-1));\n  --color-chart-2: hsl(var(--chart-2));\n  --color-chart-3: hsl(var(--chart-3));\n  --color-chart-4: hsl(var(--chart-4));\n  --color-chart-5: hsl(var(--chart-5));\n}\n\n/* Apple-inspired Theme */\n:root {\n  /* Base Colors - Clean White/Gray foundation */\n  --background: 0 0% 98%; /* #fbfbfd - Classic Apple off-white background */\n  --foreground: 240 10% 3.9%; /* #1d1d1f - Almost black text */\n\n  /* Cards - Stark white against the off-white bg */\n  --card: 0 0% 100%;\n  --card-foreground: 240 10% 3.9%;\n\n  /* Popovers */\n  --popover: 0 0% 100%;\n  --popover-foreground: 240 10% 3.9%;\n\n  /* Primary - Saudi Green */\n  --primary: 149 80% 35%; /* #11A05C - Approximate Saudi Green suitable for UI */\n  --primary-foreground: 0 0% 98%;\n\n  /* Secondary - Light gray for secondary actions */\n  --secondary: 240 4.8% 95.9%;\n  --secondary-foreground: 240 5.9% 10%;\n\n  /* Muted - For subtle text */\n  --muted: 240 4.8% 95.9%;\n  --muted-foreground: 240 3.8% 46.1%; /* #86868b */\n\n  /* Accent - For hover states */\n  --accent: 240 4.8% 95.9%;\n  --accent-foreground: 240 5.9% 10%;\n\n  /* Destructive - Apple Red */\n  --destructive: 0 84.2% 60.2%;\n  --destructive-foreground: 0 0% 98%;\n\n  /* Borders & Inputs */\n  --border: 240 5.9% 90%;\n  --input: 240 5.9% 90%;\n  --ring: 149 80% 35%;\n\n  /* Charts (Default shadcn values kept for safety) */\n  --chart-1: 12 76% 61%;\n  --chart-2: 173 58% 39%;\n  --chart-3: 197 37% 24%;\n  --chart-4: 43 74% 66%;\n  --chart-5: 27 87% 67%;\n\n  --radius: 1rem; /* Rounded corners consistent with Apple UI */\n  \n  /* Default Font (English) */\n  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\n}\n\n/* Arabic Font Override when dir=\"rtl\" */\n:root[dir=\"rtl\"] {\n  --font-sans: 'IBM Plex Sans Arabic', 'Inter', sans-serif;\n}\n\n.dark {\n  /* Dark Mode - Dark Gray/Black foundation */\n  --background: 240 10% 3.9%;\n  --foreground: 0 0% 98%;\n\n  --card: 240 10% 3.9%;\n  --card-foreground: 0 0% 98%;\n\n  --popover: 240 10% 3.9%;\n  --popover-foreground: 0 0% 98%;\n\n  --primary: 149 80% 35%;\n  --primary-foreground: 0 0% 98%;\n\n  --secondary: 240 3.7% 15.9%;\n  --secondary-foreground: 0 0% 98%;\n\n  --muted: 240 3.7% 15.9%;\n  --muted-foreground: 240 5% 64.9%;\n\n  --accent: 240 3.7% 15.9%;\n  --accent-foreground: 0 0% 98%;\n\n  --destructive: 0 62.8% 30.6%;\n  --destructive-foreground: 0 0% 98%;\n\n  --border: 240 3.7% 15.9%;\n  --input: 240 3.7% 15.9%;\n  --ring: 149 80% 35%;\n  \n  --chart-1: 220 70% 50%;\n  --chart-2: 160 60% 45%;\n  --chart-3: 30 80% 55%;\n  --chart-4: 280 65% 60%;\n  --chart-5: 340 75% 55%;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/* Custom utilities for Apple-like effects */\n@layer utilities {\n  .glass {\n    @apply bg-white/80 dark:bg-black/80 backdrop-blur-md border-b border-white/20 supports-[backdrop-filter]:bg-white/60;\n  }\n  \n  .apple-card {\n    @apply bg-card text-card-foreground rounded-2xl shadow-sm border border-border/50 transition-all duration-300 hover:shadow-md hover:scale-[1.01];\n  }\n  \n  .apple-button {\n    @apply bg-primary text-primary-foreground hover:bg-primary/90 rounded-full px-6 py-2 font-medium transition-colors duration-200;\n  }\n}\n","path":null,"size_bytes":4441,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ReviewPagesModal.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n  DialogFooter,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { useLanguage } from '@/lib/i18n';\nimport { Loader2, ChevronLeft, ChevronRight, Trash2, Scissors, Check, X } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface ReviewPagesModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  file: File;\n  selectedPages: number[];\n  mode: 'remove' | 'extract';\n  isProcessing?: boolean;\n}\n\ninterface PagePreview {\n  pageNum: number;\n  imageUrl: string | null;\n  isLoading: boolean;\n}\n\nexport function ReviewPagesModal({\n  isOpen,\n  onClose,\n  onConfirm,\n  file,\n  selectedPages,\n  mode,\n  isProcessing = false,\n}: ReviewPagesModalProps) {\n  const { language, direction } = useLanguage();\n  const [previews, setPreviews] = useState<PagePreview[]>([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isLoadingPdf, setIsLoadingPdf] = useState(true);\n  const pdfDocRef = useRef<pdfjsLib.PDFDocumentProxy | null>(null);\n  const imageUrlsRef = useRef<string[]>([]);\n\n  const sortedPages = [...selectedPages].sort((a, b) => a - b);\n\n  const renderPage = useCallback(async (doc: pdfjsLib.PDFDocumentProxy, pageNum: number): Promise<string> => {\n    const page = await doc.getPage(pageNum);\n    const scale = 1.0;\n    const viewport = page.getViewport({ scale });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    if (!context) throw new Error('Canvas context not available');\n    \n    canvas.width = viewport.width;\n    canvas.height = viewport.height;\n    \n    await page.render({\n      canvasContext: context,\n      viewport: viewport,\n      canvas: canvas\n    } as any).promise;\n    \n    return new Promise((resolve) => {\n      canvas.toBlob((blob) => {\n        if (blob) {\n          const url = URL.createObjectURL(blob);\n          imageUrlsRef.current.push(url);\n          resolve(url);\n        } else {\n          resolve('');\n        }\n      }, 'image/jpeg', 0.85);\n    });\n  }, []);\n\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [totalPdfPages, setTotalPdfPages] = useState(0);\n\n  useEffect(() => {\n    if (!isOpen || !file || sortedPages.length === 0) return;\n\n    let isMounted = true;\n    setIsLoadingPdf(true);\n    setCurrentIndex(0);\n    setValidationError(null);\n\n    const loadPdf = async () => {\n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const doc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        \n        if (!isMounted) {\n          doc.destroy();\n          return;\n        }\n        \n        pdfDocRef.current = doc;\n        const numPages = doc.numPages;\n        setTotalPdfPages(numPages);\n        \n        const invalidPages = sortedPages.filter(p => p > numPages);\n        if (invalidPages.length > 0) {\n          setValidationError(\n            language === 'ar'\n              ? `الصفحات التالية تتجاوز عدد صفحات الملف (${numPages}): ${invalidPages.join(', ')}`\n              : `The following pages exceed the document's page count (${numPages}): ${invalidPages.join(', ')}`\n          );\n          setIsLoadingPdf(false);\n          return;\n        }\n        \n        const validPages = sortedPages.filter(p => p <= numPages);\n        const initialPreviews: PagePreview[] = validPages.map(pageNum => ({\n          pageNum,\n          imageUrl: null,\n          isLoading: true\n        }));\n        setPreviews(initialPreviews);\n        setIsLoadingPdf(false);\n\n        for (let i = 0; i < validPages.length; i++) {\n          if (!isMounted) break;\n          \n          const pageNum = validPages[i];\n          const imageUrl = await renderPage(doc, pageNum);\n          \n          if (!isMounted) break;\n          \n          setPreviews(prev => {\n            const updated = [...prev];\n            const idx = updated.findIndex(p => p.pageNum === pageNum);\n            if (idx !== -1) {\n              updated[idx] = { ...updated[idx], imageUrl, isLoading: false };\n            }\n            return updated;\n          });\n        }\n      } catch (err) {\n        console.error('Error loading PDF for review:', err);\n        setValidationError(\n          language === 'ar' \n            ? 'فشل في تحميل الملف للمعاينة'\n            : 'Failed to load file for preview'\n        );\n        setIsLoadingPdf(false);\n      }\n    };\n\n    loadPdf();\n\n    return () => {\n      isMounted = false;\n      imageUrlsRef.current.forEach(url => URL.revokeObjectURL(url));\n      imageUrlsRef.current = [];\n      if (pdfDocRef.current) {\n        pdfDocRef.current.destroy();\n        pdfDocRef.current = null;\n      }\n      setPreviews([]);\n      setValidationError(null);\n    };\n  }, [isOpen, file, sortedPages.join(','), renderPage, language]);\n\n  const goToPrevious = () => {\n    setCurrentIndex(prev => Math.max(0, prev - 1));\n  };\n\n  const goToNext = () => {\n    setCurrentIndex(prev => Math.min(previews.length - 1, prev + 1));\n  };\n\n  const currentPreview = previews[currentIndex];\n\n  const titleText = mode === 'remove' \n    ? (language === 'ar' ? 'مراجعة الصفحات للحذف' : 'Review Pages to Remove')\n    : (language === 'ar' ? 'مراجعة الصفحات للاستخراج' : 'Review Pages to Extract');\n\n  const descriptionText = mode === 'remove'\n    ? (language === 'ar' \n        ? `أنت على وشك حذف ${sortedPages.length} صفحة. راجع الصفحات أدناه للتأكد.`\n        : `You are about to remove ${sortedPages.length} page${sortedPages.length > 1 ? 's' : ''}. Review below to confirm.`)\n    : (language === 'ar'\n        ? `أنت على وشك استخراج ${sortedPages.length} صفحة. راجع الصفحات أدناه للتأكد.`\n        : `You are about to extract ${sortedPages.length} page${sortedPages.length > 1 ? 's' : ''}. Review below to confirm.`);\n\n  const confirmText = mode === 'remove'\n    ? (language === 'ar' ? 'تأكيد الحذف' : 'Confirm Removal')\n    : (language === 'ar' ? 'تأكيد الاستخراج' : 'Confirm Extract');\n\n  const ConfirmIcon = mode === 'remove' ? Trash2 : Scissors;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] flex flex-col\" dir={direction}>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            {mode === 'remove' ? (\n              <Trash2 className=\"h-5 w-5 text-red-500\" />\n            ) : (\n              <Scissors className=\"h-5 w-5 text-primary\" />\n            )}\n            {titleText}\n          </DialogTitle>\n          <DialogDescription>\n            {descriptionText}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"flex-1 min-h-0 py-4\">\n          {isLoadingPdf ? (\n            <div className=\"flex items-center justify-center h-64\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              <span className=\"ms-3 text-muted-foreground\">\n                {language === 'ar' ? 'جاري تحميل المعاينة...' : 'Loading preview...'}\n              </span>\n            </div>\n          ) : validationError ? (\n            <div className=\"flex flex-col items-center justify-center h-64 text-center px-4\">\n              <div className=\"w-16 h-16 rounded-full bg-red-100 dark:bg-red-950/30 flex items-center justify-center mb-4\">\n                <X className=\"h-8 w-8 text-red-500\" />\n              </div>\n              <p className=\"text-lg font-medium text-red-600 dark:text-red-400 mb-2\">\n                {language === 'ar' ? 'خطأ في نطاق الصفحات' : 'Invalid Page Range'}\n              </p>\n              <p className=\"text-sm text-muted-foreground max-w-md\">\n                {validationError}\n              </p>\n            </div>\n          ) : previews.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center h-64 text-center\">\n              <p className=\"text-muted-foreground\">\n                {language === 'ar' ? 'لا توجد صفحات للمعاينة' : 'No pages to preview'}\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"relative bg-secondary/30 rounded-xl overflow-hidden\" style={{ minHeight: '350px' }}>\n                {currentPreview?.isLoading ? (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                  </div>\n                ) : currentPreview?.imageUrl ? (\n                  <div className=\"flex items-center justify-center p-4\">\n                    <img\n                      src={currentPreview.imageUrl}\n                      alt={`Page ${currentPreview.pageNum}`}\n                      className=\"max-h-[350px] w-auto object-contain rounded shadow-lg\"\n                    />\n                  </div>\n                ) : (\n                  <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground\">\n                    {language === 'ar' ? 'فشل تحميل المعاينة' : 'Failed to load preview'}\n                  </div>\n                )}\n\n                {previews.length > 1 && (\n                  <>\n                    <Button\n                      variant=\"outline\"\n                      size=\"icon\"\n                      className=\"absolute start-2 top-1/2 -translate-y-1/2 bg-background/80 backdrop-blur-sm\"\n                      onClick={goToPrevious}\n                      disabled={currentIndex === 0}\n                    >\n                      {direction === 'rtl' ? <ChevronRight className=\"h-4 w-4\" /> : <ChevronLeft className=\"h-4 w-4\" />}\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"icon\"\n                      className=\"absolute end-2 top-1/2 -translate-y-1/2 bg-background/80 backdrop-blur-sm\"\n                      onClick={goToNext}\n                      disabled={currentIndex === previews.length - 1}\n                    >\n                      {direction === 'rtl' ? <ChevronLeft className=\"h-4 w-4\" /> : <ChevronRight className=\"h-4 w-4\" />}\n                    </Button>\n                  </>\n                )}\n\n                <div className=\"absolute bottom-2 start-1/2 -translate-x-1/2 bg-background/80 backdrop-blur-sm px-3 py-1.5 rounded-full text-sm font-medium\">\n                  {language === 'ar' \n                    ? `صفحة ${currentPreview?.pageNum} (${currentIndex + 1}/${previews.length})`\n                    : `Page ${currentPreview?.pageNum} (${currentIndex + 1} of ${previews.length})`\n                  }\n                </div>\n              </div>\n\n              {previews.length > 1 && (\n                <ScrollArea className=\"w-full\">\n                  <div className=\"flex gap-2 pb-2\">\n                    {previews.map((preview, idx) => (\n                      <button\n                        key={preview.pageNum}\n                        onClick={() => setCurrentIndex(idx)}\n                        className={cn(\n                          \"shrink-0 w-16 h-20 rounded-lg overflow-hidden border-2 transition-all\",\n                          idx === currentIndex\n                            ? (mode === 'remove' ? \"border-red-500 ring-2 ring-red-500/30\" : \"border-primary ring-2 ring-primary/30\")\n                            : \"border-border/50 hover:border-primary/50\"\n                        )}\n                      >\n                        {preview.isLoading ? (\n                          <div className=\"w-full h-full bg-secondary/50 flex items-center justify-center\">\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          </div>\n                        ) : preview.imageUrl ? (\n                          <img\n                            src={preview.imageUrl}\n                            alt={`Page ${preview.pageNum}`}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        ) : (\n                          <div className=\"w-full h-full bg-secondary/50 flex items-center justify-center text-xs\">\n                            {preview.pageNum}\n                          </div>\n                        )}\n                      </button>\n                    ))}\n                  </div>\n                </ScrollArea>\n              )}\n            </div>\n          )}\n        </div>\n\n        <DialogFooter className=\"gap-2 sm:gap-0\">\n          <Button\n            variant=\"outline\"\n            onClick={onClose}\n            disabled={isProcessing}\n            className=\"rounded-full\"\n          >\n            <X className=\"h-4 w-4 me-2\" />\n            {language === 'ar' ? 'إلغاء' : 'Cancel'}\n          </Button>\n          <Button\n            onClick={onConfirm}\n            disabled={isProcessing || isLoadingPdf || !!validationError || previews.length === 0}\n            className={cn(\n              \"rounded-full\",\n              mode === 'remove' ? \"bg-red-500 hover:bg-red-600\" : \"\"\n            )}\n          >\n            {isProcessing ? (\n              <>\n                <Loader2 className=\"h-4 w-4 animate-spin me-2\" />\n                {language === 'ar' ? 'جاري المعالجة...' : 'Processing...'}\n              </>\n            ) : (\n              <>\n                <ConfirmIcon className=\"h-4 w-4 me-2\" />\n                {confirmText}\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":14043,"size_tokens":null},"client/src/components/FileUploader.tsx":{"content":"import { useCallback, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { Upload, File, X } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { useLanguage } from '@/lib/i18n';\n\ninterface FileUploaderProps {\n  onFilesSelected: (files: File[]) => void;\n  accept?: Record<string, string[]>;\n  maxFiles?: number;\n  multiple?: boolean;\n  description?: string;\n}\n\nexport function FileUploader({ \n  onFilesSelected, \n  accept = { 'application/pdf': ['.pdf'] }, \n  maxFiles = 10,\n  multiple = true,\n  description \n}: FileUploaderProps) {\n  const { t } = useLanguage();\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    onFilesSelected(acceptedFiles);\n  }, [onFilesSelected]);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept,\n    maxFiles,\n    multiple\n  });\n\n  return (\n    <div\n      {...getRootProps()}\n      className={`\n        relative overflow-hidden rounded-3xl border-2 border-dashed p-12 text-center transition-all duration-300 cursor-pointer\n        ${isDragActive \n          ? 'border-primary bg-primary/5 scale-[1.01]' \n          : 'border-border hover:border-primary/50 hover:bg-secondary/30'\n        }\n      `}\n    >\n      <input {...getInputProps()} />\n      <div className=\"flex flex-col items-center gap-4\">\n        <div className={`\n          h-20 w-20 rounded-2xl flex items-center justify-center transition-colors duration-300\n          ${isDragActive ? 'bg-primary text-primary-foreground' : 'bg-secondary text-muted-foreground'}\n        `}>\n          <Upload className=\"h-10 w-10\" />\n        </div>\n        \n        <div className=\"space-y-2\">\n          <h3 className=\"text-xl font-semibold tracking-tight\">\n            {isDragActive ? \"Drop files here\" : \"Click or drag files here\"}\n          </h3>\n          <p className=\"text-muted-foreground max-w-sm mx-auto\">\n            {description || \"Upload your documents to get started.\"}\n          </p>\n        </div>\n        \n        <Button className=\"mt-4 rounded-full\" variant={isDragActive ? \"default\" : \"secondary\"}>\n          Select Files\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2170,"size_tokens":null},"client/src/pages/SplitPDF.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { PdfThumbnailGrid } from '@/components/PdfThumbnailGrid';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Scissors, Download, CheckCircle, RotateCcw } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Label } from '@/components/ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Input } from '@/components/ui/input';\n\nexport default function SplitPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [splitMode, setSplitMode] = useState<'all' | 'range'>('all');\n  const [rangeInput, setRangeInput] = useState('');\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const [downloadBlob, setDownloadBlob] = useState<string | null>(null);\n  const [pageCount, setPageCount] = useState(0);\n  const [resultMode, setResultMode] = useState<'zip' | 'pdf' | null>(null);\n  const [selectedPages, setSelectedPages] = useState<Set<number>>(new Set());\n  const [documentTotalPages, setDocumentTotalPages] = useState(0);\n  const [downloadFormat, setDownloadFormat] = useState<'combined' | 'separate'>('combined');\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n\n  const parseRangeInput = useCallback((input: string, maxPages?: number): Set<number> => {\n    const pages = new Set<number>();\n    if (!input.trim()) return pages;\n    \n    const parts = input.split(',').map(p => p.trim()).filter(p => p.length > 0);\n    for (const part of parts) {\n      if (part.includes('-')) {\n        const [start, end] = part.split('-').map(n => parseInt(n.trim()));\n        if (!isNaN(start) && !isNaN(end) && start <= end) {\n          for (let i = start; i <= Math.min(end, maxPages || end); i++) {\n            if (i > 0) pages.add(i);\n          }\n        }\n      } else {\n        const page = parseInt(part);\n        if (!isNaN(page) && page > 0 && (!maxPages || page <= maxPages)) {\n          pages.add(page);\n        }\n      }\n    }\n    return pages;\n  }, []);\n\n  const getPageRangeString = useCallback((pages: Set<number>): string => {\n    const sortedPages = Array.from(pages).sort((a, b) => a - b);\n    if (sortedPages.length === 0) return '';\n    \n    const ranges: string[] = [];\n    let start = sortedPages[0];\n    let end = sortedPages[0];\n    \n    for (let i = 1; i < sortedPages.length; i++) {\n      if (sortedPages[i] === end + 1) {\n        end = sortedPages[i];\n      } else {\n        ranges.push(start === end ? `${start}` : `${start}-${end}`);\n        start = sortedPages[i];\n        end = sortedPages[i];\n      }\n    }\n    ranges.push(start === end ? `${start}` : `${start}-${end}`);\n    \n    return ranges.join(', ');\n  }, []);\n\n  const handleRangeInputChange = useCallback((value: string) => {\n    setRangeInput(value);\n    const parsed = parseRangeInput(value, documentTotalPages || undefined);\n    setSelectedPages(parsed);\n  }, [parseRangeInput, documentTotalPages]);\n\n  const validateAndNormalizeInput = useCallback(() => {\n    if (documentTotalPages > 0) {\n      const allParsed = parseRangeInput(rangeInput, undefined);\n      const validParsed = parseRangeInput(rangeInput, documentTotalPages);\n      \n      const invalidPages = Array.from(allParsed).filter(p => p > documentTotalPages);\n      if (invalidPages.length > 0) {\n        toast({\n          title: language === 'ar' ? 'تم تصحيح النطاق' : 'Range corrected',\n          description: language === 'ar'\n            ? `تم حذف الصفحات التي تتجاوز عدد صفحات الملف (${documentTotalPages}): ${invalidPages.join(', ')}`\n            : `Pages exceeding document length (${documentTotalPages}) were removed: ${invalidPages.join(', ')}`,\n        });\n      }\n      \n      setSelectedPages(validParsed);\n      setRangeInput(getPageRangeString(validParsed));\n    }\n  }, [documentTotalPages, rangeInput, parseRangeInput, getPageRangeString, toast, language]);\n\n  const handleRangeInputBlur = useCallback(() => {\n    validateAndNormalizeInput();\n  }, [validateAndNormalizeInput]);\n\n  const handleRangeInputKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      validateAndNormalizeInput();\n    }\n  }, [validateAndNormalizeInput]);\n\n  const handleTogglePage = useCallback((pageNum: number) => {\n    setSelectedPages(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(pageNum)) {\n        newSet.delete(pageNum);\n      } else {\n        newSet.add(pageNum);\n      }\n      setRangeInput(getPageRangeString(newSet));\n      return newSet;\n    });\n  }, [getPageRangeString]);\n\n  const handleClearSelection = useCallback(() => {\n    setSelectedPages(new Set());\n    setRangeInput('');\n  }, []);\n\n  const prevTotalPagesRef = useRef(0);\n  \n  useEffect(() => {\n    if (documentTotalPages > 0 && documentTotalPages !== prevTotalPagesRef.current && selectedPages.size > 0) {\n      const invalidPages = Array.from(selectedPages).filter(p => p > documentTotalPages);\n      if (invalidPages.length > 0) {\n        const validPages = new Set(Array.from(selectedPages).filter(p => p <= documentTotalPages));\n        setSelectedPages(validPages);\n        setRangeInput(getPageRangeString(validPages));\n        \n        toast({\n          title: language === 'ar' ? 'تم تصحيح النطاق' : 'Range corrected',\n          description: language === 'ar'\n            ? `تم حذف الصفحات التي تتجاوز عدد صفحات الملف (${documentTotalPages}): ${invalidPages.join(', ')}`\n            : `Pages exceeding document length (${documentTotalPages}) were removed: ${invalidPages.join(', ')}`,\n        });\n      }\n      prevTotalPagesRef.current = documentTotalPages;\n    }\n  }, [documentTotalPages, selectedPages, getPageRangeString, language, toast]);\n  \n  const hasInvalidPages = documentTotalPages > 0 && Array.from(selectedPages).some(p => p > documentTotalPages);\n  const isWaitingForDocInfo = splitMode === 'range' && selectedPages.size > 0 && documentTotalPages === 0;\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setDownloadUrl(null);\n      setDownloadBlob(null);\n      setPageCount(0);\n      setResultMode(null);\n      setSelectedPages(new Set());\n      setRangeInput('');\n      setDocumentTotalPages(0);\n    }\n  };\n\n  // Timer for elapsed time\n  useEffect(() => {\n    if (isProcessing) {\n      timerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [isProcessing]);\n\n  // Simulate progress updates\n  useEffect(() => {\n    if (!isProcessing) return;\n    \n    const interval = setInterval(() => {\n      setProgress(prev => {\n        if (prev < 30) return prev + Math.random() * 3;\n        if (prev < 60) return prev + Math.random() * 2;\n        if (prev < 90) return prev + Math.random() * 1;\n        return Math.min(prev + 0.5, 95);\n      });\n    }, 500);\n    \n    return () => clearInterval(interval);\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleSplit = async () => {\n    if (!file) return;\n\n    if (splitMode === 'range') {\n      if (!rangeInput.trim() || selectedPages.size === 0) {\n        toast({\n          title: language === 'ar' ? 'نطاق مطلوب' : 'Range required',\n          description: language === 'ar' \n            ? 'يرجى إدخال نطاق الصفحات (مثال: 1-3, 5, 7-10)'\n            : 'Please enter page ranges (e.g., 1-3, 5, 7-10)',\n          variant: \"destructive\"\n        });\n        return;\n      }\n      \n      if (hasInvalidPages) {\n        toast({\n          title: language === 'ar' ? 'صفحات غير صالحة' : 'Invalid pages',\n          description: language === 'ar'\n            ? `بعض الصفحات تتجاوز عدد صفحات الملف (${documentTotalPages})`\n            : `Some pages exceed the document length (${documentTotalPages})`,\n          variant: \"destructive\"\n        });\n        return;\n      }\n    }\n\n    setIsProcessing(true);\n    setProgress(0);\n    setElapsedTime(0);\n    setDownloadUrl(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      const validRangeString = splitMode === 'range' ? getPageRangeString(selectedPages) : '';\n      \n      const response = await fetch('/api/pdf/split', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'X-Split-Mode': splitMode,\n          'X-Split-Ranges': validRangeString,\n          'X-Download-Format': splitMode === 'range' ? downloadFormat : 'zip',\n        },\n      });\n\n      if (!response.ok) {\n        let errorMsg = 'Failed to split PDF';\n        try {\n          const error = await response.json();\n          errorMsg = error.error || errorMsg;\n        } catch {\n          errorMsg = `Server error: ${response.statusText}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      const contentType = response.headers.get('content-type') || '';\n      \n      // Check if response is JSON (download link) or direct file\n      if (contentType.includes('application/json')) {\n        const jsonData = await response.json();\n        \n        if (jsonData.downloadUrl) {\n          setDownloadUrl(jsonData.downloadUrl);\n          setPageCount(jsonData.pageCount || 0);\n          setResultMode('zip');\n          setProgress(100);\n          \n          toast({\n            title: language === 'ar' ? 'تم!' : 'Success!',\n            description: language === 'ar'\n              ? `تم تقسيم PDF إلى ${jsonData.pageCount} صفحة. انقر على الزر أدناه للتحميل.`\n              : `Your PDF has been split into ${jsonData.pageCount} pages. Click the button below to download.`,\n          });\n        } else {\n          throw new Error(jsonData.error || 'Invalid response from server');\n        }\n      } else {\n        // Custom range extraction - could be single PDF or ZIP\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const extractedPageCount = parseInt(response.headers.get('X-Page-Count') || '1');\n        const format = response.headers.get('X-Format') || 'combined';\n        \n        setDownloadBlob(url);\n        setPageCount(extractedPageCount);\n        setResultMode(format === 'separate' ? 'zip' : 'pdf');\n        setProgress(100);\n        \n        toast({\n          title: language === 'ar' ? 'تم!' : 'Success!',\n          description: language === 'ar' \n            ? `تم استخراج ${extractedPageCount} صفحة بنجاح`\n            : `${extractedPageCount} pages have been extracted successfully.`,\n        });\n      }\n    } catch (error: any) {\n      console.error('Error splitting PDF:', error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to split PDF. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (resultMode === 'zip' && downloadUrl) {\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = 'extracted-pages.zip';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } else if (resultMode === 'zip' && downloadBlob) {\n      // ZIP file from separate extraction\n      const link = document.createElement('a');\n      link.href = downloadBlob;\n      link.download = 'extracted-pages.zip';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadBlob);\n      setDownloadBlob(null);\n    } else if (resultMode === 'pdf' && downloadBlob) {\n      const link = document.createElement('a');\n      link.href = downloadBlob;\n      link.download = 'extracted-pages.pdf';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadBlob);\n      setDownloadBlob(null);\n    }\n  };\n\n  const handleReset = () => {\n    if (downloadBlob) {\n      window.URL.revokeObjectURL(downloadBlob);\n    }\n    setFile(null);\n    setDownloadUrl(null);\n    setDownloadBlob(null);\n    setPageCount(0);\n    setProgress(0);\n    setElapsedTime(0);\n    setRangeInput('');\n    setResultMode(null);\n    setSelectedPages(new Set());\n    setDocumentTotalPages(0);\n    setDownloadFormat('combined');\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.split.title')}\n      description={t('tool.split.desc')}\n    >\n      {/* Download Result */}\n      {(downloadUrl || downloadBlob) && resultMode && (\n        <div className=\"space-y-6 max-w-2xl mx-auto\">\n          <div className=\"text-center space-y-4 py-6\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم استخراج الصفحات بنجاح!' : 'Pages Extracted Successfully!'}\n            </h3>\n            <p className=\"text-muted-foreground\">\n              {resultMode === 'zip' \n                ? (language === 'ar' \n                    ? `تم استخراج ${pageCount} صفحة وتجميعها في ملفات منفصلة.`\n                    : `${pageCount} pages have been extracted into separate files.`)\n                : (language === 'ar'\n                    ? `تم استخراج ${pageCount} صفحة في ملف PDF واحد.`\n                    : `${pageCount} pages have been extracted into a single PDF file.`)\n              }\n            </p>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <span className=\"text-sm font-medium text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30 px-4 py-2 rounded-full\">\n              {language === 'ar' ? `اكتمل في ${formatTime(elapsedTime)}` : `Completed in ${formatTime(elapsedTime)}`}\n            </span>\n          </div>\n\n\n          <div className=\"flex flex-col gap-4 pt-4\">\n            <Button \n              data-testid=\"button-download\"\n              size=\"lg\"\n              className=\"w-full gap-2 rounded-full py-6 text-lg\"\n              onClick={handleDownload}\n            >\n              <Download className=\"h-5 w-5\" />\n              {resultMode === 'zip' \n                ? (language === 'ar' ? 'تحميل الملفات (ZIP)' : 'Download Files (ZIP)')\n                : (language === 'ar' ? 'تحميل PDF المستخرج' : 'Download Extracted PDF')\n              }\n            </Button>\n            <Button \n              variant=\"outline\"\n              size=\"lg\"\n              className=\"w-full rounded-full py-6 text-lg\"\n              onClick={handleReset}\n            >\n              {language === 'ar' ? 'تقسيم ملف آخر' : 'Split Another File'}\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {!file && !resultMode ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF للتقسيم' : 'Select a PDF file to split'}\n          />\n        </div>\n      ) : !resultMode && (\n        <div className=\"space-y-8\">\n          {/* File Info */}\n          {file && (\n            <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n              <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-purple-600\">\n                <FileText className=\"h-6 w-6\" />\n              </div>\n              <div className=\"flex-1\">\n                <p className=\"font-medium text-lg\">{file.name}</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {(file.size / 1024 / 1024).toFixed(2)} MB\n                </p>\n              </div>\n              <Button variant=\"ghost\" size=\"icon\" onClick={() => setFile(null)}>\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n          )}\n\n          {/* Action Button at Top */}\n          {file && !isProcessing && (\n            <div className=\"flex justify-center\">\n              <Button \n                size=\"lg\" \n                onClick={handleSplit}\n                disabled={splitMode === 'range' && (selectedPages.size === 0 || hasInvalidPages || isWaitingForDocInfo)}\n                className=\"rounded-full px-8 text-lg min-w-[200px]\"\n              >\n                <Scissors className=\"h-5 w-5 me-2\" />\n                {splitMode === 'range' \n                  ? (language === 'ar' \n                      ? `استخراج ${selectedPages.size} صفحة`\n                      : `Extract ${selectedPages.size} Page${selectedPages.size > 1 ? 's' : ''}`)\n                  : (language === 'ar' ? 'تقسيم PDF' : 'Split PDF')\n                }\n              </Button>\n            </div>\n          )}\n\n          {/* Progress Bar - Shows during processing */}\n          {isProcessing && (\n            <div data-testid=\"progress-container\" className=\"space-y-4 p-8 bg-gradient-to-r from-primary/10 to-primary/5 rounded-2xl border-2 border-primary/30 shadow-lg\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div>\n                  <h4 className=\"font-bold text-xl text-primary\">\n                    {splitMode === 'range' \n                      ? (language === 'ar' ? 'جاري استخراج الصفحات...' : 'Extracting pages...')\n                      : (language === 'ar' ? 'جاري تقسيم PDF...' : 'Splitting your PDF...')\n                    }\n                  </h4>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    {language === 'ar' ? 'الوقت المنقضي: ' : 'Elapsed time: '}\n                    <span className=\"font-mono font-medium text-primary\">{formatTime(elapsedTime)}</span>\n                  </p>\n                </div>\n                <span className=\"text-4xl font-bold text-primary\">{Math.round(progress)}%</span>\n              </div>\n              \n              {/* Progress Bar */}\n              <div data-testid=\"progress-bar-container\" className=\"w-full bg-gray-200/50 rounded-full h-4 overflow-hidden border-2 border-primary/40 shadow-inner\">\n                <div \n                  data-testid=\"progress-bar-fill\"\n                  className=\"h-full bg-gradient-to-r from-primary via-primary to-primary/90 transition-all duration-300 rounded-full shadow-lg\"\n                  style={{ width: `${progress}%` }}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Split Options */}\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold\">Split Mode</h3>\n            \n            <RadioGroup \n              value={splitMode} \n              onValueChange={(v) => setSplitMode(v as any)} \n              className=\"grid md:grid-cols-2 gap-4\"\n            >\n              <div \n                className={`\n                  cursor-pointer rounded-xl border-2 p-6 transition-all\n                  ${splitMode === 'all' ? 'border-primary bg-primary/5' : 'border-border hover:border-primary/30'}\n                `}\n              >\n                <div className=\"flex items-start space-x-3\">\n                  <RadioGroupItem value=\"all\" id=\"all\" className=\"mt-1\" />\n                  <div className=\"flex-1\">\n                    <Label htmlFor=\"all\" className=\"font-bold text-lg cursor-pointer flex items-center gap-2\">\n                      <Scissors className=\"h-5 w-5\" />\n                      All Pages\n                    </Label>\n                    <p className=\"text-sm text-muted-foreground mt-2\">\n                      Extract every page to separate PDF files\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div \n                className={`\n                  cursor-pointer rounded-xl border-2 p-6 transition-all\n                  ${splitMode === 'range' ? 'border-primary bg-primary/5' : 'border-border hover:border-primary/30'}\n                `}\n              >\n                <div className=\"flex items-start space-x-3\">\n                  <RadioGroupItem value=\"range\" id=\"range\" className=\"mt-1\" />\n                  <div className=\"flex-1\">\n                    <Label htmlFor=\"range\" className=\"font-bold text-lg cursor-pointer flex items-center gap-2\">\n                      <Scissors className=\"h-5 w-5\" />\n                      Custom Range\n                    </Label>\n                    <p className=\"text-sm text-muted-foreground mt-2\">\n                      Specify which pages to extract\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </RadioGroup>\n\n            {splitMode === 'range' && file && (\n              <div className=\"space-y-4\">\n                {/* Download Format Option - At Top */}\n                <div className=\"p-4 bg-secondary/20 rounded-xl border border-border/30\">\n                  <h4 className=\"font-medium mb-3\">\n                    {language === 'ar' ? 'تنسيق التحميل' : 'Download Format'}\n                  </h4>\n                  <RadioGroup value={downloadFormat} onValueChange={(v) => setDownloadFormat(v as 'combined' | 'separate')} className=\"space-y-2\" data-testid=\"radio-download-format\">\n                    <div className=\"flex items-center space-x-2\">\n                      <RadioGroupItem value=\"combined\" id=\"format-combined\" data-testid=\"radio-format-combined\" />\n                      <Label htmlFor=\"format-combined\" className=\"cursor-pointer\">\n                        {language === 'ar' ? 'ملف PDF واحد' : 'Single PDF File'}\n                      </Label>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <RadioGroupItem value=\"separate\" id=\"format-separate\" data-testid=\"radio-format-separate\" />\n                      <Label htmlFor=\"format-separate\" className=\"cursor-pointer\">\n                        {language === 'ar' ? 'ملفات منفصلة (ZIP)' : 'Separate Files (ZIP)'}\n                      </Label>\n                    </div>\n                  </RadioGroup>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <Label htmlFor=\"ranges\" className=\"text-base\">\n                      {language === 'ar' ? 'نطاق الصفحات' : 'Page Ranges'}\n                    </Label>\n                    {selectedPages.size > 0 && (\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={handleClearSelection}\n                        className=\"text-muted-foreground\"\n                      >\n                        <RotateCcw className=\"h-4 w-4 me-1\" />\n                        {language === 'ar' ? 'إلغاء التحديد' : 'Clear'}\n                      </Button>\n                    )}\n                  </div>\n                  <Input\n                    id=\"ranges\"\n                    placeholder={language === 'ar' ? 'مثال: 1-3, 5, 7-10' : 'e.g., 1-3, 5, 7-10'}\n                    value={rangeInput}\n                    onChange={(e) => handleRangeInputChange(e.target.value)}\n                    onBlur={handleRangeInputBlur}\n                    onKeyDown={handleRangeInputKeyDown}\n                    className=\"text-base py-6\"\n                  />\n                  <p className=\"text-sm text-muted-foreground\">\n                    {language === 'ar' \n                      ? 'أو انقر على الصفحات أدناه لتحديدها'\n                      : 'Or click on pages below to select them'\n                    }\n                  </p>\n                </div>\n                \n                <PdfThumbnailGrid\n                  file={file}\n                  selectedPages={selectedPages}\n                  onTogglePage={handleTogglePage}\n                  onTotalPagesChange={setDocumentTotalPages}\n                  mode=\"extract\"\n                />\n              </div>\n            )}\n\n          </div>\n        </div>\n      )}\n\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":25132,"size_tokens":null},"client/src/components/ToolCard.tsx":{"content":"import { LucideIcon } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\ninterface ToolCardProps {\n  title: string;\n  description: string;\n  icon: LucideIcon;\n  href: string;\n  color?: string;\n}\n\nexport function ToolCard({ title, description, icon: Icon, href, color = \"text-primary\" }: ToolCardProps) {\n  return (\n    <Link href={href} className=\"group relative overflow-hidden rounded-2xl border border-border/50 bg-card p-6 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-1 block h-full\">\n      <div className=\"flex flex-col gap-4 h-full\">\n        <div className={`w-12 h-12 rounded-xl bg-background flex items-center justify-center shadow-sm border border-border/50 transition-transform group-hover:scale-110 ${color}`}>\n          <Icon className=\"w-6 h-6\" />\n        </div>\n        <div>\n          <h3 className=\"font-semibold text-lg tracking-tight text-foreground mb-1 group-hover:text-primary transition-colors\">\n            {title}\n          </h3>\n          <p className=\"text-sm text-muted-foreground leading-relaxed\">\n            {description}\n          </p>\n        </div>\n      </div>\n      <div className=\"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-transparent opacity-0 transition-opacity group-hover:opacity-100\" />\n    </Link>\n  );\n}\n","path":null,"size_bytes":1304,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/pages/OrganizePDF.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Download, CheckCircle, Loader2, RotateCcw, GripVertical, ArrowUpDown } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ninterface PageThumbnail {\n  pageNum: number;\n  imageUrl: string;\n  isLoading: boolean;\n}\n\ninterface OrganizeResult {\n  downloadUrl: string;\n  totalPages: number;\n  elapsedTime: number;\n}\n\nexport default function OrganizePDF() {\n  const { t, language, direction } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [thumbnails, setThumbnails] = useState<PageThumbnail[]>([]);\n  const [pageOrder, setPageOrder] = useState<number[]>([]);\n  const [totalPages, setTotalPages] = useState(0);\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [result, setResult] = useState<OrganizeResult | null>(null);\n  const [isLoadingThumbnails, setIsLoadingThumbnails] = useState(false);\n  const [draggedIndex, setDraggedIndex] = useState<number | null>(null);\n  const [dragOverIndex, setDragOverIndex] = useState<number | null>(null);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const pdfDocRef = useRef<any>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setResult(null);\n      setThumbnails([]);\n      setPageOrder([]);\n      setTotalPages(0);\n    }\n  };\n\n  const renderPage = useCallback(async (pdfDoc: any, pageNum: number): Promise<string> => {\n    const page = await pdfDoc.getPage(pageNum);\n    const viewport = page.getViewport({ scale: 0.3 });\n    \n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d')!;\n    canvas.height = viewport.height;\n    canvas.width = viewport.width;\n\n    await page.render({ canvasContext: context, viewport }).promise;\n    return canvas.toDataURL('image/jpeg', 0.7);\n  }, []);\n\n  useEffect(() => {\n    if (!file) return;\n\n    const loadThumbnails = async () => {\n      setIsLoadingThumbnails(true);\n      try {\n        const arrayBuffer = await file.arrayBuffer();\n        const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        pdfDocRef.current = pdfDoc;\n        const numPages = pdfDoc.numPages;\n        setTotalPages(numPages);\n        setPageOrder(Array.from({ length: numPages }, (_, i) => i + 1));\n\n        const initialThumbs: PageThumbnail[] = Array.from({ length: numPages }, (_, i) => ({\n          pageNum: i + 1,\n          imageUrl: '',\n          isLoading: true\n        }));\n        setThumbnails(initialThumbs);\n\n        for (let i = 0; i < numPages; i++) {\n          const imageUrl = await renderPage(pdfDoc, i + 1);\n          setThumbnails(prev => prev.map((thumb, idx) => \n            idx === i ? { ...thumb, imageUrl, isLoading: false } : thumb\n          ));\n        }\n      } catch (err) {\n        console.error('Error loading PDF:', err);\n        toast({\n          title: language === 'ar' ? 'خطأ' : 'Error',\n          description: language === 'ar' ? 'فشل في تحميل الملف' : 'Failed to load PDF file',\n          variant: 'destructive'\n        });\n      } finally {\n        setIsLoadingThumbnails(false);\n      }\n    };\n\n    loadThumbnails();\n  }, [file, renderPage, language, toast]);\n\n  useEffect(() => {\n    if (isProcessing) {\n      timerRef.current = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [isProcessing]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleDragStart = (e: React.DragEvent, index: number) => {\n    setDraggedIndex(index);\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('text/plain', index.toString());\n  };\n\n  const handleDragOver = (e: React.DragEvent, index: number) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n    setDragOverIndex(index);\n  };\n\n  const handleDragLeave = () => {\n    setDragOverIndex(null);\n  };\n\n  const handleDrop = (e: React.DragEvent, dropIndex: number) => {\n    e.preventDefault();\n    const dragIndex = parseInt(e.dataTransfer.getData('text/plain'));\n    \n    if (dragIndex !== dropIndex) {\n      const newOrder = [...pageOrder];\n      const [draggedItem] = newOrder.splice(dragIndex, 1);\n      newOrder.splice(dropIndex, 0, draggedItem);\n      setPageOrder(newOrder);\n    }\n    \n    setDraggedIndex(null);\n    setDragOverIndex(null);\n  };\n\n  const handleDragEnd = () => {\n    setDraggedIndex(null);\n    setDragOverIndex(null);\n  };\n\n  const handleResetOrder = () => {\n    setPageOrder(Array.from({ length: totalPages }, (_, i) => i + 1));\n  };\n\n  const hasOrderChanged = () => {\n    return pageOrder.some((page, index) => page !== index + 1);\n  };\n\n  const handleOrganize = async () => {\n    if (!file || !hasOrderChanged()) return;\n\n    setIsProcessing(true);\n    setElapsedTime(0);\n    setResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('pageOrder', JSON.stringify(pageOrder));\n\n      const response = await fetch('/api/pdf/organize', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        let errorMsg = 'Failed to organize PDF';\n        try {\n          const error = await response.json();\n          errorMsg = error.error || errorMsg;\n        } catch {\n          errorMsg = `Server error: ${response.statusText}`;\n        }\n        throw new Error(errorMsg);\n      }\n\n      const totalPagesResult = parseInt(response.headers.get('X-Total-Pages') || '0');\n      const serverElapsed = parseInt(response.headers.get('X-Elapsed-Time') || '0');\n\n      const blob = await response.blob();\n      const downloadUrl = window.URL.createObjectURL(blob);\n\n      setResult({\n        downloadUrl,\n        totalPages: totalPagesResult,\n        elapsedTime: serverElapsed\n      });\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: language === 'ar' \n          ? 'تم إعادة ترتيب الصفحات بنجاح'\n          : 'Pages have been reorganized successfully.',\n      });\n    } catch (error: any) {\n      console.error('Error organizing PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' \n          ? 'فشل في إعادة ترتيب الصفحات. يرجى المحاولة مرة أخرى.'\n          : 'Failed to reorganize pages. Please try again.'),\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!result) return;\n    \n    const a = document.createElement('a');\n    a.href = result.downloadUrl;\n    a.download = `organized-${file?.name || 'document.pdf'}`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    \n    window.URL.revokeObjectURL(result.downloadUrl);\n  };\n\n  const handleReset = () => {\n    if (result?.downloadUrl) {\n      window.URL.revokeObjectURL(result.downloadUrl);\n    }\n    setFile(null);\n    setResult(null);\n    setThumbnails([]);\n    setPageOrder([]);\n    setTotalPages(0);\n    setElapsedTime(0);\n  };\n\n  const getThumbnailForPage = (pageNum: number) => {\n    return thumbnails.find(t => t.pageNum === pageNum);\n  };\n\n  return (\n    <ToolPageLayout\n      title={language === 'ar' ? 'ترتيب PDF' : 'Organize PDF'}\n      description={language === 'ar' ? 'أعد ترتيب صفحات PDF الخاصة بك بالسحب والإفلات.' : 'Rearrange your PDF pages by drag and drop.'}\n      isProcessing={isProcessing}\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لإعادة ترتيب صفحاته' : 'Select a PDF file to reorganize its pages'}\n          />\n        </div>\n      ) : result ? (\n        <div className=\"space-y-8 max-w-2xl mx-auto\">\n          <div className=\"text-center space-y-4 py-8\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-100 text-green-600\">\n              <CheckCircle className=\"w-10 h-10\" />\n            </div>\n            <h3 className=\"text-2xl font-bold text-green-600\">\n              {language === 'ar' ? 'تم إعادة ترتيب الصفحات بنجاح!' : 'Pages Reorganized Successfully!'}\n            </h3>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"bg-secondary/30 rounded-xl p-4 text-center border border-border/50\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'إجمالي الصفحات' : 'Total Pages'}\n              </p>\n              <p className=\"text-2xl font-bold\" data-testid=\"text-total-pages\">\n                {result.totalPages}\n              </p>\n            </div>\n            <div className=\"bg-primary/10 rounded-xl p-4 text-center border border-primary/20\">\n              <p className=\"text-sm text-muted-foreground mb-1\">\n                {language === 'ar' ? 'الترتيب الجديد' : 'New Order'}\n              </p>\n              <p className=\"text-2xl font-bold text-primary\" data-testid=\"text-new-order\">\n                <CheckCircle className=\"inline h-6 w-6\" />\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex justify-center\">\n            <span className=\"text-sm font-medium text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30 px-4 py-2 rounded-full\">\n              {language === 'ar' ? `اكتمل في ${formatTime(Math.ceil(result.elapsedTime / 1000))}` : `Completed in ${formatTime(Math.ceil(result.elapsedTime / 1000))}`}\n            </span>\n          </div>\n\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center pt-4\">\n            <Button \n              size=\"lg\"\n              onClick={handleDownload}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-download-result\"\n            >\n              <Download className=\"h-5 w-5 me-2\" />\n              {language === 'ar' ? 'تحميل PDF' : 'Download PDF'}\n            </Button>\n            <Button \n              size=\"lg\"\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"rounded-full px-8 text-lg\"\n              data-testid=\"button-organize-another\"\n            >\n              {language === 'ar' ? 'ترتيب ملف آخر' : 'Organize Another'}\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-primary\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\" data-testid=\"text-file-name\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-file-size\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB {totalPages > 0 && `• ${totalPages} ${language === 'ar' ? 'صفحة' : 'pages'}`}\n              </p>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              {hasOrderChanged() && (\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\"\n                  onClick={handleResetOrder}\n                  className=\"text-muted-foreground\"\n                  data-testid=\"button-reset-order\"\n                >\n                  <RotateCcw className=\"h-4 w-4 me-1\" />\n                  {language === 'ar' ? 'إعادة ضبط' : 'Reset'}\n                </Button>\n              )}\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={handleReset}\n                data-testid=\"button-remove-file\"\n              >\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n          </div>\n\n          {isLoadingThumbnails && thumbnails.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 gap-4\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n              <p className=\"text-muted-foreground\">\n                {language === 'ar' ? 'جاري تحميل صفحات PDF...' : 'Loading PDF pages...'}\n              </p>\n            </div>\n          ) : (\n            <>\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-muted-foreground flex items-center gap-2\">\n                  <ArrowUpDown className=\"h-4 w-4\" />\n                  {language === 'ar' \n                    ? 'اسحب وأفلت الصفحات لإعادة ترتيبها'\n                    : 'Drag and drop pages to reorder them'}\n                </span>\n                {hasOrderChanged() && (\n                  <span className=\"font-medium text-primary\">\n                    {language === 'ar' ? 'تم تغيير الترتيب' : 'Order changed'}\n                  </span>\n                )}\n              </div>\n\n              <div \n                className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3\"\n                dir={direction}\n              >\n                {pageOrder.map((pageNum, index) => {\n                  const thumb = getThumbnailForPage(pageNum);\n                  const isDragging = draggedIndex === index;\n                  const isDragOver = dragOverIndex === index;\n                  \n                  return (\n                    <div\n                      key={`${pageNum}-${index}`}\n                      draggable\n                      onDragStart={(e) => handleDragStart(e, index)}\n                      onDragOver={(e) => handleDragOver(e, index)}\n                      onDragLeave={handleDragLeave}\n                      onDrop={(e) => handleDrop(e, index)}\n                      onDragEnd={handleDragEnd}\n                      className={`\n                        relative aspect-[3/4] rounded-lg border-2 overflow-hidden cursor-grab active:cursor-grabbing\n                        transition-all duration-200\n                        ${isDragging ? 'opacity-50 scale-95 border-primary' : 'opacity-100'}\n                        ${isDragOver ? 'border-primary border-dashed bg-primary/10 scale-105' : 'border-border/50'}\n                        hover:border-primary/50 hover:shadow-md\n                      `}\n                      data-testid={`page-thumbnail-${pageNum}`}\n                    >\n                      {thumb?.isLoading ? (\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-secondary/50\">\n                          <Loader2 className=\"h-6 w-6 animate-spin text-primary\" />\n                        </div>\n                      ) : thumb?.imageUrl ? (\n                        <img \n                          src={thumb.imageUrl} \n                          alt={`Page ${pageNum}`}\n                          className=\"w-full h-full object-contain bg-white\"\n                          draggable={false}\n                        />\n                      ) : (\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-secondary/30\">\n                          <FileText className=\"h-8 w-8 text-muted-foreground\" />\n                        </div>\n                      )}\n                      \n                      <div className=\"absolute top-1 left-1 right-1 flex items-center justify-between\">\n                        <span className=\"bg-black/70 text-white text-xs px-1.5 py-0.5 rounded font-medium\">\n                          {language === 'ar' ? 'ص' : 'P'}{pageNum}\n                        </span>\n                        <span className=\"bg-primary/90 text-white p-0.5 rounded\">\n                          <GripVertical className=\"h-3 w-3\" />\n                        </span>\n                      </div>\n                      \n                      <div className=\"absolute bottom-1 left-1 right-1 flex items-center justify-between\">\n                        <span className={`text-xs px-1.5 py-0.5 rounded font-medium ${\n                          index + 1 !== pageNum \n                            ? 'bg-primary text-white' \n                            : 'bg-black/50 text-white/80'\n                        }`}>\n                          #{index + 1}\n                        </span>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n\n              {hasOrderChanged() && (\n                <div className=\"bg-primary/10 border border-primary/30 rounded-xl p-4\">\n                  <div className=\"flex items-center gap-3 flex-wrap justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <ArrowUpDown className=\"h-5 w-5 text-primary shrink-0\" />\n                      <div>\n                        <p className=\"font-medium text-primary\">\n                          {language === 'ar' \n                            ? 'تم تغيير ترتيب الصفحات'\n                            : 'Page order has been changed'\n                          }\n                        </p>\n                        <p className=\"text-sm text-muted-foreground mt-0.5\">\n                          {language === 'ar' \n                            ? `الترتيب الجديد: ${pageOrder.join(', ')}`\n                            : `New order: ${pageOrder.join(', ')}`\n                          }\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={handleResetOrder}\n                        className=\"text-primary hover:text-primary hover:bg-primary/10\"\n                      >\n                        <RotateCcw className=\"h-4 w-4 me-1\" />\n                        {language === 'ar' ? 'إعادة ضبط' : 'Reset'}\n                      </Button>\n                      <Button \n                        size=\"default\"\n                        onClick={handleOrganize}\n                        disabled={isProcessing}\n                        className=\"rounded-full px-6\"\n                        data-testid=\"button-organize-pdf\"\n                      >\n                        <ArrowUpDown className=\"h-4 w-4 me-2\" />\n                        {language === 'ar' \n                          ? 'تطبيق الترتيب'\n                          : 'Apply Order'\n                        }\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </>\n          )}\n\n          {isProcessing && (\n            <div className=\"flex items-center justify-center gap-4 p-6 bg-primary/5 rounded-xl border border-primary/20\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              <div>\n                <p className=\"font-medium text-primary\">\n                  {language === 'ar' ? 'جاري إعادة ترتيب الصفحات...' : 'Reorganizing pages...'}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {language === 'ar' ? 'الوقت المنقضي:' : 'Elapsed time:'} {formatTime(elapsedTime)}\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":20509,"size_tokens":null},"client/src/pages/RepairPDF.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Wrench, Download, Loader2 } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Label } from '@/components/ui/label';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ntype RepairMethod = 'auto' | 'quick' | 'deep';\n\nexport default function RepairPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [repairMethod, setRepairMethod] = useState<RepairMethod>('auto');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [repairedBlob, setRepairedBlob] = useState<Blob | null>(null);\n  const [pdfPages, setPdfPages] = useState<string[]>([]);\n  const [totalPages, setTotalPages] = useState(0);\n  const [isLoadingPreview, setIsLoadingPreview] = useState(false);\n\n  // Render PDF pages using pdf.js when blob changes\n  useEffect(() => {\n    if (!repairedBlob) {\n      setPdfPages([]);\n      setTotalPages(0);\n      return;\n    }\n\n    const renderPdf = async () => {\n      setIsLoadingPreview(true);\n      try {\n        const arrayBuffer = await repairedBlob.arrayBuffer();\n        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        setTotalPages(pdf.numPages);\n\n        const pages: string[] = [];\n        for (let i = 1; i <= pdf.numPages; i++) {\n          const page = await pdf.getPage(i);\n          const scale = 1.5;\n          const viewport = page.getViewport({ scale });\n\n          const canvas = document.createElement('canvas');\n          const context = canvas.getContext('2d');\n          canvas.width = viewport.width;\n          canvas.height = viewport.height;\n\n          await page.render({\n            canvasContext: context!,\n            viewport: viewport\n          } as any).promise;\n\n          pages.push(canvas.toDataURL('image/png'));\n        }\n        setPdfPages(pages);\n      } catch (error) {\n        console.error('Error rendering PDF:', error);\n      } finally {\n        setIsLoadingPreview(false);\n      }\n    };\n\n    renderPdf();\n  }, [repairedBlob]);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setRepairedBlob(null);\n      setPdfPages([]);\n    }\n  };\n\n  const handleRepair = async () => {\n    if (!file) return;\n\n    setIsProcessing(true);\n    setRepairedBlob(null);\n    setPdfPages([]);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('method', repairMethod);\n\n      const response = await fetch('/api/pdf/repair', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to repair PDF');\n      }\n\n      const blob = await response.blob();\n      setRepairedBlob(blob);\n\n      toast({\n        title: language === 'ar' ? 'تم بنجاح!' : 'Success!',\n        description: t('tool.repair.success'),\n      });\n    } catch (error: any) {\n      console.error('Error repairing PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || t('tool.repair.error'),\n        variant: 'destructive'\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!repairedBlob || !file) return;\n    \n    const url = window.URL.createObjectURL(repairedBlob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `repaired-${file.name}`;\n    document.body.appendChild(a);\n    a.click();\n    window.URL.revokeObjectURL(url);\n    document.body.removeChild(a);\n  };\n\n  const handleReset = () => {\n    setFile(null);\n    setRepairedBlob(null);\n    setPdfPages([]);\n    setTotalPages(0);\n    setRepairMethod('auto');\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.repair.title')}\n      description={t('tool.repair.desc')}\n      isProcessing={isProcessing}\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={t('tool.repair.uploadDesc')}\n          />\n        </div>\n      ) : (\n        <div className=\"space-y-8\">\n          {/* File Info */}\n          <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50 max-w-2xl mx-auto\">\n            <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-gray-600\">\n              <FileText className=\"h-6 w-6\" />\n            </div>\n            <div className=\"flex-1\">\n              <p className=\"font-medium text-lg\">{file.name}</p>\n              <p className=\"text-sm text-muted-foreground\">\n                {(file.size / 1024 / 1024).toFixed(2)} MB\n              </p>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={handleReset}\n              data-testid=\"button-remove-file\"\n            >\n              <X className=\"h-5 w-5\" />\n            </Button>\n          </div>\n\n          {/* Repair Method Selection */}\n          <div className=\"bg-card p-6 rounded-2xl border border-border/50 space-y-4 shadow-sm max-w-2xl mx-auto\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Wrench className=\"w-5 h-5 text-[#11A05C]\" />\n              <h3 className=\"text-lg font-semibold\">\n                {t('tool.repair.method')}\n              </h3>\n            </div>\n            \n            <RadioGroup \n              value={repairMethod} \n              onValueChange={(v) => setRepairMethod(v as RepairMethod)}\n              className=\"space-y-3\"\n            >\n              <div className=\"flex items-start space-x-3 p-3 rounded-lg hover:bg-secondary/50 transition-colors\">\n                <RadioGroupItem value=\"auto\" id=\"auto\" className=\"mt-1\" data-testid=\"radio-auto\" />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"auto\" className=\"font-medium cursor-pointer\">\n                    {t('tool.repair.methodAuto')}\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {t('tool.repair.methodAutoDesc')}\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start space-x-3 p-3 rounded-lg hover:bg-secondary/50 transition-colors\">\n                <RadioGroupItem value=\"quick\" id=\"quick\" className=\"mt-1\" data-testid=\"radio-quick\" />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"quick\" className=\"font-medium cursor-pointer\">\n                    {t('tool.repair.methodQuick')}\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {t('tool.repair.methodQuickDesc')}\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start space-x-3 p-3 rounded-lg hover:bg-secondary/50 transition-colors\">\n                <RadioGroupItem value=\"deep\" id=\"deep\" className=\"mt-1\" data-testid=\"radio-deep\" />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"deep\" className=\"font-medium cursor-pointer\">\n                    {t('tool.repair.methodDeep')}\n                  </Label>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {t('tool.repair.methodDeepDesc')}\n                  </p>\n                </div>\n              </div>\n            </RadioGroup>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-wrap justify-center gap-4\">\n            <Button\n              onClick={handleRepair}\n              disabled={isProcessing}\n              className=\"gap-2 bg-[#11A05C] hover:bg-[#0d8a4d] text-white min-w-[200px]\"\n              data-testid=\"button-repair\"\n            >\n              {isProcessing ? (\n                <>\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  {t('tool.repair.repairing')}\n                </>\n              ) : (\n                <>\n                  <Wrench className=\"h-4 w-4\" />\n                  {t('tool.repair.repairButton')}\n                </>\n              )}\n            </Button>\n\n            {repairedBlob && (\n              <Button\n                onClick={handleDownload}\n                className=\"gap-2 bg-[#11A05C] hover:bg-[#0d8a4d] text-white\"\n                data-testid=\"button-download\"\n              >\n                <Download className=\"h-4 w-4\" />\n                {t('tool.repair.downloadRepaired')}\n              </Button>\n            )}\n          </div>\n\n          {/* PDF Preview after repair */}\n          {repairedBlob && (\n            <div className=\"border border-border rounded-lg overflow-hidden\">\n              <div className=\"bg-muted/50 px-4 py-2 border-b border-border flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">{t('tool.repair.preview')}</span>\n                </div>\n                {totalPages > 0 && (\n                  <span className=\"text-sm text-muted-foreground\">\n                    {language === 'ar' \n                      ? `${totalPages} صفحة` \n                      : `${totalPages} page${totalPages > 1 ? 's' : ''}`}\n                  </span>\n                )}\n              </div>\n              <div \n                className=\"bg-gray-100 p-4 overflow-y-auto max-h-[700px]\" \n                data-testid=\"pdf-preview\"\n              >\n                {isLoadingPreview ? (\n                  <div className=\"flex items-center justify-center h-[500px]\">\n                    <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n                  </div>\n                ) : pdfPages.length > 0 ? (\n                  <div className=\"flex flex-col items-center gap-4\">\n                    {pdfPages.map((pageUrl, index) => (\n                      <div key={index} className=\"relative\">\n                        <img \n                          src={pageUrl} \n                          alt={`Page ${index + 1}`}\n                          className=\"shadow-lg rounded max-w-full\"\n                        />\n                        <div className=\"absolute bottom-2 right-2 bg-black/60 text-white text-xs px-2 py-1 rounded\">\n                          {index + 1} / {totalPages}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"flex items-center justify-center h-[500px] text-muted-foreground\">\n                    {language === 'ar' ? 'جاري تحميل المعاينة...' : 'Loading preview...'}\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":11428,"size_tokens":null},"client/src/pages/WatermarkPDF.tsx":{"content":"import { useState, useRef, useEffect, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Type, Image, RotateCw, Layers, Grid3X3, Download } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Slider } from '@/components/ui/slider';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { PDFDocument, rgb, degrees, StandardFonts } from 'pdf-lib';\nimport * as pdfjs from 'pdfjs-dist';\n\npdfjs.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ntype WatermarkType = 'text' | 'image';\ntype Position = 'top-left' | 'top-center' | 'top-right' | 'center-left' | 'center' | 'center-right' | 'bottom-left' | 'bottom-center' | 'bottom-right';\ntype PageRange = 'all' | 'odd' | 'even' | 'custom';\ntype FontName = 'Helvetica' | 'Helvetica-Bold' | 'Times-Roman' | 'Times-Bold' | 'Courier' | 'Courier-Bold';\n\ninterface WatermarkSettings {\n  type: WatermarkType;\n  text: string;\n  fontName: FontName;\n  fontSize: number;\n  textColor: string;\n  imageDataUrl: string | null;\n  imageScale: number;\n  position: Position;\n  rotation: number;\n  opacity: number;\n  pageRange: PageRange;\n  customPages: string;\n  tileEnabled: boolean;\n  tileSpacingX: number;\n  tileSpacingY: number;\n}\n\nconst defaultSettings: WatermarkSettings = {\n  type: 'text',\n  text: 'CONFIDENTIAL',\n  fontName: 'Helvetica-Bold',\n  fontSize: 48,\n  textColor: '#888888',\n  imageDataUrl: null,\n  imageScale: 30,\n  position: 'center',\n  rotation: -45,\n  opacity: 30,\n  pageRange: 'all',\n  customPages: '',\n  tileEnabled: false,\n  tileSpacingX: 200,\n  tileSpacingY: 150,\n};\n\nconst fontOptions: { value: FontName; label: string }[] = [\n  { value: 'Helvetica', label: 'Helvetica' },\n  { value: 'Helvetica-Bold', label: 'Helvetica Bold' },\n  { value: 'Times-Roman', label: 'Times Roman' },\n  { value: 'Times-Bold', label: 'Times Bold' },\n  { value: 'Courier', label: 'Courier' },\n  { value: 'Courier-Bold', label: 'Courier Bold' },\n];\n\nconst positionOptions: { value: Position; labelEn: string; labelAr: string }[] = [\n  { value: 'top-left', labelEn: 'Top Left', labelAr: 'أعلى يسار' },\n  { value: 'top-center', labelEn: 'Top Center', labelAr: 'أعلى وسط' },\n  { value: 'top-right', labelEn: 'Top Right', labelAr: 'أعلى يمين' },\n  { value: 'center-left', labelEn: 'Center Left', labelAr: 'وسط يسار' },\n  { value: 'center', labelEn: 'Center', labelAr: 'وسط' },\n  { value: 'center-right', labelEn: 'Center Right', labelAr: 'وسط يمين' },\n  { value: 'bottom-left', labelEn: 'Bottom Left', labelAr: 'أسفل يسار' },\n  { value: 'bottom-center', labelEn: 'Bottom Center', labelAr: 'أسفل وسط' },\n  { value: 'bottom-right', labelEn: 'Bottom Right', labelAr: 'أسفل يمين' },\n];\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n    r: parseInt(result[1], 16) / 255,\n    g: parseInt(result[2], 16) / 255,\n    b: parseInt(result[3], 16) / 255,\n  } : { r: 0.5, g: 0.5, b: 0.5 };\n}\n\nfunction getPositionCoords(position: Position, pageWidth: number, pageHeight: number, elementWidth: number, elementHeight: number): { x: number; y: number } {\n  const margin = 50;\n  const positions: Record<Position, { x: number; y: number }> = {\n    'top-left': { x: margin, y: pageHeight - margin - elementHeight },\n    'top-center': { x: (pageWidth - elementWidth) / 2, y: pageHeight - margin - elementHeight },\n    'top-right': { x: pageWidth - margin - elementWidth, y: pageHeight - margin - elementHeight },\n    'center-left': { x: margin, y: (pageHeight - elementHeight) / 2 },\n    'center': { x: (pageWidth - elementWidth) / 2, y: (pageHeight - elementHeight) / 2 },\n    'center-right': { x: pageWidth - margin - elementWidth, y: (pageHeight - elementHeight) / 2 },\n    'bottom-left': { x: margin, y: margin },\n    'bottom-center': { x: (pageWidth - elementWidth) / 2, y: margin },\n    'bottom-right': { x: pageWidth - margin - elementWidth, y: margin },\n  };\n  return positions[position];\n}\n\nexport default function WatermarkPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [settings, setSettings] = useState<WatermarkSettings>(defaultSettings);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [previewPages, setPreviewPages] = useState<{ page: number; url: string; width: number; height: number }[]>([]);\n  const [totalPages, setTotalPages] = useState(0);\n  const [previewContainerWidth, setPreviewContainerWidth] = useState(400);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const previewContainerRef = useRef<HTMLDivElement>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n    }\n  };\n\n  const loadPreview = useCallback(async () => {\n    if (!file) return;\n    \n    try {\n      const arrayBuffer = await file.arrayBuffer();\n      const pdf = await pdfjs.getDocument({ data: arrayBuffer }).promise;\n      setTotalPages(pdf.numPages);\n      \n      const pages: { page: number; url: string; width: number; height: number }[] = [];\n      const maxPreviewPages = Math.min(pdf.numPages, 3);\n      \n      for (let i = 1; i <= maxPreviewPages; i++) {\n        const page = await pdf.getPage(i);\n        const scale = 1.5;\n        const viewport = page.getViewport({ scale });\n        const originalViewport = page.getViewport({ scale: 1 });\n        \n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d')!;\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        \n        await page.render({ canvasContext: context, viewport, canvas } as any).promise;\n        pages.push({ \n          page: i, \n          url: canvas.toDataURL(),\n          width: originalViewport.width,\n          height: originalViewport.height \n        });\n      }\n      \n      setPreviewPages(pages);\n    } catch (error) {\n      console.error('Error loading preview:', error);\n    }\n  }, [file]);\n\n  useEffect(() => {\n    loadPreview();\n  }, [loadPreview]);\n\n  useEffect(() => {\n    const container = previewContainerRef.current;\n    if (!container) return;\n    \n    const observer = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        setPreviewContainerWidth(entry.contentRect.width);\n      }\n    });\n    \n    observer.observe(container);\n    setPreviewContainerWidth(container.clientWidth || 400);\n    \n    return () => observer.disconnect();\n  }, []);\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const uploadedFile = e.target.files?.[0];\n    if (uploadedFile) {\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        setSettings(prev => ({ ...prev, imageDataUrl: event.target?.result as string }));\n      };\n      reader.readAsDataURL(uploadedFile);\n    }\n  };\n\n  const updateSetting = <K extends keyof WatermarkSettings>(key: K, value: WatermarkSettings[K]) => {\n    setSettings(prev => ({ ...prev, [key]: value }));\n  };\n\n  const shouldWatermarkPage = (pageNum: number): boolean => {\n    switch (settings.pageRange) {\n      case 'all': return true;\n      case 'odd': return pageNum % 2 === 1;\n      case 'even': return pageNum % 2 === 0;\n      case 'custom':\n        const ranges = settings.customPages.split(',').map(r => r.trim());\n        for (const range of ranges) {\n          if (range.includes('-')) {\n            const [start, end] = range.split('-').map(Number);\n            if (pageNum >= start && pageNum <= end) return true;\n          } else {\n            if (parseInt(range) === pageNum) return true;\n          }\n        }\n        return false;\n      default: return true;\n    }\n  };\n\n  const applyWatermark = async () => {\n    if (!file) return;\n    \n    if (settings.type === 'text' && !settings.text.trim()) {\n      toast({\n        title: language === 'ar' ? 'النص مطلوب' : 'Text required',\n        description: language === 'ar' ? 'يرجى إدخال نص العلامة المائية' : 'Please enter watermark text',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (settings.type === 'image' && !settings.imageDataUrl) {\n      toast({\n        title: language === 'ar' ? 'الصورة مطلوبة' : 'Image required',\n        description: language === 'ar' ? 'يرجى تحميل صورة للعلامة المائية' : 'Please upload a watermark image',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setIsProcessing(true);\n\n    try {\n      const arrayBuffer = await file.arrayBuffer();\n      const pdfDoc = await PDFDocument.load(arrayBuffer);\n      const pages = pdfDoc.getPages();\n\n      let font: any = null;\n      let watermarkImage: any = null;\n\n      if (settings.type === 'text') {\n        const fontMap: Record<FontName, any> = {\n          'Helvetica': StandardFonts.Helvetica,\n          'Helvetica-Bold': StandardFonts.HelveticaBold,\n          'Times-Roman': StandardFonts.TimesRoman,\n          'Times-Bold': StandardFonts.TimesRomanBold,\n          'Courier': StandardFonts.Courier,\n          'Courier-Bold': StandardFonts.CourierBold,\n        };\n        font = await pdfDoc.embedFont(fontMap[settings.fontName]);\n      } else if (settings.imageDataUrl) {\n        const imageData = settings.imageDataUrl.split(',')[1];\n        const imageBytes = Uint8Array.from(atob(imageData), c => c.charCodeAt(0));\n        \n        if (settings.imageDataUrl.includes('image/png')) {\n          watermarkImage = await pdfDoc.embedPng(imageBytes);\n        } else {\n          watermarkImage = await pdfDoc.embedJpg(imageBytes);\n        }\n      }\n\n      const color = hexToRgb(settings.textColor);\n      const opacity = settings.opacity / 100;\n\n      for (let i = 0; i < pages.length; i++) {\n        const pageNum = i + 1;\n        if (!shouldWatermarkPage(pageNum)) continue;\n\n        const page = pages[i];\n        const { width, height } = page.getSize();\n\n        if (settings.tileEnabled) {\n          const radians = (settings.rotation * Math.PI) / 180;\n          const cosR = Math.cos(radians);\n          const sinR = Math.sin(radians);\n          \n          let elementWidth = 0;\n          let elementHeight = 0;\n          \n          if (settings.type === 'text' && font) {\n            elementWidth = font.widthOfTextAtSize(settings.text, settings.fontSize);\n            elementHeight = settings.fontSize;\n          } else if (watermarkImage) {\n            const scale = settings.imageScale / 100;\n            const dims = watermarkImage.scale(scale);\n            elementWidth = dims.width;\n            elementHeight = dims.height;\n          }\n          \n          const corners = [\n            { x: 0, y: 0 },\n            { x: elementWidth, y: 0 },\n            { x: elementWidth, y: elementHeight },\n            { x: 0, y: elementHeight },\n          ];\n          const rotatedCorners = corners.map(c => ({\n            x: c.x * cosR - c.y * sinR,\n            y: c.x * sinR + c.y * cosR,\n          }));\n          const minX = Math.min(...rotatedCorners.map(c => c.x));\n          const maxX = Math.max(...rotatedCorners.map(c => c.x));\n          const minY = Math.min(...rotatedCorners.map(c => c.y));\n          const maxY = Math.max(...rotatedCorners.map(c => c.y));\n          const rotatedWidth = maxX - minX;\n          const rotatedHeight = maxY - minY;\n          \n          const centroidX = (minX + maxX) / 2;\n          const centroidY = (minY + maxY) / 2;\n          \n          const halfSpacingX = settings.tileSpacingX / 2;\n          const halfSpacingY = settings.tileSpacingY / 2;\n          const startCenterX = halfSpacingX;\n          const startCenterY = halfSpacingY;\n          \n          for (let centerY = startCenterY; centerY < height + rotatedHeight / 2; centerY += settings.tileSpacingY) {\n            for (let centerX = startCenterX; centerX < width + rotatedWidth / 2; centerX += settings.tileSpacingX) {\n              const drawX = centerX - centroidX;\n              const drawY = centerY - centroidY;\n              \n              const tileMinX = drawX + minX;\n              const tileMaxX = drawX + maxX;\n              const tileMinY = drawY + minY;\n              const tileMaxY = drawY + maxY;\n              \n              if (tileMaxX < 0 || tileMinX > width || tileMaxY < 0 || tileMinY > height) {\n                continue;\n              }\n              \n              if (settings.type === 'text' && font) {\n                page.drawText(settings.text, {\n                  x: drawX,\n                  y: drawY,\n                  size: settings.fontSize,\n                  font,\n                  color: rgb(color.r, color.g, color.b),\n                  opacity,\n                  rotate: degrees(settings.rotation),\n                });\n              } else if (watermarkImage) {\n                page.drawImage(watermarkImage, {\n                  x: drawX,\n                  y: drawY,\n                  width: elementWidth,\n                  height: elementHeight,\n                  opacity,\n                  rotate: degrees(settings.rotation),\n                });\n              }\n            }\n          }\n        } else {\n          let elementWidth = 0;\n          let elementHeight = 0;\n\n          if (settings.type === 'text' && font) {\n            elementWidth = font.widthOfTextAtSize(settings.text, settings.fontSize);\n            elementHeight = settings.fontSize;\n          } else if (watermarkImage) {\n            const scale = settings.imageScale / 100;\n            const dims = watermarkImage.scale(scale);\n            elementWidth = dims.width;\n            elementHeight = dims.height;\n          }\n\n          const pos = getPositionCoords(settings.position, width, height, elementWidth, elementHeight);\n\n          if (settings.type === 'text' && font) {\n            page.drawText(settings.text, {\n              x: pos.x,\n              y: pos.y,\n              size: settings.fontSize,\n              font,\n              color: rgb(color.r, color.g, color.b),\n              opacity,\n              rotate: degrees(settings.rotation),\n            });\n          } else if (watermarkImage) {\n            const scale = settings.imageScale / 100;\n            const imgDims = watermarkImage.scale(scale);\n            page.drawImage(watermarkImage, {\n              x: pos.x,\n              y: pos.y,\n              width: imgDims.width,\n              height: imgDims.height,\n              opacity,\n              rotate: degrees(settings.rotation),\n            });\n          }\n        }\n      }\n\n      const pdfBytes = await pdfDoc.save();\n      const blob = new Blob([pdfBytes], { type: 'application/pdf' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `watermarked-${file.name}`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      toast({\n        title: language === 'ar' ? 'تم بنجاح!' : 'Success!',\n        description: language === 'ar' ? 'تمت إضافة العلامة المائية بنجاح' : 'Watermark has been applied successfully',\n      });\n    } catch (error: any) {\n      console.error('Error applying watermark:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || (language === 'ar' ? 'فشل في إضافة العلامة المائية' : 'Failed to apply watermark'),\n        variant: 'destructive'\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.watermark.title')}\n      description={t('tool.watermark.desc')}\n      isProcessing={isProcessing}\n      actionButton={\n        file && (\n          <Button \n            size=\"lg\" \n            onClick={applyWatermark} \n            className=\"rounded-full px-8 text-lg min-w-[200px]\"\n            data-testid=\"button-apply-watermark\"\n          >\n            <Download className=\"h-5 w-5 me-2\" />\n            {language === 'ar' ? 'تطبيق وتحميل' : 'Apply & Download'}\n          </Button>\n        )\n      }\n    >\n      {!file ? (\n        <div className=\"py-12\">\n          <FileUploader \n            onFilesSelected={handleFileSelected} \n            multiple={false}\n            description={language === 'ar' ? 'اختر ملف PDF لإضافة علامة مائية' : 'Select a PDF file to add watermark'}\n          />\n        </div>\n      ) : (\n        <div className=\"grid lg:grid-cols-2 gap-8\">\n          {/* Settings Panel */}\n          <div className=\"space-y-6\">\n            {/* File Info */}\n            <div className=\"flex items-center gap-4 p-4 bg-secondary/30 rounded-xl border border-border/50\">\n              <div className=\"h-12 w-12 rounded-lg bg-white flex items-center justify-center shadow-sm text-gray-600\">\n                <FileText className=\"h-6 w-6\" />\n              </div>\n              <div className=\"flex-1\">\n                <p className=\"font-medium text-lg\">{file.name}</p>\n                <p className=\"text-sm text-muted-foreground\">\n                  {totalPages} {language === 'ar' ? 'صفحة' : 'pages'} • {(file.size / 1024 / 1024).toFixed(2)} MB\n                </p>\n              </div>\n              <Button variant=\"ghost\" size=\"icon\" onClick={() => { setFile(null); setPreviewPages([]); }} data-testid=\"button-remove-file\">\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n\n            {/* Watermark Type */}\n            <Tabs value={settings.type} onValueChange={(v) => updateSetting('type', v as WatermarkType)} className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"text\" className=\"gap-2\" data-testid=\"tab-text-watermark\">\n                  <Type className=\"h-4 w-4\" />\n                  {language === 'ar' ? 'نص' : 'Text'}\n                </TabsTrigger>\n                <TabsTrigger value=\"image\" className=\"gap-2\" data-testid=\"tab-image-watermark\">\n                  <Image className=\"h-4 w-4\" />\n                  {language === 'ar' ? 'صورة' : 'Image'}\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"text\" className=\"space-y-4 mt-4\">\n                <div className=\"space-y-2\">\n                  <Label>{language === 'ar' ? 'نص العلامة المائية' : 'Watermark Text'}</Label>\n                  <Input \n                    value={settings.text}\n                    onChange={(e) => updateSetting('text', e.target.value)}\n                    placeholder=\"CONFIDENTIAL\"\n                    data-testid=\"input-watermark-text\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>{language === 'ar' ? 'الخط' : 'Font'}</Label>\n                    <Select value={settings.fontName} onValueChange={(v) => updateSetting('fontName', v as FontName)}>\n                      <SelectTrigger data-testid=\"select-font\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {fontOptions.map(opt => (\n                          <SelectItem key={opt.value} value={opt.value}>{opt.label}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>{language === 'ar' ? 'الحجم' : 'Size'}: {settings.fontSize}pt</Label>\n                    <Slider \n                      value={[settings.fontSize]} \n                      onValueChange={([v]) => updateSetting('fontSize', v)}\n                      min={12}\n                      max={200}\n                      step={1}\n                      data-testid=\"slider-font-size\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{language === 'ar' ? 'اللون' : 'Color'}</Label>\n                  <div className=\"flex gap-2\">\n                    <Input \n                      type=\"color\"\n                      value={settings.textColor}\n                      onChange={(e) => updateSetting('textColor', e.target.value)}\n                      className=\"w-16 h-10 p-1 cursor-pointer\"\n                      data-testid=\"input-text-color\"\n                    />\n                    <Input \n                      value={settings.textColor}\n                      onChange={(e) => updateSetting('textColor', e.target.value)}\n                      className=\"flex-1\"\n                      data-testid=\"input-text-color-hex\"\n                    />\n                  </div>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"image\" className=\"space-y-4 mt-4\">\n                <div className=\"space-y-2\">\n                  <Label>{language === 'ar' ? 'تحميل صورة' : 'Upload Image'}</Label>\n                  <input \n                    type=\"file\" \n                    ref={imageInputRef}\n                    accept=\"image/png,image/jpeg,image/jpg\"\n                    onChange={handleImageUpload}\n                    className=\"hidden\"\n                  />\n                  <Button \n                    variant=\"outline\" \n                    onClick={() => imageInputRef.current?.click()}\n                    className=\"w-full\"\n                    data-testid=\"button-upload-image\"\n                  >\n                    <Image className=\"h-4 w-4 me-2\" />\n                    {settings.imageDataUrl \n                      ? (language === 'ar' ? 'تغيير الصورة' : 'Change Image')\n                      : (language === 'ar' ? 'اختر صورة (PNG/JPG)' : 'Choose Image (PNG/JPG)')\n                    }\n                  </Button>\n                  {settings.imageDataUrl && (\n                    <div className=\"mt-2 p-2 border rounded-lg bg-secondary/20\">\n                      <img \n                        src={settings.imageDataUrl} \n                        alt=\"Watermark preview\" \n                        className=\"max-h-20 mx-auto\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{language === 'ar' ? 'الحجم' : 'Scale'}: {settings.imageScale}%</Label>\n                  <Slider \n                    value={[settings.imageScale]} \n                    onValueChange={([v]) => updateSetting('imageScale', v)}\n                    min={5}\n                    max={100}\n                    step={1}\n                    data-testid=\"slider-image-scale\"\n                  />\n                </div>\n              </TabsContent>\n            </Tabs>\n\n            {/* Position */}\n            <div className=\"bg-card p-4 rounded-xl border border-border/50 space-y-4\">\n              <div className=\"flex items-center gap-2\">\n                <Layers className=\"w-5 h-5 text-primary\" />\n                <h3 className=\"font-semibold\">{language === 'ar' ? 'الموضع' : 'Position'}</h3>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>{language === 'ar' ? 'الموقع' : 'Location'}</Label>\n                <Select value={settings.position} onValueChange={(v) => updateSetting('position', v as Position)}>\n                  <SelectTrigger data-testid=\"select-position\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {positionOptions.map(opt => (\n                      <SelectItem key={opt.value} value={opt.value}>\n                        {language === 'ar' ? opt.labelAr : opt.labelEn}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Position Grid Visual */}\n              <div className=\"grid grid-cols-3 gap-1 w-32 mx-auto\">\n                {positionOptions.map(opt => (\n                  <button\n                    key={opt.value}\n                    onClick={() => updateSetting('position', opt.value)}\n                    className={`w-10 h-10 rounded border-2 transition-all ${\n                      settings.position === opt.value \n                        ? 'bg-primary border-primary' \n                        : 'bg-secondary/50 border-border hover:border-primary/50'\n                    }`}\n                    data-testid={`position-${opt.value}`}\n                  />\n                ))}\n              </div>\n            </div>\n\n            {/* Rotation & Opacity */}\n            <div className=\"bg-card p-4 rounded-xl border border-border/50 space-y-4\">\n              <div className=\"flex items-center gap-2\">\n                <RotateCw className=\"w-5 h-5 text-primary\" />\n                <h3 className=\"font-semibold\">{language === 'ar' ? 'التدوير والشفافية' : 'Rotation & Opacity'}</h3>\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between\">\n                  <Label>{language === 'ar' ? 'التدوير' : 'Rotation'}: {settings.rotation}°</Label>\n                  <div className=\"flex gap-1\">\n                    {[-45, 0, 45].map(angle => (\n                      <Button \n                        key={angle}\n                        size=\"sm\"\n                        variant={settings.rotation === angle ? 'default' : 'outline'}\n                        onClick={() => updateSetting('rotation', angle)}\n                        className=\"h-6 px-2 text-xs\"\n                      >\n                        {angle}°\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n                <Slider \n                  value={[settings.rotation]} \n                  onValueChange={([v]) => updateSetting('rotation', v)}\n                  min={-180}\n                  max={180}\n                  step={1}\n                  data-testid=\"slider-rotation\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>{language === 'ar' ? 'الشفافية' : 'Opacity'}: {settings.opacity}%</Label>\n                <Slider \n                  value={[settings.opacity]} \n                  onValueChange={([v]) => updateSetting('opacity', v)}\n                  min={1}\n                  max={100}\n                  step={1}\n                  data-testid=\"slider-opacity\"\n                />\n              </div>\n            </div>\n\n            {/* Page Range */}\n            <div className=\"bg-card p-4 rounded-xl border border-border/50 space-y-4\">\n              <h3 className=\"font-semibold\">{language === 'ar' ? 'نطاق الصفحات' : 'Page Range'}</h3>\n              \n              <Select value={settings.pageRange} onValueChange={(v) => updateSetting('pageRange', v as PageRange)}>\n                <SelectTrigger data-testid=\"select-page-range\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">{language === 'ar' ? 'كل الصفحات' : 'All Pages'}</SelectItem>\n                  <SelectItem value=\"odd\">{language === 'ar' ? 'الصفحات الفردية' : 'Odd Pages Only'}</SelectItem>\n                  <SelectItem value=\"even\">{language === 'ar' ? 'الصفحات الزوجية' : 'Even Pages Only'}</SelectItem>\n                  <SelectItem value=\"custom\">{language === 'ar' ? 'صفحات محددة' : 'Custom Pages'}</SelectItem>\n                </SelectContent>\n              </Select>\n\n              {settings.pageRange === 'custom' && (\n                <Input \n                  value={settings.customPages}\n                  onChange={(e) => updateSetting('customPages', e.target.value)}\n                  placeholder=\"e.g., 1,3,5-10\"\n                  data-testid=\"input-custom-pages\"\n                />\n              )}\n            </div>\n\n            {/* Tile Pattern */}\n            <div className=\"bg-card p-4 rounded-xl border border-border/50 space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <Grid3X3 className=\"w-5 h-5 text-primary\" />\n                  <h3 className=\"font-semibold\">{language === 'ar' ? 'نمط التكرار' : 'Tile Pattern'}</h3>\n                </div>\n                <Switch \n                  checked={settings.tileEnabled}\n                  onCheckedChange={(v) => updateSetting('tileEnabled', v)}\n                  data-testid=\"switch-tile-enabled\"\n                />\n              </div>\n\n              {settings.tileEnabled && (\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>{language === 'ar' ? 'المسافة الأفقية' : 'Horizontal Spacing'}: {settings.tileSpacingX}px</Label>\n                    <Slider \n                      value={[settings.tileSpacingX]} \n                      onValueChange={([v]) => updateSetting('tileSpacingX', v)}\n                      min={50}\n                      max={500}\n                      step={10}\n                      data-testid=\"slider-tile-spacing-x\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>{language === 'ar' ? 'المسافة العمودية' : 'Vertical Spacing'}: {settings.tileSpacingY}px</Label>\n                    <Slider \n                      value={[settings.tileSpacingY]} \n                      onValueChange={([v]) => updateSetting('tileSpacingY', v)}\n                      min={50}\n                      max={500}\n                      step={10}\n                      data-testid=\"slider-tile-spacing-y\"\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Preview Panel */}\n          <div className=\"bg-card p-4 rounded-xl border border-border/50\">\n            <h3 className=\"font-semibold mb-4 text-center\">\n              {language === 'ar' ? 'معاينة (أول 3 صفحات)' : 'Preview (first 3 pages)'}\n            </h3>\n            \n            <div ref={previewContainerRef} className=\"space-y-4 max-h-[600px] overflow-y-auto\">\n              {previewPages.map((pageData) => (\n                <div key={pageData.page} className=\"relative border rounded-lg overflow-hidden bg-white\">\n                  <img \n                    src={pageData.url} \n                    alt={`Page ${pageData.page}`}\n                    className=\"w-full\"\n                    data-testid={`preview-page-${pageData.page}`}\n                  />\n                  \n                  {/* Watermark Overlay Preview */}\n                  {shouldWatermarkPage(pageData.page) && (\n                    <div \n                      className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"\n                      style={{\n                        ...(settings.tileEnabled ? {} : {\n                          alignItems: settings.position.includes('top') ? 'flex-start' \n                            : settings.position.includes('bottom') ? 'flex-end' : 'center',\n                          justifyContent: settings.position.includes('left') ? 'flex-start'\n                            : settings.position.includes('right') ? 'flex-end' : 'center',\n                          padding: '20px',\n                        })\n                      }}\n                    >\n                      {settings.tileEnabled ? (\n                        <div className=\"absolute inset-0 overflow-hidden\">\n                          {(() => {\n                            const pdfWidth = pageData.width;\n                            const pdfHeight = pageData.height;\n                            const scaleFactor = previewContainerWidth / pdfWidth;\n                            const previewFontSize = settings.fontSize * scaleFactor;\n                            const previewImageWidth = settings.imageScale * scaleFactor;\n                            \n                            const radians = (settings.rotation * Math.PI) / 180;\n                            const cosR = Math.cos(radians);\n                            const sinR = Math.sin(radians);\n                            \n                            const elementWidth = settings.type === 'text' \n                              ? settings.fontSize * settings.text.length * 0.55\n                              : settings.imageScale;\n                            const elementHeight = settings.type === 'text'\n                              ? settings.fontSize\n                              : settings.imageScale * 0.75;\n                            \n                            const corners = [\n                              { x: 0, y: 0 },\n                              { x: elementWidth, y: 0 },\n                              { x: elementWidth, y: elementHeight },\n                              { x: 0, y: elementHeight },\n                            ];\n                            const rotatedCorners = corners.map(c => ({\n                              x: c.x * cosR - c.y * sinR,\n                              y: c.x * sinR + c.y * cosR,\n                            }));\n                            const minX = Math.min(...rotatedCorners.map(c => c.x));\n                            const maxX = Math.max(...rotatedCorners.map(c => c.x));\n                            const minY = Math.min(...rotatedCorners.map(c => c.y));\n                            const maxY = Math.max(...rotatedCorners.map(c => c.y));\n                            const rotatedWidth = maxX - minX;\n                            const rotatedHeight = maxY - minY;\n                            \n                            const centroidX = (minX + maxX) / 2;\n                            const centroidY = (minY + maxY) / 2;\n                            \n                            const halfSpacingX = settings.tileSpacingX / 2;\n                            const halfSpacingY = settings.tileSpacingY / 2;\n                            const startCenterX = halfSpacingX;\n                            const startCenterY = halfSpacingY;\n                            \n                            const items = [];\n                            for (let centerY = startCenterY; centerY < pdfHeight + rotatedHeight / 2; centerY += settings.tileSpacingY) {\n                              for (let centerX = startCenterX; centerX < pdfWidth + rotatedWidth / 2; centerX += settings.tileSpacingX) {\n                                const drawX = centerX - centroidX;\n                                const drawY = centerY - centroidY;\n                                \n                                const tileMinX = drawX + minX;\n                                const tileMaxX = drawX + maxX;\n                                const tileMinY = drawY + minY;\n                                const tileMaxY = drawY + maxY;\n                                \n                                if (tileMaxX < 0 || tileMinX > pdfWidth || tileMaxY < 0 || tileMinY > pdfHeight) {\n                                  continue;\n                                }\n                                \n                                const xPercent = (drawX / pdfWidth) * 100;\n                                const yPercent = (drawY / pdfHeight) * 100;\n                                \n                                items.push(\n                                  <div\n                                    key={`${centerY}-${centerX}`}\n                                    className=\"absolute\"\n                                    style={{\n                                      left: `${xPercent}%`,\n                                      bottom: `${yPercent}%`,\n                                      transform: `rotate(${settings.rotation}deg)`,\n                                      transformOrigin: 'bottom left',\n                                      opacity: settings.opacity / 100,\n                                    }}\n                                  >\n                                    {settings.type === 'text' ? (\n                                      <span \n                                        style={{ \n                                          color: settings.textColor,\n                                          fontSize: `${previewFontSize}px`,\n                                          fontFamily: settings.fontName.includes('Courier') ? 'monospace' \n                                            : settings.fontName.includes('Times') ? 'serif' : 'sans-serif',\n                                          fontWeight: settings.fontName.includes('Bold') ? 'bold' : 'normal',\n                                          whiteSpace: 'nowrap',\n                                        }}\n                                      >\n                                        {settings.text}\n                                      </span>\n                                    ) : settings.imageDataUrl && (\n                                      <img \n                                        src={settings.imageDataUrl} \n                                        alt=\"Watermark\"\n                                        style={{ \n                                          width: `${previewImageWidth}px`,\n                                        }}\n                                      />\n                                    )}\n                                  </div>\n                                );\n                              }\n                            }\n                            return items;\n                          })()}\n                        </div>\n                      ) : (\n                        (() => {\n                          const scaleFactor = previewContainerWidth / pageData.width;\n                          const previewFontSize = settings.fontSize * scaleFactor;\n                          const previewImageWidth = settings.imageScale * scaleFactor;\n                          return (\n                            <div\n                              style={{\n                                transform: `rotate(${settings.rotation}deg)`,\n                                opacity: settings.opacity / 100,\n                              }}\n                            >\n                              {settings.type === 'text' ? (\n                                <span \n                                  style={{ \n                                    color: settings.textColor,\n                                    fontSize: `${previewFontSize}px`,\n                                    fontFamily: settings.fontName.includes('Courier') ? 'monospace' \n                                      : settings.fontName.includes('Times') ? 'serif' : 'sans-serif',\n                                    fontWeight: settings.fontName.includes('Bold') ? 'bold' : 'normal',\n                                  }}\n                                >\n                                  {settings.text}\n                                </span>\n                              ) : settings.imageDataUrl && (\n                                <img \n                                  src={settings.imageDataUrl} \n                                  alt=\"Watermark\"\n                                  style={{ \n                                    width: `${previewImageWidth}px`,\n                                  }}\n                                />\n                              )}\n                            </div>\n                          );\n                        })()\n                      )}\n                    </div>\n                  )}\n                  \n                  <div className=\"absolute bottom-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded\">\n                    {language === 'ar' ? 'صفحة' : 'Page'} {pageData.page}\n                  </div>\n                </div>\n              ))}\n            </div>\n            \n            {totalPages > 3 && (\n              <p className=\"text-xs text-muted-foreground text-center mt-2\">\n                {language === 'ar' \n                  ? `+ ${totalPages - 3} صفحات أخرى`\n                  : `+ ${totalPages - 3} more pages`\n                }\n              </p>\n            )}\n          </div>\n        </div>\n      )}\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":41032,"size_tokens":null},"client/src/pages/HTMLtoPDF.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Switch } from '@/components/ui/switch';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Code, Globe, Download, Loader2, RotateCcw, Eye, FileText } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\nexport default function HTMLtoPDF() {\n  const { t, language, direction } = useLanguage();\n  const { toast } = useToast();\n  \n  const [inputType, setInputType] = useState<'html' | 'url'>('html');\n  const [htmlContent, setHtmlContent] = useState('');\n  const [urlContent, setUrlContent] = useState('');\n  const [pageSize, setPageSize] = useState('A4');\n  const [orientation, setOrientation] = useState<'portrait' | 'landscape'>('portrait');\n  const [margins, setMargins] = useState<'none' | 'normal' | 'wide'>('normal');\n  const [includeBackground, setIncludeBackground] = useState(true);\n  const [isConverting, setIsConverting] = useState(false);\n  const [pdfUrl, setPdfUrl] = useState<string | null>(null);\n  const [pdfBlob, setPdfBlob] = useState<Blob | null>(null);\n  const [showPreview, setShowPreview] = useState(false);\n  const [pdfPages, setPdfPages] = useState<string[]>([]);\n  const [totalPages, setTotalPages] = useState(0);\n  const [isLoadingPreview, setIsLoadingPreview] = useState(false);\n\n  // Render PDF pages using pdf.js when blob changes\n  useEffect(() => {\n    if (!pdfBlob) {\n      setPdfPages([]);\n      setTotalPages(0);\n      return;\n    }\n\n    const renderPdf = async () => {\n      setIsLoadingPreview(true);\n      try {\n        const arrayBuffer = await pdfBlob.arrayBuffer();\n        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        setTotalPages(pdf.numPages);\n\n        const pages: string[] = [];\n        for (let i = 1; i <= pdf.numPages; i++) {\n          const page = await pdf.getPage(i);\n          const scale = 1.5;\n          const viewport = page.getViewport({ scale });\n\n          const canvas = document.createElement('canvas');\n          const context = canvas.getContext('2d');\n          canvas.width = viewport.width;\n          canvas.height = viewport.height;\n\n          await page.render({\n            canvasContext: context!,\n            viewport: viewport\n          } as any).promise;\n\n          pages.push(canvas.toDataURL('image/png'));\n        }\n        setPdfPages(pages);\n      } catch (error) {\n        console.error('Error rendering PDF:', error);\n      } finally {\n        setIsLoadingPreview(false);\n      }\n    };\n\n    renderPdf();\n  }, [pdfBlob]);\n\n  const sampleHtml = `<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body { font-family: Arial, sans-serif; padding: 40px; }\n    h1 { color: #11A05C; }\n    p { line-height: 1.6; }\n    .highlight { background-color: #e8f5e9; padding: 10px; border-radius: 5px; }\n  </style>\n</head>\n<body>\n  <h1>Welcome to PDF Master</h1>\n  <p>This is a sample HTML document that will be converted to PDF.</p>\n  <div class=\"highlight\">\n    <strong>Features:</strong>\n    <ul>\n      <li>Custom page sizes</li>\n      <li>Portrait or landscape orientation</li>\n      <li>Adjustable margins</li>\n      <li>Background colors and images</li>\n    </ul>\n  </div>\n</body>\n</html>`;\n\n  const handleLoadSample = () => {\n    setHtmlContent(sampleHtml);\n    setShowPreview(true);\n  };\n\n  const handlePreview = () => {\n    if (inputType === 'html' && htmlContent.trim()) {\n      setShowPreview(true);\n    } else if (inputType === 'url' && urlContent.trim()) {\n      setShowPreview(true);\n    }\n  };\n\n  const validateUrl = (url: string): boolean => {\n    try {\n      const parsed = new URL(url);\n      return ['http:', 'https:'].includes(parsed.protocol);\n    } catch {\n      return false;\n    }\n  };\n\n  const handleConvert = async () => {\n    const content = inputType === 'html' ? htmlContent.trim() : urlContent.trim();\n    \n    if (!content) {\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: t(inputType === 'html' ? 'tool.htmlToPdf.error.emptyHtml' : 'tool.htmlToPdf.error.emptyUrl'),\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (inputType === 'url' && !validateUrl(content)) {\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: t('tool.htmlToPdf.error.invalidUrl'),\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    setIsConverting(true);\n    setPdfUrl(null);\n\n    try {\n      const response = await fetch('/api/pdf/from-html', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          type: inputType,\n          content,\n          pageSize,\n          orientation,\n          margins,\n          includeBackground\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to convert to PDF');\n      }\n\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      setPdfUrl(url);\n      setPdfBlob(blob);\n\n      toast({\n        title: language === 'ar' ? 'تم!' : 'Success!',\n        description: t('tool.htmlToPdf.success'),\n      });\n    } catch (error: any) {\n      console.error('Error converting to PDF:', error);\n      toast({\n        title: language === 'ar' ? 'خطأ' : 'Error',\n        description: error.message || t('tool.htmlToPdf.error.conversion'),\n        variant: 'destructive'\n      });\n    } finally {\n      setIsConverting(false);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!pdfUrl) return;\n    \n    const a = document.createElement('a');\n    a.href = pdfUrl;\n    a.download = 'converted.pdf';\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n  };\n\n  const handleReset = () => {\n    if (pdfUrl) {\n      window.URL.revokeObjectURL(pdfUrl);\n    }\n    setHtmlContent('');\n    setUrlContent('');\n    setPdfUrl(null);\n    setPdfBlob(null);\n    setPdfPages([]);\n    setTotalPages(0);\n    setShowPreview(false);\n    setPageSize('A4');\n    setOrientation('portrait');\n    setMargins('normal');\n    setIncludeBackground(true);\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.htmlToPdf.title')}\n      description={t('tool.htmlToPdf.desc')}\n      isProcessing={isConverting}\n    >\n      <div className=\"space-y-8\">\n        {/* Input Type Tabs */}\n        <Tabs value={inputType} onValueChange={(v) => { setInputType(v as 'html' | 'url'); setShowPreview(false); }}>\n          <TabsList className=\"grid w-full grid-cols-2 max-w-md mx-auto\">\n            <TabsTrigger value=\"html\" className=\"gap-2\" data-testid=\"tab-html\">\n              <Code className=\"h-4 w-4\" />\n              {t('tool.htmlToPdf.htmlCode')}\n            </TabsTrigger>\n            <TabsTrigger value=\"url\" className=\"gap-2\" data-testid=\"tab-url\">\n              <Globe className=\"h-4 w-4\" />\n              {t('tool.htmlToPdf.webUrl')}\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"html\" className=\"mt-6\">\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between items-center\">\n                <Label htmlFor=\"html-input\">{t('tool.htmlToPdf.htmlCode')}</Label>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleLoadSample}\n                  data-testid=\"button-load-sample\"\n                >\n                  {language === 'ar' ? 'تحميل مثال' : 'Load Sample'}\n                </Button>\n              </div>\n              <Textarea\n                id=\"html-input\"\n                value={htmlContent}\n                onChange={(e) => setHtmlContent(e.target.value)}\n                placeholder={t('tool.htmlToPdf.enterHtml')}\n                className=\"min-h-[300px] font-mono text-sm\"\n                dir=\"ltr\"\n                data-testid=\"input-html\"\n              />\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"url\" className=\"mt-6\">\n            <div className=\"space-y-4\">\n              <Label htmlFor=\"url-input\">{t('tool.htmlToPdf.webUrl')}</Label>\n              <Input\n                id=\"url-input\"\n                type=\"url\"\n                value={urlContent}\n                onChange={(e) => setUrlContent(e.target.value)}\n                placeholder={t('tool.htmlToPdf.enterUrl')}\n                dir=\"ltr\"\n                data-testid=\"input-url\"\n              />\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        {/* Preview Section */}\n        {showPreview && inputType === 'html' && htmlContent && (\n          <div className=\"border border-border rounded-lg overflow-hidden\">\n            <div className=\"bg-muted/50 px-4 py-2 border-b border-border flex items-center gap-2\">\n              <Eye className=\"h-4 w-4 text-muted-foreground\" />\n              <span className=\"text-sm font-medium\">{t('tool.htmlToPdf.preview')}</span>\n            </div>\n            <iframe\n              srcDoc={htmlContent}\n              className=\"w-full h-[400px] bg-white\"\n              title=\"HTML Preview\"\n              sandbox=\"allow-same-origin\"\n              data-testid=\"preview-iframe\"\n            />\n          </div>\n        )}\n\n        {/* Options */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-6 bg-muted/30 rounded-xl\">\n          {/* Page Size */}\n          <div className=\"space-y-2\">\n            <Label>{t('tool.htmlToPdf.pageSize')}</Label>\n            <Select value={pageSize} onValueChange={setPageSize}>\n              <SelectTrigger data-testid=\"select-pagesize\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"A4\">A4</SelectItem>\n                <SelectItem value=\"A3\">A3</SelectItem>\n                <SelectItem value=\"Letter\">Letter</SelectItem>\n                <SelectItem value=\"Legal\">Legal</SelectItem>\n                <SelectItem value=\"Tabloid\">Tabloid</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Orientation */}\n          <div className=\"space-y-2\">\n            <Label>{t('tool.htmlToPdf.orientation')}</Label>\n            <RadioGroup \n              value={orientation} \n              onValueChange={(v) => setOrientation(v as 'portrait' | 'landscape')}\n              className=\"flex gap-4\"\n            >\n              <div className=\"flex items-center space-x-2\">\n                <RadioGroupItem value=\"portrait\" id=\"portrait\" data-testid=\"radio-portrait\" />\n                <Label htmlFor=\"portrait\" className=\"cursor-pointer\">{t('tool.htmlToPdf.portrait')}</Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <RadioGroupItem value=\"landscape\" id=\"landscape\" data-testid=\"radio-landscape\" />\n                <Label htmlFor=\"landscape\" className=\"cursor-pointer\">{t('tool.htmlToPdf.landscape')}</Label>\n              </div>\n            </RadioGroup>\n          </div>\n\n          {/* Margins */}\n          <div className=\"space-y-2\">\n            <Label>{t('tool.htmlToPdf.margins')}</Label>\n            <Select value={margins} onValueChange={(v) => setMargins(v as 'none' | 'normal' | 'wide')}>\n              <SelectTrigger data-testid=\"select-margins\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"none\">{t('tool.htmlToPdf.noMargins')}</SelectItem>\n                <SelectItem value=\"normal\">{t('tool.htmlToPdf.normalMargins')}</SelectItem>\n                <SelectItem value=\"wide\">{t('tool.htmlToPdf.wideMargins')}</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Include Background */}\n          <div className=\"space-y-2\">\n            <Label>{t('tool.htmlToPdf.includeBackground')}</Label>\n            <div className=\"flex items-center space-x-2 pt-2\">\n              <Switch\n                id=\"include-bg\"\n                checked={includeBackground}\n                onCheckedChange={setIncludeBackground}\n                data-testid=\"switch-background\"\n              />\n              <Label htmlFor=\"include-bg\" className=\"cursor-pointer text-sm text-muted-foreground\">\n                {includeBackground ? (language === 'ar' ? 'مفعّل' : 'Enabled') : (language === 'ar' ? 'معطّل' : 'Disabled')}\n              </Label>\n            </div>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-wrap justify-center gap-4\">\n          {inputType === 'html' && htmlContent && !showPreview && (\n            <Button\n              variant=\"outline\"\n              onClick={handlePreview}\n              className=\"gap-2\"\n              data-testid=\"button-preview\"\n            >\n              <Eye className=\"h-4 w-4\" />\n              {t('tool.htmlToPdf.preview')}\n            </Button>\n          )}\n          \n          <Button\n            onClick={handleConvert}\n            disabled={isConverting || (inputType === 'html' ? !htmlContent.trim() : !urlContent.trim())}\n            className=\"gap-2 bg-[#11A05C] hover:bg-[#0d8a4d] text-white min-w-[200px]\"\n            data-testid=\"button-convert\"\n          >\n            {isConverting ? (\n              <>\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\n                {t('tool.htmlToPdf.converting')}\n              </>\n            ) : (\n              <>\n                <FileText className=\"h-4 w-4\" />\n                {t('tool.htmlToPdf.convert')}\n              </>\n            )}\n          </Button>\n\n          {pdfUrl && (\n            <Button\n              onClick={handleDownload}\n              className=\"gap-2 bg-[#11A05C] hover:bg-[#0d8a4d] text-white\"\n              data-testid=\"button-download\"\n            >\n              <Download className=\"h-4 w-4\" />\n              {t('tool.htmlToPdf.download')}\n            </Button>\n          )}\n\n          {(htmlContent || urlContent || pdfUrl) && (\n            <Button\n              variant=\"outline\"\n              onClick={handleReset}\n              className=\"gap-2\"\n              data-testid=\"button-reset\"\n            >\n              <RotateCcw className=\"h-4 w-4\" />\n              {language === 'ar' ? 'إعادة تعيين' : 'Reset'}\n            </Button>\n          )}\n        </div>\n\n        {/* PDF Preview after conversion */}\n        {pdfBlob && (\n          <div className=\"border border-border rounded-lg overflow-hidden\">\n            <div className=\"bg-muted/50 px-4 py-2 border-b border-border flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                <span className=\"text-sm font-medium\">{language === 'ar' ? 'معاينة PDF' : 'PDF Preview'}</span>\n              </div>\n              {totalPages > 0 && (\n                <span className=\"text-sm text-muted-foreground\">\n                  {language === 'ar' \n                    ? `${totalPages} صفحة` \n                    : `${totalPages} page${totalPages > 1 ? 's' : ''}`}\n                </span>\n              )}\n            </div>\n            <div \n              className=\"bg-gray-100 p-4 overflow-y-auto max-h-[700px]\" \n              data-testid=\"pdf-preview\"\n            >\n              {isLoadingPreview ? (\n                <div className=\"flex items-center justify-center h-[500px]\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n                </div>\n              ) : pdfPages.length > 0 ? (\n                <div className=\"flex flex-col items-center gap-4\">\n                  {pdfPages.map((pageUrl, index) => (\n                    <div key={index} className=\"relative\">\n                      <img \n                        src={pageUrl} \n                        alt={`Page ${index + 1}`}\n                        className=\"shadow-lg rounded max-w-full\"\n                      />\n                      <div className=\"absolute bottom-2 right-2 bg-black/60 text-white text-xs px-2 py-1 rounded\">\n                        {index + 1} / {totalPages}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"flex items-center justify-center h-[500px] text-muted-foreground\">\n                  {language === 'ar' ? 'جاري تحميل المعاينة...' : 'Loading preview...'}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":17187,"size_tokens":null},"client/src/pages/PageNumberPDF.tsx":{"content":"import { useState, useRef, useEffect, useCallback } from 'react';\nimport { FileUploader } from '@/components/FileUploader';\nimport { ToolPageLayout } from '@/components/ToolPageLayout';\nimport { useLanguage } from '@/lib/i18n';\nimport { Button } from '@/components/ui/button';\nimport { FileText, X, Download } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Slider } from '@/components/ui/slider';\nimport { PDFDocument, rgb, StandardFonts } from 'pdf-lib';\nimport * as pdfjs from 'pdfjs-dist';\n\npdfjs.GlobalWorkerOptions.workerSrc = new URL(\n  'pdfjs-dist/build/pdf.worker.min.mjs',\n  import.meta.url\n).toString();\n\ntype VerticalPosition = 'top' | 'bottom';\ntype HorizontalAlignment = 'left' | 'center' | 'right';\ntype NumberFormat = 'number' | 'page' | 'ofTotal' | 'dash';\n\ninterface PageNumberSettings {\n  verticalPosition: VerticalPosition;\n  horizontalAlignment: HorizontalAlignment;\n  format: NumberFormat;\n  startingNumber: number;\n  fontSize: number;\n  textColor: string;\n  skipFirstPage: boolean;\n  margin: number;\n}\n\nconst defaultSettings: PageNumberSettings = {\n  verticalPosition: 'bottom',\n  horizontalAlignment: 'center',\n  format: 'number',\n  startingNumber: 1,\n  fontSize: 12,\n  textColor: '#000000',\n  skipFirstPage: false,\n  margin: 30,\n};\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n    r: parseInt(result[1], 16) / 255,\n    g: parseInt(result[2], 16) / 255,\n    b: parseInt(result[3], 16) / 255,\n  } : { r: 0, g: 0, b: 0 };\n}\n\nfunction formatPageNumber(pageNum: number, totalPages: number, format: NumberFormat, language: string): string {\n  const isArabic = language === 'ar';\n  switch (format) {\n    case 'number':\n      return String(pageNum);\n    case 'page':\n      return isArabic ? `صفحة ${pageNum}` : `Page ${pageNum}`;\n    case 'ofTotal':\n      return isArabic ? `${pageNum} من ${totalPages}` : `${pageNum} of ${totalPages}`;\n    case 'dash':\n      return `- ${pageNum} -`;\n    default:\n      return String(pageNum);\n  }\n}\n\nexport default function PageNumberPDF() {\n  const { t, language } = useLanguage();\n  const { toast } = useToast();\n  const [file, setFile] = useState<File | null>(null);\n  const [settings, setSettings] = useState<PageNumberSettings>(defaultSettings);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [previewPages, setPreviewPages] = useState<{ page: number; url: string; width: number; height: number }[]>([]);\n  const [totalPages, setTotalPages] = useState(0);\n  const [processedPdfBlob, setProcessedPdfBlob] = useState<Blob | null>(null);\n  const [previewContainerWidth, setPreviewContainerWidth] = useState(400);\n  const previewContainerRef = useRef<HTMLDivElement>(null);\n\n  const handleFileSelected = (files: File[]) => {\n    if (files.length > 0) {\n      setFile(files[0]);\n      setProcessedPdfBlob(null);\n    }\n  };\n\n  const removeFile = () => {\n    setFile(null);\n    setPreviewPages([]);\n    setTotalPages(0);\n    setProcessedPdfBlob(null);\n  };\n\n  useEffect(() => {\n    const updateWidth = () => {\n      if (previewContainerRef.current) {\n        setPreviewContainerWidth(previewContainerRef.current.offsetWidth);\n      }\n    };\n    updateWidth();\n    window.addEventListener('resize', updateWidth);\n    return () => window.removeEventListener('resize', updateWidth);\n  }, []);\n\n  const loadPdfPreview = useCallback(async () => {\n    if (!file) return;\n    \n    try {\n      const arrayBuffer = await file.arrayBuffer();\n      const pdf = await pdfjs.getDocument({ data: arrayBuffer }).promise;\n      setTotalPages(pdf.numPages);\n      \n      const pages: { page: number; url: string; width: number; height: number }[] = [];\n      \n      for (let i = 1; i <= pdf.numPages; i++) {\n        const page = await pdf.getPage(i);\n        const viewport = page.getViewport({ scale: 1.5 });\n        \n        const canvas = document.createElement('canvas');\n        const context = canvas.getContext('2d')!;\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        \n        await page.render({ canvasContext: context, viewport, canvas }).promise;\n        \n        pages.push({\n          page: i,\n          url: canvas.toDataURL('image/jpeg', 0.8),\n          width: viewport.width,\n          height: viewport.height,\n        });\n      }\n      \n      setPreviewPages(pages);\n    } catch (error) {\n      console.error('Error loading PDF preview:', error);\n      toast({\n        title: t('tool.pageNumber.error'),\n        description: 'Could not load PDF preview',\n        variant: 'destructive',\n      });\n    }\n  }, [file, t, toast]);\n\n  useEffect(() => {\n    loadPdfPreview();\n  }, [loadPdfPreview]);\n\n  const processAndDownload = async () => {\n    if (!file) return;\n\n    setIsProcessing(true);\n    try {\n      const arrayBuffer = await file.arrayBuffer();\n      const pdfDoc = await PDFDocument.load(arrayBuffer);\n      const pages = pdfDoc.getPages();\n      const font = await pdfDoc.embedFont(StandardFonts.Helvetica);\n      const { r, g, b } = hexToRgb(settings.textColor);\n\n      for (let i = 0; i < pages.length; i++) {\n        if (settings.skipFirstPage && i === 0) continue;\n\n        const page = pages[i];\n        const { width, height } = page.getSize();\n        \n        const displayNumber = settings.skipFirstPage \n          ? settings.startingNumber + i - 1 \n          : settings.startingNumber + i;\n        \n        const totalDisplayPages = settings.skipFirstPage \n          ? pages.length - 1 \n          : pages.length;\n        \n        const text = formatPageNumber(displayNumber, totalDisplayPages, settings.format, language);\n        const textWidth = font.widthOfTextAtSize(text, settings.fontSize);\n\n        let x: number;\n        switch (settings.horizontalAlignment) {\n          case 'left':\n            x = settings.margin;\n            break;\n          case 'right':\n            x = width - settings.margin - textWidth;\n            break;\n          case 'center':\n          default:\n            x = (width - textWidth) / 2;\n            break;\n        }\n\n        const y = settings.verticalPosition === 'top' \n          ? height - settings.margin \n          : settings.margin;\n\n        page.drawText(text, {\n          x,\n          y,\n          size: settings.fontSize,\n          font,\n          color: rgb(r, g, b),\n        });\n      }\n\n      const pdfBytes = await pdfDoc.save();\n      const blob = new Blob([pdfBytes], { type: 'application/pdf' });\n      setProcessedPdfBlob(blob);\n\n      toast({\n        title: t('tool.pageNumber.success'),\n        variant: 'default',\n      });\n    } catch (error: any) {\n      console.error('Error adding page numbers:', error);\n      toast({\n        title: t('tool.pageNumber.error'),\n        description: error.message,\n        variant: 'destructive',\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const downloadPdf = () => {\n    if (!processedPdfBlob) return;\n    \n    const url = URL.createObjectURL(processedPdfBlob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = file ? `numbered-${file.name}` : 'numbered.pdf';\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  };\n\n  const renderPageNumberOverlay = (pageIndex: number, pageWidth: number, pageHeight: number, scale: number) => {\n    if (settings.skipFirstPage && pageIndex === 0) return null;\n\n    const displayNumber = settings.skipFirstPage \n      ? settings.startingNumber + pageIndex - 1 \n      : settings.startingNumber + pageIndex;\n    \n    const totalDisplayPages = settings.skipFirstPage \n      ? totalPages - 1 \n      : totalPages;\n\n    const text = formatPageNumber(displayNumber, totalDisplayPages, settings.format, language);\n    const scaledFontSize = settings.fontSize * scale;\n    const scaledMargin = settings.margin * scale;\n\n    let left: string | undefined;\n    let right: string | undefined;\n    let textAlign: 'left' | 'center' | 'right' = 'center';\n    let transform = 'translateX(-50%)';\n\n    switch (settings.horizontalAlignment) {\n      case 'left':\n        left = `${scaledMargin}px`;\n        textAlign = 'left';\n        transform = 'none';\n        break;\n      case 'right':\n        right = `${scaledMargin}px`;\n        textAlign = 'right';\n        transform = 'none';\n        break;\n      case 'center':\n      default:\n        left = '50%';\n        break;\n    }\n\n    const style: React.CSSProperties = {\n      position: 'absolute',\n      fontSize: `${scaledFontSize}px`,\n      color: settings.textColor,\n      fontFamily: 'Helvetica, Arial, sans-serif',\n      pointerEvents: 'none',\n      whiteSpace: 'nowrap',\n      textAlign,\n      transform,\n      ...(left && { left }),\n      ...(right && { right }),\n      ...(settings.verticalPosition === 'top' \n        ? { top: `${scaledMargin}px` } \n        : { bottom: `${scaledMargin}px` }),\n    };\n\n    return (\n      <div style={style} data-testid={`page-number-overlay-${pageIndex}`}>\n        {text}\n      </div>\n    );\n  };\n\n  return (\n    <ToolPageLayout\n      title={t('tool.pageNumber.title')}\n      description={t('tool.pageNumber.desc')}\n    >\n      <div className=\"max-w-6xl mx-auto\">\n        {!file ? (\n          <FileUploader\n            onFilesSelected={handleFileSelected}\n            accept={{ 'application/pdf': ['.pdf'] }}\n            maxFiles={1}\n            description={t('tool.pageNumber.uploadDesc')}\n          />\n        ) : (\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            {/* Settings Panel */}\n            <div className=\"lg:col-span-1 space-y-6 bg-white dark:bg-neutral-900 rounded-xl p-6 border border-neutral-200 dark:border-neutral-800\">\n              {/* File Info */}\n              <div className=\"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-lg\">\n                <FileText className=\"w-8 h-8 text-[#11A05C]\" />\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-sm font-medium truncate\">{file.name}</p>\n                  <p className=\"text-xs text-neutral-500\">{totalPages} {totalPages === 1 ? 'page' : 'pages'}</p>\n                </div>\n                <Button variant=\"ghost\" size=\"icon\" onClick={removeFile} data-testid=\"button-remove-file\">\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n\n              {/* Vertical Position */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.position')}</Label>\n                <Select\n                  value={settings.verticalPosition}\n                  onValueChange={(value: VerticalPosition) => \n                    setSettings(prev => ({ ...prev, verticalPosition: value }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-position\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"top\">{t('tool.pageNumber.positionTop')}</SelectItem>\n                    <SelectItem value=\"bottom\">{t('tool.pageNumber.positionBottom')}</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Horizontal Alignment */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.alignment')}</Label>\n                <Select\n                  value={settings.horizontalAlignment}\n                  onValueChange={(value: HorizontalAlignment) => \n                    setSettings(prev => ({ ...prev, horizontalAlignment: value }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-alignment\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"left\">{t('tool.pageNumber.alignLeft')}</SelectItem>\n                    <SelectItem value=\"center\">{t('tool.pageNumber.alignCenter')}</SelectItem>\n                    <SelectItem value=\"right\">{t('tool.pageNumber.alignRight')}</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Number Format */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.format')}</Label>\n                <Select\n                  value={settings.format}\n                  onValueChange={(value: NumberFormat) => \n                    setSettings(prev => ({ ...prev, format: value }))\n                  }\n                >\n                  <SelectTrigger data-testid=\"select-format\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"number\">{t('tool.pageNumber.formatNumber')}</SelectItem>\n                    <SelectItem value=\"page\">{t('tool.pageNumber.formatPage')}</SelectItem>\n                    <SelectItem value=\"ofTotal\">{t('tool.pageNumber.formatOfTotal')}</SelectItem>\n                    <SelectItem value=\"dash\">{t('tool.pageNumber.formatDash')}</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {/* Starting Number */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.startingNumber')}</Label>\n                <Input\n                  type=\"number\"\n                  min={1}\n                  value={settings.startingNumber}\n                  onChange={(e) => setSettings(prev => ({ ...prev, startingNumber: parseInt(e.target.value) || 1 }))}\n                  data-testid=\"input-starting-number\"\n                />\n              </div>\n\n              {/* Font Size */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.fontSize')}: {settings.fontSize}px</Label>\n                <Slider\n                  value={[settings.fontSize]}\n                  onValueChange={([value]) => setSettings(prev => ({ ...prev, fontSize: value }))}\n                  min={8}\n                  max={36}\n                  step={1}\n                  data-testid=\"slider-font-size\"\n                />\n              </div>\n\n              {/* Margin */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.margin')}: {settings.margin}px</Label>\n                <Slider\n                  value={[settings.margin]}\n                  onValueChange={([value]) => setSettings(prev => ({ ...prev, margin: value }))}\n                  min={10}\n                  max={100}\n                  step={5}\n                  data-testid=\"slider-margin\"\n                />\n              </div>\n\n              {/* Text Color */}\n              <div className=\"space-y-2\">\n                <Label>{t('tool.pageNumber.textColor')}</Label>\n                <div className=\"flex items-center gap-2\">\n                  <input\n                    type=\"color\"\n                    value={settings.textColor}\n                    onChange={(e) => setSettings(prev => ({ ...prev, textColor: e.target.value }))}\n                    className=\"w-10 h-10 rounded border border-neutral-200 cursor-pointer\"\n                    data-testid=\"input-text-color\"\n                  />\n                  <Input\n                    value={settings.textColor}\n                    onChange={(e) => setSettings(prev => ({ ...prev, textColor: e.target.value }))}\n                    className=\"flex-1\"\n                  />\n                </div>\n              </div>\n\n              {/* Skip First Page */}\n              <div className=\"flex items-center justify-between\">\n                <Label htmlFor=\"skip-first\">{t('tool.pageNumber.skipFirst')}</Label>\n                <Switch\n                  id=\"skip-first\"\n                  checked={settings.skipFirstPage}\n                  onCheckedChange={(checked) => setSettings(prev => ({ ...prev, skipFirstPage: checked }))}\n                  data-testid=\"switch-skip-first\"\n                />\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"space-y-3 pt-4\">\n                <Button \n                  onClick={processAndDownload}\n                  disabled={isProcessing}\n                  className=\"w-full bg-[#11A05C] hover:bg-[#0d8a4d] text-white\"\n                  data-testid=\"button-add-page-numbers\"\n                >\n                  {isProcessing ? t('tool.pageNumber.processing') : t('tool.pageNumber.addButton')}\n                </Button>\n\n                {processedPdfBlob && (\n                  <Button \n                    onClick={downloadPdf}\n                    className=\"w-full\"\n                    variant=\"outline\"\n                    data-testid=\"button-download\"\n                  >\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    {t('tool.pageNumber.download')}\n                  </Button>\n                )}\n              </div>\n            </div>\n\n            {/* Preview Panel */}\n            <div \n              ref={previewContainerRef}\n              className=\"lg:col-span-2 bg-neutral-100 dark:bg-neutral-800 rounded-xl p-4 overflow-y-auto max-h-[80vh]\"\n            >\n              <h3 className=\"text-lg font-semibold mb-4\">{t('tool.pageNumber.preview')}</h3>\n              <div className=\"space-y-4\">\n                {previewPages.map((pageData, index) => {\n                  const scale = (previewContainerWidth - 32) / pageData.width;\n                  const scaledHeight = pageData.height * scale;\n                  \n                  return (\n                    <div \n                      key={pageData.page}\n                      className=\"relative bg-white rounded-lg shadow-md overflow-hidden\"\n                      style={{ height: scaledHeight }}\n                      data-testid={`preview-page-${index}`}\n                    >\n                      <img \n                        src={pageData.url} \n                        alt={`Page ${pageData.page}`}\n                        className=\"w-full h-full object-contain\"\n                      />\n                      {renderPageNumberOverlay(index, pageData.width, pageData.height, scale)}\n                      <div className=\"absolute top-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded\">\n                        {pageData.page} / {totalPages}\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </ToolPageLayout>\n  );\n}\n","path":null,"size_bytes":18800,"size_tokens":null}},"version":2}